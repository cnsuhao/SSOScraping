{"link":"communitywalk.com","html":"<head>\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=8\">\n  <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n  <title>CommunityWalk - make your own map, build interactive maps, create a map with photos, videos, more</title>\n  <meta content=\"CommunityWalk allows you to make your own map of more than one address. You can create interactive maps quickly and easily. You can build maps with photos, videos and more in just minutes\" name=\"description\">\n\n  \n  <style type=\"text/css\" rel=\"Stylesheet\" media=\"all\">\n\n\n/***************************************** application *******************************************/\n\n/* ************* Generics *************** */\n.printonly {\n\tdisplay: none;\n}\n\na {\n\tcolor: #0057AA;\n  text-decoration: underline;\n}\n\na.internal_link {\n\tbackground-color: #DBFBD0;\n}\n\nul {\n  margin: 0;\n  padding: 0;\n}\n\nli\n{\n  list-style: none;\n}\n\nimg {\n  border: none;\n}\n\nform {\n\tmargin: 0;\n}\n\nbody, table, tr, td {\n  font-family: Verdana, arial, helvetica, sans-serif;\n  font-size: small;\n}\n\ntable {\n  border: 0;\n}\n\ntd {\n  border-collapse: collapse;\n  padding: 0;\n  margin: 0;\n}\n\n/* ************* Overall Layout *************** */\n\nbody\n{\n  margin: 0;\n  padding: 0 0 0 15px;\n  color: black;\n  background-color: white;\n  height: 100%;  \n}\n\n.spacer\n{\n\theight: 6px;\n\tclear: both;\n}\n\n.spacer_no_clear\n{\n\theight: 1em;\n}\n\n\n.tooltip\n{\n\tfont-weight: bold;\n    border: 1px solid #999;\n    background-color: #fff; \n    padding: 0 5px;\n    color: black;\n    position: absolute;\n    left: 0;\n    top: 0;    \n    white-space: nowrap;\n}\n\n.tooltip_background\n{\n    position: relative;\n}\n\n/* ************* Inline styles *************** */\n\n.main_menu\n{\n\tcolor: #1F842D;\n\tfont-family: arial, verdana, helvetica, sans-serif;\n\tfont-weight: bold;\n}\n\n.main_menu a {\n\tcolor: #1F842D;\n}\n\nh2 {\n\tfont-family: arial, verdana, helvetica, sans-serif;\n\tfont-size: large;\n\tfont-weight: bold;\n\tcolor: #CF6632;\n\tmargin: 1.25em 0 0.25em 0;\n\tpadding: 0;\n}\n\nh3 {\n\tfont-size: large;\n\tfont-weight: normal;\n\tcolor: #CF6632;\n\tmargin: 1em 0 0.25em 0;\n\tpadding: 0;\n}\n\nh4 {\n\tfont-size: large;\n\tfont-weight: bold;\n\tmargin: 0 0 0 0;\n\tpadding: 0;\n}\n\nh5 {\n\tfont-weight: bold;\n\tpadding: 0;\n\tmargin: 0 0 .1em 0;\n\tfont-size: small;\n}\n\np {\n\tmargin: 0.5em 0;\n}\n\n.nodisplay\n{\n  display: none;\n}\n\n.button-to {\n  float: left;\n}\n\n.noselect \n{\n  -moz-user-select: none;\n}\n\n.description\n{\n  font-size: 8pt;\n}\n\n.day\n{\n  background-color: #EAFBEE;\n  border: 1px solid #32D458;\n  padding: 3px;\n}\n\n\n.week\n{\n  background-color: #FEFFF1;\n  border: 1px solid #FAFF77;\n  padding: 3px;\n}\n\n\n.month\n{\n  background-color: #FFF1F1;\n  border: 1px solid  #FF7777;\n  padding: 3px;\n}\n\n\n.old\n{\n  background-color: #fff;\n  border: 1px solid #999;\n  padding: 3px;\n}\n\n.spec_func_div, .spec_func_table, .spec_func_table td\n{\n  font-size: 8pt;\n}\n\n.rightalign {\n  float: right;\n}\n\n.leftalign {\n  float: left;\n}\n\n.errorDiv {\n  text-align: center;\n  margin-bottom: 1em;\n}\n\n.medium_logo {\n\ttext-align: center;\n}\n\n/** Map Controls - shared by map page and iframe */\n\n#walk_map_controls\n{\n  position: absolute;\n  right: 0.5em;\n  top: 2.2em;\n  width: 12em;\n  font-family: arial, verdana, helvetica, sans-serif;\n  display: none;\n}\n\n#walk_map_controls_without_gmap_controls\n{\n  display: none;\n  position: absolute;\n  right: 0.5em;\n  top: 0.5em;\n  width: 15.5em;\n  font-family: arial, verdana, helvetica, sans-serif;\n}\n\n.loaded #walk_map_controls, .loaded #walk_map_controls_without_gmap_controls\n{\n\tdisplay: block;\n}\n\n#walk_map_controls .map_control, #walk_map_controls_without_gmap_controls .map_control\n{\n  border-top: solid #000 1px;\n  border-left: solid #000 1px;\n  border-bottom: solid #000 2px;\n  border-right: solid #000 2px;\n  background-color: #fff;\n  font-size: 9pt;\n  padding: 3px;\n  float: right;\n  clear: right;\n  overflow: hidden;\n  margin-top: 18px;;\n}\n\n#walk_map_controls #map_control_button_where {\n    width: 8em;\n}\n\n#walk_map_controls #map_control_button_what {\n    width: 5em;\n}\n\n#walk_map_controls .selected, #walk_map_controls_without_gmap_controls .selected\n{\n  border-bottom: solid white 2px;\n  font-weight: bold;\n}\n\n#walk_map_controls .selected .expand, #walk_map_controls .collapse {\n\tdisplay: inline;\n}\n\n#walk_map_controls .expand, #walk_map_controls .selected .collapse {\n\tdisplay: none;\n}\n\n#walk_map_controls .map_control a, #walk_map_controls_without_gmap_controls .map_control a\n{\n  text-decoration: none;\n  color: black;\n}\n\n#map_control_contents .container\n{\n  position:absolute; \n  right: 0px;\n  border-left: solid #000 1px;\n  border-top: solid #000 1px;\n  border-bottom: solid #000 1px;\n  border-right: solid #000 2px;\n  font-size: 9.5pt;\n  background-color: #fff;\n  margin-top: -1px;  \n}\n\n#map_control_content_what\n{\n  padding: 2px;\n  top: 81px;\n}\n\n#map_control_content_where {\n  width: 200px;\n  height: 150px;\n  top: 40px;\n}\n\n#map_control_content_where #centerhash\n{\n  font-size: 15pt;\n  font-weight: bold;\n  z-index: 100;\n}\n\n#display_marker_message {\n\tposition: absolute;\n\ttop: 10px;\n\tleft: 10px;\n\tbackground-color: white;\n\tfont-size: 12px;\n\tfont-weight: bold;\n\tpadding: 3px;\n\tborder-top: solid #000 1px;\n\tborder-left: solid #000 1px;\n\tborder-bottom: solid #000 2px;\n  \tborder-right: solid #000 2px;\n  \tz-index:9999;\n}\n\n/** Edit Category Styles - shared by configure page and category edit page */\n\n.category_row input\n{\n  width: 100px;\n}\n\n.category_row a\n{\n  width: 15px;\n  text-decoration: none;\n  text-align: center;\n  color: #979797;\n  border: 1px solid #979797;\n  padding: 0 3px;\n}\n\n.color_1\n{\n  background-color: #00FFFF;\n}\n\n.color_2\n{\n  background-color: #0000FF;\n}\n\n.color_3\n{\n  background-color: #00FF00;\n}\n\n.color_4\n{\n  background-color: #00AFFF;\n}\n\n.color_5\n{\n  background-color: #FF0000;\n}\n\n.color_6\n{\n  background-color: #AF00FF;\n}\n\n.color_7\n{\n  background-color: #CC9866;\n}\n\n.color_8\n{\n  background-color: #AFAFAF;\n}\n\n.color_9\n{\n  background-color: #FFAF00;\n}\n\n.color_10\n{\n  background-color: #FF00FF;\n}\n\n.color_11\n{\n  background-color: #FFFFFF;\n}\n\n.color_12\n{\n  background-color: #00FFAF;\n}\n\n.color_13\n{\n  background-color: #FFFF00;\n}\n\n.color_14\n{\n  background-color: #AFFF00;\n}\n\n.color_15\n{\n  background-color: #FF00AF;\n}\n\n.color_16\n{\n  background-color: #AFAFFF;\n}\n\n.color_17\n{\n  background-color: #AFFFAF;\n}\n\n.color_18\n{\n  background-color: #FFAFAF;\n}\n\n.greyedout {\n\tcolor: #979797;\n}\n\n.blue {\n\tcolor: blue;\n}\n\n/* ************* Right Column Layout *************** */\n\n#right_main_menu {\n  margin-bottom: 18px;\n}\n\n#login_heading {\n  font-size: 10pt;\n  font-weight: bold;\n  font-variant: small-caps;\n  color: #8E8E8E;\n  margin: 8px 0;\n}\n\n#login_area {\n  border-top: 3px solid #390;\n  border-bottom: 3px solid #390;\n  background: url(/images/blue_white_vert_fade.png) repeat-x;\n  margin: 8px 0;\n  padding: 8px 5px 0 5px;\n  height: 78px;\n  position: relative;\n}\n\n#login_area .prompt {\n  width: 65px;\n  padding: 0 10px;\n  font-weight: bold;\n  font-size: 90%;\n}\n\n#login_area .value {\n  width: 170px;\n}\n\n#search_area {\n  background-color: #EFEFEF;\n  font-size: 10pt;\n  text-align: right;\n  padding: 3px 5px 3px 3px;\n  border-bottom: 1px solid #DEDEDE;\n  margin-bottom: 15px;\n}\n\n#search_area input {\n  font-size: 8pt;\n}\n\n#login_area #my_communities_link {\n  position: absolute;\n  bottom: 10px;\n  left: 5px;\n  font-weight: bold;\n  font-size: 100%;\n  color: #FC491C;\n}\n\n#login_area #logout_link {\n  position: absolute;\n  bottom: 10px;\n  right: 5px;\n  font-weight: bold;\n  font-size: 100%;\n  color: #FC491C;\n}\n\n#login_area .button_bar, #login_area .button_bar a {\n  font-weight: bold;\n  font-size: 90%;\n  color: #FC491C;\n}\n\n/* ********************  PAGING ********************************************************* */\n\n.group_paging {\n\tposition: relative;\n\tpadding: 0 10em;\n\ttext-align: center;\n\tmargin-bottom: 5px;\n}\n\n.paging {\n\tposition: absolute;\n}\n\n#previous_page_link {\n\tleft: 0;\n}\n\n#next_page_link {\n\tright: 0;\n}\n\n.paging_text {\n\tpadding: 0 20px 0 0;\n}\n\n/* ********************  FOOTER ********************************************************* */\n\n#footer\n{\n  clear: both;\n  padding: 5px 0;\n  border-top: 3px solid #DFDFDF;\n}\n\n\n/******************* PATH WIDGET ***************************/\n\n#path_title_display {\n\ttext-align: left;\n\twidth: 100%;\n\tclear: both;\n\tbackground-color: blue;\n\tborder: 1px solid black;\n\tpadding: 3px 0;\n}\n\n#path_nav_container {\n\ttext-align: center;\n\tposition: absolute;\n\tbottom: 14em;\n\tleft: 20em;\n\theight: 0px;\n\tz-index: 9999;\n\tfont-size: 12px;\n}\n\n.commercial #path_nav_container {\n\tleft: 1em;\n  bottom: 10em;\n}\n\n#point_nav_boxes {\n\tpadding: 0 100px 0 120px;\n\tmin-width: 121px;\n\tfloat: left;\n}\n\n#path_color_picker {\n\tpadding: 1px;\n\tposition: absolute;\n\ttop: 3px;\n\tright: 130px;\n\tbackground-color: #CCC;\n\twidth: 120px;\n\tline-height: 20px;\n}\n\n#point_nav_boxes_background {\n\tfloat: left;\n\tposition: relative;\n\twidth: 340px;\n}\n\n#point_nav_boxes_scroll {\n\toverflow: auto;\n\twidth: 340px;\n\toverflow-y: hidden;\n}\n\n.small #point_nav_boxes_scroll, .no_points #point_nav_boxes_scroll {\n\theight: 0px;\n}\n\n.small #point_nav_boxes, .no_points #point_nav_boxes {\n\tdisplay: none;\n}\n\n#path_edit_buttons {\n\ttext-align: right;\n\tcursor: move;\n\tpadding: 3px;\n}\n\n#path_edit_buttons img {\n\tvertical-align: -2px;\n}\n\n#path_title_display, #path_edit_buttons, #path_title_display a, #path_edit_buttons a {\n\tcolor: white;\n}\n\n#path_nav_info a {\n\tcolor: white;\n}\n\n.guy {\n\ttext-align: center;\n\twidth: 150px;\n\tfloat: left;\n\tmargin-left: -60px;\n\tfont-size: 14px;\n\tline-height: 0px;\n\ttext-decoration: none;\n\tcolor: black;\n\tcursor: pointer;\n}\n\n#path_nav_box .title {\n\toverflow: hidden;\n\tborder: 1px solid black;\n\tbackground-color: white;\n\tline-height: 100%;\n  height: 1.2em;\n}\n\n#path_nav_box .selected .title {\n\tbackground-color: yellow;\n}\n\n#path_nav_box.view .continue_path_guy {\n\tdisplay: none;\n}\n\n#path_nav_box .continue_path_guy {\n\tfloat: right;\n\tmargin: -50px 0 0 0;\n\t/*margin: 50px 0 0 -100px;*/\n}\n\n#path_nav_box .blank_signpost {\n\tline-height: 100%;\n}\n\n.signpost_left {\n\tfloat: left;\n\twidth: 74px;\n\tborder-right: 1px solid black;\n}\n\n.signpost_right {\n\tfloat:left;\n\twidth: 74px;\n\tborder-left: 1px solid black;\n}\n\n.left_mid, .right_mid {\n\twidth: 55px;\n\tfloat:left;\n}\n\n.wide_midsection {\n\twidth: 100%;\n\tbackground-color: white;\n\tborder: 1px solid black;\n}\n\n.small .wide_midsection, .no_points .wide_midsection {\n\tdisplay: none;\n}\n\n.midsection div {\n\tfloat: left;\n\tpadding-bottom: 2px;\n\tfont-weight: normal;\n\tfont-size: 9px;\n}\n\n.mid_top {\n\twidth: 100%;\n\tborder-bottom: 1px solid #1F842D;\n\theight: 30px;\n}\n\n.mid_bottom {\n\twidth: 100%;\n\tborder-top: 1px solid #1F842D;\n\theight: 15px;\n\tpadding-bottom: 22px;\n}\n\n.title_cushion_bottom {\n\theight: 40px;\n}\n\n.title_cushion_middle {\n\theight: 20px;\n}\n\n.title_cushion_top {\n\theight: 0px;\n}\n\n.signpost_bottom {\n\theight: 10px;\n}\n\n.signpost_middle {\n\theight: 30px;\n}\n\n.signpost_top {\n\theight: 50px;\n}\n\n#path_nav_box .point_img, #path_nav_box .selected .selected_img {\n\tdisplay: block;\n}\n\n#path_nav_box .selected_img,  #path_nav_box .selected .point_img {\n\tdisplay: none;\n}\n\n#path_nav_box .delete_button, #path_nav_box .prev_insert_button {\n\tdisplay: block;\n}\n\n#path_nav_box .hide_marker, #path_nav_box .selected .hide_marker,\n#path_nav_box .hide_dot, #path_nav_box .selected .hide_dot,\n#path_nav_box .hide_end_dot, #path_nav_box .selected .hide_end_dot,\n#path_nav_box .hide_end_marker, #path_nav_box .selected .hide_end_marker,\n#path_nav_box.edit .view_button, #path_nav_box.view .edit_button,\n#path_nav_box.small .large_button, #path_nav_box.large .small_button {\n\tdisplay: none;\n}\n\n#path_nav_box .nav_button {\n\tfloat:left;\n  margin: 10px;\n}\n\n#path_nav_box.small .nav_button {\n}\n\n#path_nav_box.no_points .nav_button {\n\tdisplay: none;\n}\n\n#path_nav_box.edit #edit_path_panel, #path_nav_box.edit #path_options_panel {\n\tbackground-color: white;\n\tborder-right: 1px solid black;\n\tborder-top: 1px solid black;\n\twidth: 100%;\n\tline-height: 2em;\n}\n\n#path_nav_box.edit #path_options_panel {\n  height: 100px;\n  width: 320px;\n  padding: 10px;\n  position: absolute;\n  border-left: 1px solid black;\n  top: 0;\n  left: -1px;\n}\n\n#path_nav_box #new_path_instructions {\n\tdisplay: none;\n}\n\n.no_points #path_nav_box.edit #new_path_instructions{\n\tdisplay: block;\n\tbackground-color: white;\n\tborder: 1px solid black;\n\twidth: 100%;\n}\n\n#path_nav_box.edit .edit_path_panel_cushion {\n\tborder-left: 1px solid black;\n\tline-height: 2em;\n}\n\n#path_nav_box.view .edit_path_panel_cushion {\n\tdisplay: none;\n}\n\n#path_nav_box.edit .delete_button {\n\tmargin: -15px 0 0 0;\n\tz-index: 9999;\n}\n\n/*  These are identical so that IE can be overriden properly */\n#path_nav_box.edit .prev_insert_button {\n\tmargin: 20px 0 0 15px;\n}\n\n#path_nav_box.view #edit_path_panel, #path_nav_box.view #path_options_panel, #path_nav_box.view .prev_insert_button, #path_nav_box.view .next_insert_button, #path_nav_box.view .delete_button {\n\tdisplay: none;\n}\n\n#path_nav_box .path_button {\n\tfont-weight: bold;\n\tbackground-color: #d6d6d6;\n\tcolor: black;\n\tborder-bottom: 2px solid black;\n\tborder-right: 2px solid black;\n\tborder-top: 1px solid #ccc;\n\tborder-left: 1px solid #ccc;\n\tpadding: 0 3px;\n\ttext-decoration: none;\n\tcursor: pointer;\n}\n\n#path_nav_container.in_miles .kilometers, #path_nav_container.in_kilometers .miles {\n\tdisplay: none;\n\tbackground-color: blue;\n}\n\n/******** fast overlay markers *********/\n\n.small_marker_icon {\n\tbackground: url('http://www.communitywalk.com/images/s_shadow.png') no-repeat bottom right;\n}\n\n.single_digit_marker_icon {\n\tbackground: url('http://www.google.com/mapfiles/shadow50.png') no-repeat bottom center;\n}\n\n.double_digit_marker_icon {\n\tbackground: url('http://www.google.com/maplinedraw?width=72&height=40&path=u@c@BAB?BATO?A?AA?K?AABGSFA@K?E?C@C@UN?@B@T?T?FAw@?z@A{@?~@A{@?|@A{@?|@A{@?~@A{@?|@A{@?|@A{@?~@A{@?|@A{@?z@Aw@?h@AS?RAO?NAI?HAE?FAC?}oR&color=0,0,0,191.25&weight=2') no-repeat bottom left;\n}\n\n.dot_marker_icon div div, .small_marker_icon div div {\n\tdisplay: none;\n}\n\n.custom_icon div, .dot_marker_icon div, .small_marker_icon div, .single_digit_marker_icon div, .double_digit_marker_icon div {\n\tcursor: pointer;\n\ttext-align: center;\n\tfont-weight: bold;\n}\n\n.double_digit_marker_icon div div {\n\twidth: 100%;\n\tposition: absolute;\n\ttop: 5px;\n\tleft: 0;\n}\n\n.single_digit_marker_icon div div {\n\twidth: 100%;\n\tposition: absolute;\n\ttop: 3px;\n\tleft: 0;\n}\n\n.single_digit_marker_icon img, .double_digit_marker_icon img {\n\tposition:absolute;\n\ttop:0;\n\tleft:0;\n}\n\n.cc_table {\n  margin:auto;\n}\n\n.easter_egg {\n\tposition: absolute;\n\theight: 20px;\n\twidth: 20px;\n\ttop: 0px;\n\tleft: 0px;\n}\n\n\n/****************************************************************/\n#wrap {\n\tmargin:0 auto;\n  width:800px;\n}\n\n#logo {\n\tfloat: left;\n}\n\n#logo_heading {\n  font-size: 10pt;\n  font-weight: bold;\n  font-variant: small-caps;\n  color: #8E8E8E;\n}\n\n#right_header {\n\tfloat: right;\n}\n\n#right_header div {\n\tfloat: left;\n\tmargin: 0 .6em;\n}\n\n#body {\n  padding: 0 20px 30px 20px;\n\tborder: 1px solid #979797;\n}\n\n#footer {\n\theight: 50px;\n}\n\n\n/**** Wedding IFRAME ******/\n#wedding_logo_wrapper {\n  position: absolute;\n  bottom: 20px;\n  right: 5px;\n}\n\n#wedding_logo {\n  line-height: 24px;\n  height: 24px;\n}\n\n/** User Rating **/\n.user_rating .stars_container {\n  position:relative;\n  width:99px;\n  height:20px;\n}\n\n.user_rating .stars_background {\n  background-color:yellow;\n  height:20px;\n}\n\n.user_rating img {\n  position:absolute;\n  top:0;\n  left:0;\n}\n\n/***************************************** welcome *******************************************/\n\nh1 {\n  display: none;  \n}\n\n#wrap {\n  width: 775px;\n}\n\n#right_column {\n  float: right;\n  width: 310px;\n  margin-bottom: 20px;\n}\n\n#left_column  {\n  float: left;\n  width: 431px;\n  margin-right: 20px;\n}\n\n#logo {\n  margin-bottom: 15px;\n}\n\n#login_iframe {\n  height: 5em;\n  margin-bottom: 18px;\n}\n\n#right_main_menu {\n  float: right;\n  text-align: right;\n}\n\n#right_column ul {\n  line-height: 2em;\n  font-size: 11pt;\n}\n\n#right_column .header {\n  font-size: 13pt;\n  font-weight: bold;\n  color: #CF6632;\n}\n\n.section {\n  width: 411px;\n  background-color: #DEDEDE;\n  position: relative;\n  padding: 15px;\n  margin-top: 15px;\n}\n\n.section .ul_corner {\n  height: 10px;\n  width: 10px;\n  position: absolute;\n  top: 0;\n  left: 0;\n  background: url(/images/dedede-corner-ul.png) no-repeat;\n}\n\n.section .ur_corner {\n  height: 10px;\n  width: 10px;\n  position: absolute;\n  top: 0;\n  right: 0;\n  background: url(/images/dedede-corner-ur.png) no-repeat;\n}\n\n.section .lr_corner {\n  height: 10px;\n  width: 10px;\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  background: url(/images/dedede-corner-lr.png) no-repeat;\n}\n\n.section .ll_corner {\n  height: 10px;\n  width: 10px;\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  background: url(/images/dedede-corner-ll.png) no-repeat;\n}\n\n.right_section {\n  margin-bottom: 20px;\n}\n\n.middle_text {\n  font-size: 12pt;\n  padding: 9px 0 3px 0;\n  line-height: 1.5em;\n}\n\n.section .content {\n  float: right;\n  width: 290px;\n  font-size: 10pt;\n  font-weight: bold;\n  text-align: center;\n  line-height: 2.5em;\n}\n\n.section .styled_input {\n  width: 15em;\n  font-size: 11pt;\n  padding: 5px;\n  background: url(/images/styled_input.gif) no-repeat;\n}\n\n.section img {\n  float: left;\n}\n\n.section .section_link {\n  font-size: 8pt;\n  font-weight: bold;\n  text-align: center;\n  margin-top: 10px;\n}\n  \n\n</style>\n  <style type=\"text/css\" rel=\"Stylesheet\" media=\"print\">\n\n\n/***************************************** print *******************************************/\n\n.tooltip\n{\n\tfont-weight: bold;\n    border: 1px solid #999;\n    background-color: #fff; \n    padding: 0 10px 0 5px;\n    color: black;\n    position: absolute;\n\t\tleft: 0px;\n    top: 0;\n    font-size: 11pt;\n    white-space: nowrap;\n}\n\n.tooltip_background\n{\n    position: relative;\n}\n\n.fake_text {\n\tfont-weight: bold;\n\tfont-size: 11pt;\n\tborder-top: 18px solid white; \n\tpadding: 10000px 12px 0 0px;    \n\twhite-space: nowrap;\n}\n\nh5 {\n\tfont-size: 12pt;\n}\n\nh4 {\n\tfont-size: 12pt;\t\n\tfont-weight: normal;\n}\n\nh3 {\n\tfont-size: 12pt;\n\tfont-weight: bold;\n}\n\nh2 {\n\tfont-size: 14pt;\n}\n\nh1 {\n\tfont-size: 14pt;\n\tfont-weight: bold;\n}\n\na {\n\ttext-decoration: none;\n\tcolor: black;\n}\n\n.nodisplay {\n\tdisplay: none;\n}\n\n.printonly {\n\tdisplay: block;\n}\n\n.screenonly {\n  display: none;\n}\n\n#right_header, #search_area {\n  display: none;\n}\n\n#footer {\n  display: none;\n}\n\n#walk_map_container {\n\tposition: absolute;\n\ttop:0px;\n\tleft:0px;\n  margin-top: -60px;\n}\n\n#walk_header {\n\tdisplay: none;\n}\n\n#claim_map {\n\tdisplay: none;\n}\n\n#panel_expander {\n\tdisplay: none;\n}\n\n#walk_map_title {\n\tdisplay: none;\n}\n\n#map_comments {\n\tdisplay: none;\n}\n\n#walk_tabs {\n\tdisplay: none;\n}\n\n#walk_ads_container {\n\tdisplay: none;\n}\n\n#walk_controls {\n\tdisplay: none;\n}\n\n#walk_static_controls .control_box {\n\tdisplay: none;\n}\n\n.map_control {\n\tdisplay: none;\n}\n\n#map_control_content_what div {\n\tfloat: left;\n}\n\n#map_control_content_what .description {\n\tdisplay: none;\n}\n\n#walk_panel {\n\tposition: absolute;\n\ttop: 0px;\n\tleft: 0px;\n\twidth: 200px;\n\tbackground-color: white;\n\tdisplay: none;\n}\n\n#walk_panel #map_comments {\n\tdisplay: none;\n}\n\n#walk_panel table {\n\tdisplay: none;\n}\n\n#walk_panel\tul table {\n\tdisplay: block;\n\tpadding: 0;\n\tmargin: 0;\n}\n\n#walk_panel ul { \n\tdisplay: inline;\n\tpadding: 0;\n\tmargin: 0;\n\tbackground-color: white;\n} \n\n#walk_panel .title, #walk_panel .subtitle {\n\tpadding: 0;\n\tmargin: 0;\n\tfont-weight: bold;\n}\n\n#walk_panel li {\n\tlist-style: none;\n\tpadding: 0;\n\tmargin: 0;\n}\n\n#path_nav_container {\n\tdisplay: none;\n}\n\n.expansion {\n\tdisplay: none;\n}\n\n.has_photos, .has_directions, .has_comments {\n\tdisplay: none;\n}\n\n.double_digit_marker_icon div, .single_digit_marker_icon div {\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n}\n\n.dot_marker_icon div div, .small_marker_icon div div {\n\tdisplay: none;\n}\n\n.single_digit_marker_icon div div, .double_digit_marker_icon div div {\n\tfont-size: 12pt;\n\tfont-weight: bold;\t\n\twidth: 100%;\n\ttext-align: center;\n\tmargin-top: 3px;\n}\n\n.list_ad {\n  display: none;\n}\n\n/***** wedding ********/\n.wedding .module {\n  display: none;\n}\n\n.wedding #walk_map_container {\n  left: -20em;\n  width: 200%;\n}\n\n.wedding .wrapper {\n  margin-left: -3.6em;\n}\n\n</style>\n  <!--[if lt IE 7]>\n    <style type='text/css' rel='Stylesheet' media='screen'>\n\n\n/***************************************** ie_overrides *******************************************/\n\n/* Hides from IE-mac \\*/\n* html .hollyhack {height: 1%;}\n/* End hide from IE-mac */\n\n/*** welcome page **/\n\n.right_section {\n  margin-top: 10px;\n}\n\n.section .ll_corner, .section .lr_corner {\n  bottom: -6px;\n}\n\n.section .ur_corner, .section .lr_corner {\n  right: -1px;\n}\n\n.section .content .submit {\n  margin-top: 0.5em;\n}\n\n#walk_panel .section .section_title .section_title_link {\n  right: 30px;\n}\n\n\n/*** map page ***/\n\n#maps_image .tabs\n{\n  padding-bottom: 1px;\n}\n\nv\\:* \n{\n  behavior:url(#default#VML);\n}\n\n#map_control_contents .container\n{\n  right: 2px;\n}\n\n#page #logo\n{\n  \tbottom: 3px;\n}\n\n#previous_page_link {\n\tleft: -10em;\n}\n\n.tooltip\n{\n    padding: 0 5px 0 5px;\n}\n\n#walk_controls .control_box {\n\tbottom: 4.5em;\n}\n\n#walk_controls .control_box .close_button {\n\t\tmargin-right: -5px;\n}\n\n#walk_static_controls .control_box .close_button {\n\t\tmargin-right: -0.5em;\n}\n\n/*** Path Nav Widget Stuff ****/\n\n#path_nav_container {\n\tbottom: 5em;\n}\n\n.commercial #path_nav_container {\n\tbottom: 1em;\n}\n\n#path_nav_box .guy .midsection div {\n\tpadding-bottom: 2.9em;\n}\n\n#path_nav_box .continue_path_guy {\n\tmargin-top: -70px;\n}\n\n#path_nav_box.edit .prev_insert_button {\n\tmargin: -10px 0 0 0;\n}\n\n#path_nav_box .image_button {\n  padding: 2px;\n  vertical-align: 2px;\n}\n\n/*** Bulk Edit ***/\n\n.bulk_content {\n\tbackground-color: transparent;\n}\n\n/*** Fast Overlay Markers ***/\n\n.small_marker_icon {\n\tbackground: transparent;\n\tfilter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='/images/s_shadow.png');\n}\n\n.single_digit_marker_icon {\n\tbackground: transparent;\n\tfilter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://www.google.com/mapfiles/shadow50.png');\n}\n\n.double_digit_marker_icon {\n\tbackground: transparent;\n\tfilter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://www.google.com/maplinedraw?width=72&height=40&path=u@c@BAB?BATO?A?AA?K?AABGSFA@K?E?C@C@UN?@B@T?T?FAw@?z@A{@?~@A{@?|@A{@?|@A{@?~@A{@?|@A{@?|@A{@?~@A{@?|@A{@?z@Aw@?h@AS?RAO?NAI?HAE?FAC?}oR&color=0,0,0,191.25&weight=2');\n}\n\n/*** Wedding Mapper ***/\n\n/*\n.module {\n  filter:progid:DXImageTransform.Microsoft.Alpha(opacity=90)\n}\n*/\n\n.package_listing {\n  margin: 6px 3px;\n}\n\n#walk_panel .section .location_link {\n  height: 1%;\n  overflow-x: hidden;\n}\n\n#walk_panel .section .content {\n  height: 1%;\n  position: relative;\n}\n\n#tutorial_close {\n  right: 5px;\n}\n\n/**** Bubbles ****/\n\n#walk_box .basic .long_description {\n  height: 100px;\n}\n\n\n/**** Corners ****/\n.right {\n  right: -1px;\n}\n\n.bottom {\n  bottom: -1px;\n}\n\n\n\n</style>\n  <![endif]-->\n\n  <script type=\"text/javascript\">\n    //<!--\n    FROM_TESTRUNNER = false;\n\n    var onloads = new Array();\n    function bodyOnLoad() {\n       for ( var i = 0 ; i < onloads.length ; i++ ) {\n          if (window.onloads[i]) {\n            onloads[i]();\n          }\n       }\n    }\n\n    var onunloads = new Array();\n    function bodyOnUnload() {\n       for ( var i = 0 ; i < onloads.length ; i++ ) {\n          if (window.onunloads[i]) {\n            onunloads[i]();\n          }\n       }\n    }\n    //-->\n  </script>\n\n</head>\n<body onload=\"bodyOnLoad();\" onbeforeunload=\"bodyOnUnload();\">\n\t<h1>\n    CommunityWalk allows you to create interactive maps quickly and easily.\n    You can build maps with photos, videos and more in just minutes!\n    Put multiple locations, markers, points, or pushpins on your map.\n    Take advantage of Google Maps with ease!\n  </h1>\n  \n\n\n<script type=\"text/javascript\">\n  function loadFeaturedMap() {\n    var featuredMaps = [\n                {title: \"London Panoramas Google Map\", id: 65, url: \"/london_panoramas_google_map/map/65\"},\n                {title: \"Torino Winter Olympics\", id: 1987, url: \"/torino/italy/torino_winter_olympics/map/1987\"},\n                {title: \"Kitchener Waterloo and Area Restaurants\", id: 288, url: \"/kitchener_waterloo_and_area_restaurants/map/288\"},\n                {title: \"India\", id: 55, url: \"/india/map/55\"},\n                {title: \"Central Park Soundseeing Tour\", id: 8729, url: \"/central_park_soundseeing_tour/map/8729\"},\n                {title: \"Spondon Village, Derbyshire\", id: 1054, url: \"/spondon_village_derbyshire/map/1054\"},\n                {title: \"Lake Como\", id: 16156, url: \"/accommodation/lake_como/map/16156\"},\n                {title: \"Burton Junior Football League\", id: 887, url: \"/burton_junior_football_league/map/887\"},\n                {title: \"Peter's Bat Map\", id: 653, url: \"/peters_bat_map/map/653\"},\n                {title: \"Yosemite National Park\", id: 111, url: \"/yosemite_national_park/map/111\"},\n                {title: \"SXSW Festival\", id: 2539, url: \"/sxsw_festival/map/2539\"},\n                {title: \"Concord, Massachusetts\", id: 228, url: \"/concord_massachusetts/map/228\"},\n                {title: \"Park(ing) Day Sites\", id: 19478, url: \"/parking\"},\n                {title: \"Wild Bison Herds\", id: 25483, url: \"/wild_bison_herds/map/25483\"},\n                {title: \"South End of Boston\", id: 12094, url: \"/south_end_of_boston/map/12094\"},\n                {title: \"The Surrey Hills - pubs, villages and churches. \", id: 719, url: \"/the_surrey_hills__pubs_villages_and_churches_/map/719\"},\n                {title: \"Pivotal Lunch Spots\", id: 1144, url: \"/pivotallunch\"},\n                {title: \"San Francisco Happy Hours\", id: 11716, url: \"/san_francisco/ca/san_francisco_happy_hours/map/11716\"},\n                {title: \"Glenwood Springs, Colorado\", id: 12775, url: \"/glenwood_springs/glenwood_springs_colorado/map/12775\"},\n                {title: \"Geocaching in Strasbourg France\", id: 22358, url: \"/geocaching_in_strasbourg_france/map/22358\"},\n                {title: \"Grass Roots Football Grounds in Leicestershire & Surrounding Counties\", id: 22957, url: \"/grass_roots_football_grounds_in_leicestershire__surrounding_counties/map/22957\"},\n                      {title: \"Dunwoody Dining Guide\", id: 17403, url: \"/dunwoody_dining_guide/map/17403\"},\n                {title: \"Alaska Vacation\", id: 20502, url: \"/alaska_vacation/map/20502\"},\n                {title: \"5 places to see a ghost on Capitol Hill\", id: 24109, url: \"/5_places_to_see_a_ghost_on_capitol_hill/map/24109\"},\n                {title: \"Aquitaine France Vacation Rentals\", id: 25590, url: \"/aquitaine_france_vacation_rentals/map/25590\"},\n                {title: \"CBODN 2007 Annual Conference \", id: 25881, url: \"/cbodn_2007_annual_conference_/map/25881\"},\n                {title: \"Cape Coral\", id: 25770, url: \"/CapeCoral\"},\n                {title: \"Sharrow Songlines\", id: 26560, url: \"/sharrow_songlines/map/26560\"},\n                {title: \"Vancouver Fall Walk\", id: 23461, url: \"/vancouver_fall_walk/map/23461\"},\n                {title: \"Tampa Bay\", id: 33460, url: \"/tampa_bay/map/33460\"},\n                {title: \"The Great Ocean Road Experience\", id: 32177, url: \"/the_great_ocean_road_experience/map/32177\"},\n                {title: \"Kayak Vancouver Island\", id: 34236, url: \"/kayak_vancouver_island/map/34236\"},\n                {title: \"South Central Bombs\", id: 41387, url: \"/scbombs\"},\n                            {title: \"Washington, DC Art\", id: 42043, url: \"/artdc\"},\n                {title: \"Sowa Map\", id: 42257, url: \"/sowa_map/map/42257\"},\n                {title: \"S. Lake Tahoe Ski & Casino\", id: 42314, url: \"/s_lake_tahoe_ski__casino/map/42314\"},\n                {title: \"Staywinterpark. ~ Winter Park CO Property Map\", id: 38339, url: \"/winterparklodging\"},\n                {title: \"I Love Google Maps\", id: 27328, url: \"/i_love_google_maps\"},\n                {title: \"Dream Vacation\", id: 101536, url: \"/auckland/new_zealand/dream_vacation/map/101536\"},\n                {title: \"Top Ten Greenest Economic Cities\", id: 123913, url: \"/portland/oregon/top_ten_greenest_economic_cities/map/123913\"},\n              ]\n\n    var map = featuredMaps[new Date() % featuredMaps.length]\n    if (map) {\n      $('featured_map').src = \"http://www.communitywalk.com/iframe/content/\" + map.id + \"?zoom=-2&whatandwhere=0&types=0\"\n      $('featured_map_link').href = map.url;\n      $('featured_map_link').innerHTML = map.title;\n    }\n  }\n  onloads.push(loadFeaturedMap);\n</script>\n\n\n<div id=\"wrap\" style=\"position: relative;\">\n  <div id=\"search_area\">\n  <!-- SiteSearch Google -->\n  <form method=\"get\" action=\"http://www.communitywalk.com/search\" target=\"_top\">\n    <div>\n      Search CommunityWalk:\n      <input type=\"hidden\" name=\"domains\" value=\"www.communitywalk.com\">\n      <input type=\"text\" name=\"q\" size=\"30\" maxlength=\"255\" value=\"\">\n      <input type=\"submit\" name=\"sa\" value=\"Search\">\n      <input type=\"radio\" name=\"sitesearch\" checked=\"checked\" value=\"www.communitywalk.com\" style=\"display:none\">\n      <input type=\"hidden\" name=\"client\" value=\"pub-8093777559830738\">\n      <input type=\"hidden\" name=\"forid\" value=\"1\">\n      <input type=\"hidden\" name=\"ie\" value=\"ISO-8859-1\">\n      <input type=\"hidden\" name=\"oe\" value=\"ISO-8859-1\">\n      <input type=\"hidden\" name=\"safe\" value=\"active\">\n      <input type=\"hidden\" name=\"flav\" value=\"0000\">\n      <input type=\"hidden\" name=\"sig\" value=\"45AJITyIcmEDukho\">\n      <input type=\"hidden\" name=\"cof\" value=\"GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:336699;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;FORID:11\">\n      <input type=\"hidden\" name=\"hl\" value=\"en\">\n    </div>\n  </form>\n<!-- SiteSearch Google -->\n</div>\n\n  <div id=\"left_column\">\n    <div id=\"logo\">\n\t<a href=\"/\"><img alt=\"Cw_logo\" src=\"/images/cw_logo.png?1489161704\"></a>\n\t<div id=\"logo_heading\">Mapping Made Easy</div>\n</div>\n\n    <div class=\"spacer\"></div>\n\n    <!--\n      <div style='position: absolute; top: 100px; left: 0;'>\n        <div class='section' style='width: 750px;'>\n          <div class='ul_corner'></div>\n\n          <div class='ur_corner'></div>\n\n          <div class='ll_corner'></div>\n\n          <div class='lr_corner'></div>\n\n          <img alt=\"Custom_services\" src=\"/images/custom_services.png?1489161704\" />\n          <a href=\"/about/customservices\" style=\"font-weight: bold; width: 102px; float: right; margin-right: 45px; margin-top: 33px;\">Learn More ></a>\n          <div class='content' style='float: left; width: 480px; text-align: left; margin-left: 30px;'>\n            <div>\n              Need Help Creating Your Map?\n            </div>\n          </div>\n          <div style='float: left; width: 480px; text-align: left; margin-left: 30px;'>\n            Our professional services team can help you create a great map!\n          </div>\n          <div style='clear:both'></div>\n        </div>\n      </div>\n\n      <div class='spacer' style='height: 132px;'></div>\n    -->\n\n    <div id=\"create_map_section\">\n      <div class=\"section\">\n        <div class=\"ul_corner\" style=\"background: url(/images/dedede-1f842d-ul.gif) no-repeat;\"></div>\n\n        <div class=\"ur_corner\"></div>\n\n        <div class=\"ll_corner\"></div>\n\n        <div class=\"lr_corner\"></div>\n        <div style=\"position:absolute; padding: 0.3em 0.8em 0.3em 0.8em; height: 1.3em; top: -1.8em; left: 0; background-color: #1f842d; color: white;\">\n          <div style=\"position:absolute; top: 0; left: 0; height: 10px; width: 10px; background: url(http://www.communitywalk.com/images/1F842D-ul.gif) no-repeat;\"></div>\n          <div style=\"position:absolute; top: 0; right: 0px; _right: -1px; height: 10px; width: 10px; background: url(http://www.communitywalk.com/images/1F842D-ur.gif) no-repeat;\"></div>\n          <b>Create Professional Maps:</b>&nbsp;&nbsp;<a href=\"/about/commercial\" style=\"color: white;\">learn more</a>\n        </div>\n\n        <div>\n          <img alt=\"Create_a_map\" src=\"/images/create_a_map.png?1489161704\">\n        </div>\n\n        <div class=\"content\">\n          <form action=\"/map\" method=\"post\">\n            <div>\n              Where do you want to start your map?\n            </div>\n            <div>\n              <input class=\"styled_input\" id=\"group_base_location\" name=\"group[base_location]\" onfocus=\"this.value=''\" type=\"text\" value=\"San Francisco, CA\">\n            </div>\n            <div>\n              <input class=\"submit\" name=\"commit\" type=\"submit\" value=\"Get Started!\">\n            </div>\n          </form>\n        </div>\n\n        <div class=\"spacer\" style=\"clear:both\"></div>\n        <div class=\"section_link\">\n          <a href=\"/bulk/edit\">...or bulk import data from Excel to start your map</a>\n        </div>\n      </div>\n    </div>\n<!--\n    <div id='explore_section'>\n      <div class='section'>\n        <div class='ul_corner'></div>\n\n        <div class='ur_corner'></div>\n\n        <div class='ll_corner'></div>\n\n        <div class='lr_corner'></div>\n\n        <div>\n          <img alt=\"Explore\" src=\"/images/explore.png?1489161704\" />\n        </div>\n\n        <div class='content'>\n          <div>\n            Where do you want to start exploring?\n          </div>\n          <div>\n            <input class=\"styled_input\" id=\"placeSearchText\" name=\"placeSearchText\" onfocus=\"this.value=''\" onkeypress=\"if (event.keyCode==13) $('explore_submit').onclick()\" type=\"text\" value=\"New York, NY\" />\n          </div>\n          <div>\n            <input type=\"button\" value=\"Explore!\" id=\"explore_submit\" onclick=\"location='/explore?placeSearchText=' + $('placeSearchText').value;\" class=\"submit\" />\n          </div>\n        </div>\n\n        <div class='spacer' style='clear:both'></div>\n        <div class='section_link'>\n          <a href=\"/recent\">...or check out what people are mapping out right now</a>\n        </div>\n\n      </div>\n    </div>\n-->\n\n    <div class=\"middle_text\">\n      <ul>\n        <li>\n          Create <a href=\"http://www.communitywalk.com/map/111\">personal</a>,\n          <a href=\"http://www.communitywalk.com/map/220\">community</a>,\n          and <a href=\"/about/commercial\">professional</a>\n          maps\n        </li>\n        <li>\n          Show the map on a\n          <a href=\"http://www.golfzoo.com/-dest-AZTU-_param-0,0,3-.htm\" target=\"_new\">website</a> or \n          <a href=\"http://communitywalkblog.blogspot.com/2006/01/new-and-improved-include-your.html\" target=\"_new\">blog</a>\n        </li>\n        <li>\n          Add <a href=\"http://www.communitywalk.com/location_info/3530/22985\">photos</a>,\n          <a href=\"http://www.communitywalk.com/guanajuato/mexico/guanajuato_vacation/map/1561\">videos</a>, comments,\n          <a href=\"http://www.communitywalk.com/san_francisco/sample_map_with_audio/map/27353#0003nTp\">more</a>\n        </li>\n      </ul>\n    </div>\n    \n\n    <div id=\"learn_more_section\">\n      <div class=\"section\">\n        <div class=\"ul_corner\"></div>\n\n        <div class=\"ur_corner\"></div>\n\n        <div class=\"ll_corner\"></div>\n\n        <div class=\"lr_corner\"></div>\n\n        <div>\n          <img alt=\"Tutorials\" src=\"/images/tutorials.gif?1489161704\">\n        </div>\n\n        <div class=\"content\">\n          <a href=\"/about/tutorials\">Tutorials</a> and example maps:\n          <div>\n            <a href=\"http://www.communitywalk.com/map/8151#0003=GQ\" style=\"color:#1f842d\">Real Estate</a> -\n            <a href=\"http://www.communitywalk.com/map/12775#0003Ojl\" style=\"color:#1f842d\">Tourism</a> -\n            <a href=\"http://www.communitywalk.com/map/2539\" style=\"color:#1f842d\">Events</a> -\n            <a href=\"http://www.communitywalk.com/map/3402\" style=\"color:#1f842d\">Hikes</a>\n          </div>\n          <div>\n            <a href=\"http://www.communitywalk.com/map/9909\" style=\"color:#1f842d\">Travel</a> -\n            <a href=\"http://www.communitywalk.com/map/617#0002j7\" style=\"color:#1f842d\">Restaurants</a> -\n            <a href=\"http://www.communitywalk.com/map/7487\" style=\"color:#CF6632\">Professional</a>\n          </div>\n        </div>\n\n        <div style=\"clear:both\"></div>\n      </div>\n    </div>\n\n  </div>\n\n  <div id=\"right_column\">\n    <iframe id=\"login_iframe\" src=\"/welcome/login_simple\" frameborder=\"0\" scrolling=\"no\" marginwidth=\"0\" marginheight=\"0\"></iframe>\n    <!--\n      <div class='spacer' style='height: 132px;'></div>\n    -->\n    <div class=\"right_section\" style=\"position: relative;\">\n      <div style=\"padding: 0.3em 0; height: 1.3em; top: -1.8em; left: 0; background-color: #003265; color: white; text-align: center;\">\n        <div style=\"position:absolute; top: 0; left: 0; height: 10px; width: 10px; background: url(http://www.communitywalk.com/images/003265-ul.gif) no-repeat;\"></div>\n        <div style=\"position:absolute; top: 0; right: 0; height: 10px; width: 10px; background: url(http://www.communitywalk.com/images/003265-ur.gif) no-repeat;\"></div>\n        <div style=\"position:absolute; top: 1.15em; left: 0; height: 10px; width: 10px; background: url(http://www.communitywalk.com/images/003265-ll.gif) no-repeat;\"></div>\n        <div style=\"position:absolute; top: 1.15em; right: 0; height: 10px; width: 10px; background: url(http://www.communitywalk.com/images/003265-lr.gif) no-repeat;\"></div>\n        <b>Getting married?</b> Try <a href=\"http://www.weddingmapper.com\" style=\"color: white;\">Wedding Mapper!</a>\n      </div>\n    </div>\n    <div class=\"right_section\">\n      <div class=\"header\">Featured Map</div>\n      <b><a href=\"/spondon_village_derbyshire/map/1054\" id=\"featured_map_link\">Spondon Village, Derbyshire</a></b>\n      <div class=\"spacer\"></div>\n      <iframe src=\"http://www.communitywalk.com/iframe/content/1054?zoom=-2&amp;whatandwhere=0&amp;types=0\" width=\"310\" height=\"280\" id=\"featured_map\" frameborder=\"0\" scrolling=\"no\"></iframe>\n    </div>\n  </div>\n  <div style=\"clear:both; margin-top: 10px;\"></div>\n  <div id=\"footer\">\n\t<div class=\"main_menu\">\n    <span style=\"float:right\">Â©2014 CommunityWalk Inc.</span>\n    \n    <a href=\"/configure\">My Maps</a> -\n    <a href=\"/about/commercial\">Professional Use</a> -\n    <a href=\"/about\">About</a> -\n    <a href=\"http://communitywalkblog.blogspot.com\">Blog</a> -\n\t\t<a href=\"http://groups.google.com/group/CommunityWalk\">Forum</a> -\n\t\t<a href=\"mailto:general@communitywalk.com\">Contact</a> - \n    <a href=\"/company/policies/terms_of_service\">Terms of Service</a>\n    <br>\n    <div style=\"margin-top: 3px; text-align: center;\">\n      <a href=\"/groups/all_public\">All Public Maps</a>\n      &nbsp; | &nbsp;\n      <a href=\"/groups/all_public_professional\">All Public Professional Maps</a>\n      &nbsp; | &nbsp;\n      <a href=\"http://www.weddingmapper.com/plan\">Most Popular Wedding Areas</a>\n    </div>\n  </div>\n</div>\n\n\n</div>\n\n\n\n\n  \n\n    \n      <script src=\"http://www.google-analytics.com/urchin.js\" type=\"text/javascript\">\n      </script>\n      <script type=\"text/javascript\">\n      _uacct = \"UA-52439-1\";\n      urchinTracker();\n      </script>\n    \n\n  \n    \n\n\n        <script src=\"https://maps.google.com/maps/api/js?key=AIzaSyB35mh2o40skwNWXbrskx-0SLI409C34Rs&amp;libraries=places,geometry,adsense&amp;sensor=false\" type=\"text/javascript\"></script>\n\n        <script type=\"text/javascript\">\n\n<!--//\n// ***************************************** obfuscated/base ********************************************\n\n\nvar Prototype={\nVersion:'1.6.0.3',\nBrowser:{\nIE:!!(window.attachEvent&&\nnavigator.userAgent.indexOf('Opera')===-1),\nOpera:navigator.userAgent.indexOf('Opera')>-1,\nWebKit:navigator.userAgent.indexOf('AppleWebKit/')>-1,\nGecko:navigator.userAgent.indexOf('Gecko')>-1&&\nnavigator.userAgent.indexOf('KHTML')===-1,\nMobileSafari:!!navigator.userAgent.match(/Apple.*Mobile.*Safari/)\n},\nBrowserFeatures:{\nXPath:!!document.evaluate,\nSelectorsAPI:!!document.querySelector,\nElementExtensions:!!window.HTMLElement,\nSpecificElementExtensions:\ndocument.createElement('div')['__proto__']&&\ndocument.createElement('div')['__proto__']!==\ndocument.createElement('form')['__proto__']\n},\nScriptFragment:'<script[^>]*>([\\\\S\\\\s]*?)<\\/script>',\nJSONFilter:/^\\/\\*-secure-([\\s\\S]*)\\*\\/\\s*$/,\nemptyFunction:function(){},\nK:function(x){return x}\n};\nif(Prototype.Browser.MobileSafari)\nPrototype.BrowserFeatures.SpecificElementExtensions=false;\nvar Class={\ncreate:function(){\nvar parent=null,properties=$A(arguments);\nif(Object.isFunction(properties[0]))\nparent=properties.shift();\nfunction klass(){\nthis.initialize.apply(this,arguments);\n}\nObject.extend(klass,Class.Methods);\nklass.superclass=parent;\nklass.subclasses=[];\nif(parent){\nvar subclass=function(){};\nsubclass.prototype=parent.prototype;\nklass.prototype=new subclass;\nparent.subclasses.push(klass);\n}\nfor(var i=0;i<properties.length;i++)\nklass.addMethods(properties[i]);\nif(!klass.prototype.initialize)\nklass.prototype.initialize=Prototype.emptyFunction;\nklass.prototype.constructor=klass;\nreturn klass;\n}\n};\nClass.Methods={\naddMethods:function(source){\nvar ancestor=this.superclass&&this.superclass.prototype;\nvar properties=Object.keys(source);\nif(!Object.keys({toString:true}).length)\nproperties.push(\"toString\",\"valueOf\");\nfor(var i=0,length=properties.length;i<length;i++){\nvar property=properties[i],value=source[property];\nif(ancestor&&Object.isFunction(value)&&\nvalue.argumentNames().first()==\"$super\"){\nvar method=value;\nvalue=(function(m){\nreturn function(){return ancestor[m].apply(this,arguments)};\n})(property).wrap(method);\nvalue.valueOf=method.valueOf.bind(method);\nvalue.toString=method.toString.bind(method);\n}\nthis.prototype[property]=value;\n}\nreturn this;\n}\n};\nvar Abstract={};\nObject.extend=function(destination,source){\nfor(var property in source)\ndestination[property]=source[property];\nreturn destination;\n};\nObject.extend(Object,{\ninspect:function(object){\ntry{\nif(Object.isUndefined(object))return 'undefined';\nif(object===null)return 'null';\nreturn object.inspect?object.inspect():String(object);\n}catch(e){\nif(e instanceof RangeError)return '...';\nthrow e;\n}\n},\ntoJSON:function(object){\nvar type=typeof object;\nswitch(type){\ncase 'undefined':\ncase 'function':\ncase 'unknown':return;\ncase 'boolean':return object.toString();\n}\nif(object===null)return 'null';\nif(object.toJSON)return object.toJSON();\nif(Object.isElement(object))return;\nvar results=[];\nfor(var property in object){\nvar value=Object.toJSON(object[property]);\nif(!Object.isUndefined(value))\nresults.push(property.toJSON()+': '+value);\n}\nreturn '{'+results.join(', ')+'}';\n},\ntoQueryString:function(object){\nreturn $H(object).toQueryString();\n},\ntoHTML:function(object){\nreturn object&&object.toHTML?object.toHTML():String.interpret(object);\n},\nkeys:function(object){\nvar keys=[];\nfor(var property in object)\nkeys.push(property);\nreturn keys;\n},\nvalues:function(object){\nvar values=[];\nfor(var property in object)\nvalues.push(object[property]);\nreturn values;\n},\nclone:function(object){\nreturn Object.extend({},object);\n},\nisElement:function(object){\nreturn !!(object&&object.nodeType==1);\n},\nisArray:function(object){\nreturn object!=null&&typeof object==\"object\"&&\n'splice' in object&&'join' in object;\n},\nisHash:function(object){\nreturn object instanceof Hash;\n},\nisFunction:function(object){\nreturn typeof object==\"function\";\n},\nisString:function(object){\nreturn typeof object==\"string\";\n},\nisNumber:function(object){\nreturn typeof object==\"number\";\n},\nisUndefined:function(object){\nreturn typeof object==\"undefined\";\n}\n});\nObject.extend(Function.prototype,{\nargumentNames:function(){\nvar names=this.toString().match(/^[\\s\\(]*function[^(]*\\(([^\\)]*)\\)/)[1]\n.replace(/\\s+/g,'').split(',');\nreturn names.length==1&&!names[0]?[]:names;\n},\nbind:function(){\nif(arguments.length<2&&Object.isUndefined(arguments[0]))return this;\nvar __method=this,args=$A(arguments),object=args.shift();\nreturn function(){\nreturn __method.apply(object,args.concat($A(arguments)));\n}\n},\nbindAsEventListener:function(){\nvar __method=this,args=$A(arguments),object=args.shift();\nreturn function(event){\nreturn __method.apply(object,[event||window.event].concat(args));\n}\n},\ncurry:function(){\nif(!arguments.length)return this;\nvar __method=this,args=$A(arguments);\nreturn function(){\nreturn __method.apply(this,args.concat($A(arguments)));\n}\n},\ndelay:function(){\nvar __method=this,args=$A(arguments),timeout=args.shift()*1000;\nreturn window.setTimeout(function(){\nreturn __method.apply(__method,args);\n},timeout);\n},\ndefer:function(){\nvar args=[0.01].concat($A(arguments));\nreturn this.delay.apply(this,args);\n},\nwrap:function(wrapper){\nvar __method=this;\nreturn function(){\nreturn wrapper.apply(this,[__method.bind(this)].concat($A(arguments)));\n}\n},\nmethodize:function(){\nif(this._methodized)return this._methodized;\nvar __method=this;\nreturn this._methodized=function(){\nreturn __method.apply(null,[this].concat($A(arguments)));\n};\n}\n});\nDate.prototype.toJSON=function(){\nreturn '\"'+this.getUTCFullYear()+'-'+\n(this.getUTCMonth()+1).toPaddedString(2)+'-'+\nthis.getUTCDate().toPaddedString(2)+'T'+\nthis.getUTCHours().toPaddedString(2)+':'+\nthis.getUTCMinutes().toPaddedString(2)+':'+\nthis.getUTCSeconds().toPaddedString(2)+'Z\"';\n};\nvar Try={\nthese:function(){\nvar returnValue;\nfor(var i=0,length=arguments.length;i<length;i++){\nvar lambda=arguments[i];\ntry{\nreturnValue=lambda();\nbreak;\n}catch(e){}\n}\nreturn returnValue;\n}\n};\nRegExp.prototype.match=RegExp.prototype.test;\nRegExp.escape=function(str){\nreturn String(str).replace(/([.*+?^=!:${}()|[\\]\\/\\\\])/g,'\\\\$1');\n};\nvar PeriodicalExecuter=Class.create({\ninitialize:function(callback,frequency){\nthis.callback=callback;\nthis.frequency=frequency;\nthis.currentlyExecuting=false;\nthis.registerCallback();\n},\nregisterCallback:function(){\nthis.timer=setInterval(this.onTimerEvent.bind(this),this.frequency*1000);\n},\nexecute:function(){\nthis.callback(this);\n},\nstop:function(){\nif(!this.timer)return;\nclearInterval(this.timer);\nthis.timer=null;\n},\nonTimerEvent:function(){\nif(!this.currentlyExecuting){\ntry{\nthis.currentlyExecuting=true;\nthis.execute();\n}finally{\nthis.currentlyExecuting=false;\n}\n}\n}\n});\nObject.extend(String,{\ninterpret:function(value){\nreturn value==null?'':String(value);\n},\nspecialChar:{\n'\\b':'\\\\b',\n'\\t':'\\\\t',\n'\\n':'\\\\n',\n'\\f':'\\\\f',\n'\\r':'\\\\r',\n'\\\\':'\\\\\\\\'\n}\n});\nObject.extend(String.prototype,{\ngsub:function(pattern,replacement){\nvar result='',source=this,match;\nreplacement=arguments.callee.prepareReplacement(replacement);\nwhile(source.length>0){\nif(match=source.match(pattern)){\nresult+=source.slice(0,match.index);\nresult+=String.interpret(replacement(match));\nsource=source.slice(match.index+match[0].length);\n}else{\nresult+=source,source='';\n}\n}\nreturn result;\n},\nsub:function(pattern,replacement,count){\nreplacement=this.gsub.prepareReplacement(replacement);\ncount=Object.isUndefined(count)?1:count;\nreturn this.gsub(pattern,function(match){\nif(--count<0)return match[0];\nreturn replacement(match);\n});\n},\nscan:function(pattern,iterator){\nthis.gsub(pattern,iterator);\nreturn String(this);\n},\ntruncate:function(length,truncation){\nlength=length||30;\ntruncation=Object.isUndefined(truncation)?'...':truncation;\nreturn this.length>length?\nthis.slice(0,length-truncation.length)+truncation:String(this);\n},\nstrip:function(){\nreturn this.replace(/^\\s+/,'').replace(/\\s+$/,'');\n},\nstripTags:function(){\nreturn this.replace(/<\\/?[^>]+>/gi,'');\n},\nstripScripts:function(){\nreturn this.replace(new RegExp(Prototype.ScriptFragment,'img'),'');\n},\nextractScripts:function(){\nvar matchAll=new RegExp(Prototype.ScriptFragment,'img');\nvar matchOne=new RegExp(Prototype.ScriptFragment,'im');\nreturn(this.match(matchAll)||[]).map(function(scriptTag){\nreturn(scriptTag.match(matchOne)||['',''])[1];\n});\n},\nevalScripts:function(){\nreturn this.extractScripts().map(function(script){return eval(script)});\n},\nescapeHTML:function(){\nvar self=arguments.callee;\nself.text.data=this;\nreturn self.div.innerHTML;\n},\nunescapeHTML:function(){\nvar div=new Element('div');\ndiv.innerHTML=this.stripTags();\nreturn div.childNodes[0]?(div.childNodes.length>1?\n$A(div.childNodes).inject('',function(memo,node){return memo+node.nodeValue}):\ndiv.childNodes[0].nodeValue):'';\n},\ntoQueryParams:function(separator){\nvar match=this.strip().match(/([^?#]*)(#.*)?$/);\nif(!match)return{};\nreturn match[1].split(separator||'&').inject({},function(hash,pair){\nif((pair=pair.split('='))[0]){\nvar key=decodeURIComponent(pair.shift());\nvar value=pair.length>1?pair.join('='):pair[0];\nif(value!=undefined)value=decodeURIComponent(value);\nif(key in hash){\nif(!Object.isArray(hash[key]))hash[key]=[hash[key]];\nhash[key].push(value);\n}\nelse hash[key]=value;\n}\nreturn hash;\n});\n},\ntoArray:function(){\nreturn this.split('');\n},\nsucc:function(){\nreturn this.slice(0,this.length-1)+\nString.fromCharCode(this.charCodeAt(this.length-1)+1);\n},\ntimes:function(count){\nreturn count<1?'':new Array(count+1).join(this);\n},\ncamelize:function(){\nvar parts=this.split('-'),len=parts.length;\nif(len==1)return parts[0];\nvar camelized=this.charAt(0)=='-'\n?parts[0].charAt(0).toUpperCase()+parts[0].substring(1)\n:parts[0];\nfor(var i=1;i<len;i++)\ncamelized+=parts[i].charAt(0).toUpperCase()+parts[i].substring(1);\nreturn camelized;\n},\ncapitalize:function(){\nreturn this.charAt(0).toUpperCase()+this.substring(1).toLowerCase();\n},\nunderscore:function(){\nreturn this.gsub(/::/,'/').gsub(/([A-Z]+)([A-Z][a-z])/,'#{1}_#{2}').gsub(/([a-z\\d])([A-Z])/,'#{1}_#{2}').gsub(/-/,'_').toLowerCase();\n},\ndasherize:function(){\nreturn this.gsub(/_/,'-');\n},\ninspect:function(useDoubleQuotes){\nvar escapedString=this.gsub(/[\\x00-\\x1f\\\\]/,function(match){\nvar character=String.specialChar[match[0]];\nreturn character?character:'\\\\u00'+match[0].charCodeAt().toPaddedString(2,16);\n});\nif(useDoubleQuotes)return '\"'+escapedString.replace(/\"/g,'\\\\\"')+'\"';\nreturn \"'\"+escapedString.replace(/'/g,'\\\\\\'') + \"'\";\n},\ntoJSON:function(){\nreturn this.inspect(true);\n},\nunfilterJSON:function(filter){\nreturn this.sub(filter||Prototype.JSONFilter,'#{1}');\n},\nisJSON:function(){\nvar str=this;\nif(str.blank())return false;\nstr=this.replace(/\\\\./g,'@').replace(/\"[^\"\\\\\\n\\r]*\"/g,'');\nreturn(/^[,:{}\\[\\]0-9.\\-+Eaeflnr-u \\n\\r\\t]*$/).test(str);\n},\nevalJSON:function(sanitize){\nvar json=this.unfilterJSON();\ntry{\nif(!sanitize||json.isJSON())return eval('('+json+')');\n}catch(e){}\nthrow new SyntaxError('Badly formed JSON string: '+this.inspect());\n},\ninclude:function(pattern){\nreturn this.indexOf(pattern)>-1;\n},\nstartsWith:function(pattern){\nreturn this.indexOf(pattern)===0;\n},\nendsWith:function(pattern){\nvar d=this.length-pattern.length;\nreturn d>=0&&this.lastIndexOf(pattern)===d;\n},\nempty:function(){\nreturn this=='';\n},\nblank:function(){\nreturn/^\\s*$/.test(this);\n},\ninterpolate:function(object,pattern){\nreturn new Template(this,pattern).evaluate(object);\n}\n});\nif(Prototype.Browser.WebKit||Prototype.Browser.IE)Object.extend(String.prototype,{\nescapeHTML:function(){\nreturn this.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');\n},\nunescapeHTML:function(){\nreturn this.stripTags().replace(/&amp;/g,'&').replace(/&lt;/g,'<').replace(/&gt;/g,'>');\n}\n});\nString.prototype.gsub.prepareReplacement=function(replacement){\nif(Object.isFunction(replacement))return replacement;\nvar template=new Template(replacement);\nreturn function(match){return template.evaluate(match)};\n};\nString.prototype.parseQuery=String.prototype.toQueryParams;\nObject.extend(String.prototype.escapeHTML,{\ndiv:document.createElement('div'),\ntext:document.createTextNode('')\n});\nString.prototype.escapeHTML.div.appendChild(String.prototype.escapeHTML.text);\nvar Template=Class.create({\ninitialize:function(template,pattern){\nthis.template=template.toString();\nthis.pattern=pattern||Template.Pattern;\n},\nevaluate:function(object){\nif(Object.isFunction(object.toTemplateReplacements))\nobject=object.toTemplateReplacements();\nreturn this.template.gsub(this.pattern,function(match){\nif(object==null)return '';\nvar before=match[1]||'';\nif(before=='\\\\')return match[2];\nvar ctx=object,expr=match[3];\nvar pattern=/^([^.[]+|\\[((?:.*?[^\\\\])?)\\])(\\.|\\[|$)/;\nmatch=pattern.exec(expr);\nif(match==null)return before;\nwhile(match!=null){\nvar comp=match[1].startsWith('[')?match[2].gsub('\\\\\\\\]',']'):match[1];\nctx=ctx[comp];\nif(null==ctx||''==match[3])break;\nexpr=expr.substring('['==match[3]?match[1].length:match[0].length);\nmatch=pattern.exec(expr);\n}\nreturn before+String.interpret(ctx);\n});\n}\n});\nTemplate.Pattern=/(^|.|\\r|\\n)(#\\{(.*?)\\})/;\nvar $break={};\nvar Enumerable={\neach:function(iterator,context){\nvar index=0;\ntry{\nthis._each(function(value){\niterator.call(context,value,index++);\n});\n}catch(e){\nif(e!=$break)throw e;\n}\nreturn this;\n},\neachSlice:function(number,iterator,context){\nvar index=-number,slices=[],array=this.toArray();\nif(number<1)return array;\nwhile((index+=number)<array.length)\nslices.push(array.slice(index,index+number));\nreturn slices.collect(iterator,context);\n},\nall:function(iterator,context){\niterator=iterator||Prototype.K;\nvar result=true;\nthis.each(function(value,index){\nresult=result&&!!iterator.call(context,value,index);\nif(!result)throw $break;\n});\nreturn result;\n},\nany:function(iterator,context){\niterator=iterator||Prototype.K;\nvar result=false;\nthis.each(function(value,index){\nif(result=!!iterator.call(context,value,index))\nthrow $break;\n});\nreturn result;\n},\ncollect:function(iterator,context){\niterator=iterator||Prototype.K;\nvar results=[];\nthis.each(function(value,index){\nresults.push(iterator.call(context,value,index));\n});\nreturn results;\n},\ndetect:function(iterator,context){\nvar result;\nthis.each(function(value,index){\nif(iterator.call(context,value,index)){\nresult=value;\nthrow $break;\n}\n});\nreturn result;\n},\nfindAll:function(iterator,context){\nvar results=[];\nthis.each(function(value,index){\nif(iterator.call(context,value,index))\nresults.push(value);\n});\nreturn results;\n},\ngrep:function(filter,iterator,context){\niterator=iterator||Prototype.K;\nvar results=[];\nif(Object.isString(filter))\nfilter=new RegExp(filter);\nthis.each(function(value,index){\nif(filter.match(value))\nresults.push(iterator.call(context,value,index));\n});\nreturn results;\n},\ninclude:function(object){\nif(Object.isFunction(this.indexOf))\nif(this.indexOf(object)!=-1&&this.indexOf(object)!=false)return true;\nvar found=false;\nthis.each(function(value){\nif(value==object){\nfound=true;\nthrow $break;\n}\n});\nreturn found;\n},\ninGroupsOf:function(number,fillWith){\nfillWith=Object.isUndefined(fillWith)?null:fillWith;\nreturn this.eachSlice(number,function(slice){\nwhile(slice.length<number)slice.push(fillWith);\nreturn slice;\n});\n},\ninject:function(memo,iterator,context){\nthis.each(function(value,index){\nmemo=iterator.call(context,memo,value,index);\n});\nreturn memo;\n},\ninvoke:function(method){\nvar args=$A(arguments).slice(1);\nreturn this.map(function(value){\nreturn value[method].apply(value,args);\n});\n},\nmax:function(iterator,context){\niterator=iterator||Prototype.K;\nvar result;\nthis.each(function(value,index){\nvalue=iterator.call(context,value,index);\nif(result==null||value>=result)\nresult=value;\n});\nreturn result;\n},\nmin:function(iterator,context){\niterator=iterator||Prototype.K;\nvar result;\nthis.each(function(value,index){\nvalue=iterator.call(context,value,index);\nif(result==null||value<result)\nresult=value;\n});\nreturn result;\n},\npartition:function(iterator,context){\niterator=iterator||Prototype.K;\nvar trues=[],falses=[];\nthis.each(function(value,index){\n(iterator.call(context,value,index)?\ntrues:falses).push(value);\n});\nreturn[trues,falses];\n},\npluck:function(property){\nvar results=[];\nthis.each(function(value){\nresults.push(value[property]);\n});\nreturn results;\n},\nreject:function(iterator,context){\nvar results=[];\nthis.each(function(value,index){\nif(!iterator.call(context,value,index))\nresults.push(value);\n});\nreturn results;\n},\nsortBy:function(iterator,context){\nreturn this.map(function(value,index){\nreturn{\nvalue:value,\ncriteria:iterator.call(context,value,index)\n};\n}).sort(function(left,right){\nvar a=left.criteria,b=right.criteria;\nreturn a<b?-1:a>b?1:0;\n}).pluck('value');\n},\ntoArray:function(){\nreturn this.map();\n},\nzip:function(){\nvar iterator=Prototype.K,args=$A(arguments);\nif(Object.isFunction(args.last()))\niterator=args.pop();\nvar collections=[this].concat(args).map($A);\nreturn this.map(function(value,index){\nreturn iterator(collections.pluck(index));\n});\n},\nsize:function(){\nreturn this.toArray().length;\n},\ninspect:function(){\nreturn '#<Enumerable:'+this.toArray().inspect()+'>';\n}\n};\nObject.extend(Enumerable,{\nmap:Enumerable.collect,\nfind:Enumerable.detect,\nselect:Enumerable.findAll,\nfilter:Enumerable.findAll,\nmember:Enumerable.include,\nentries:Enumerable.toArray,\nevery:Enumerable.all,\nsome:Enumerable.any\n});\nfunction $A(iterable){\nif(!iterable)return[];\nif(iterable.toArray)return iterable.toArray();\nvar length=iterable.length||0,results=new Array(length);\nwhile(length--)results[length]=iterable[length];\nreturn results;\n}\nif(Prototype.Browser.WebKit){\n$A=function(iterable){\nif(!iterable)return[];\nif(!(typeof iterable==='function'&&typeof iterable.length===\n'number'&&typeof iterable.item==='function')&&iterable.toArray)\nreturn iterable.toArray();\nvar length=iterable.length||0,results=new Array(length);\nwhile(length--)results[length]=iterable[length];\nreturn results;\n};\n}\nArray.from=$A;\nObject.extend(Array.prototype,Enumerable);\nif(!Array.prototype._reverse)Array.prototype._reverse=Array.prototype.reverse;\nObject.extend(Array.prototype,{\n_each:function(iterator){\nfor(var i=0,length=this.length;i<length;i++)\niterator(this[i]);\n},\nclear:function(){\nthis.length=0;\nreturn this;\n},\nfirst:function(){\nreturn this[0];\n},\nlast:function(){\nreturn this[this.length-1];\n},\ncompact:function(){\nreturn this.select(function(value){\nreturn value!=null;\n});\n},\nflatten:function(){\nreturn this.inject([],function(array,value){\nreturn array.concat(Object.isArray(value)?\nvalue.flatten():[value]);\n});\n},\nwithout:function(){\nvar values=$A(arguments);\nreturn this.select(function(value){\nreturn !values.include(value);\n});\n},\nreverse:function(inline){\nreturn(inline!==false?this:this.toArray())._reverse();\n},\nreduce:function(){\nreturn this.length>1?this:this[0];\n},\nuniq:function(sorted){\nreturn this.inject([],function(array,value,index){\nif(0==index||(sorted?array.last()!=value:!array.include(value)))\narray.push(value);\nreturn array;\n});\n},\nintersect:function(array){\nreturn this.uniq().findAll(function(item){\nreturn array.detect(function(value){return item===value});\n});\n},\nclone:function(){\nreturn[].concat(this);\n},\nsize:function(){\nreturn this.length;\n},\ninspect:function(){\nreturn '['+this.map(Object.inspect).join(', ')+']';\n},\ntoJSON:function(){\nvar results=[];\nthis.each(function(object){\nvar value=Object.toJSON(object);\nif(!Object.isUndefined(value))results.push(value);\n});\nreturn '['+results.join(', ')+']';\n}\n});\nif(Object.isFunction(Array.prototype.forEach))\nArray.prototype._each=Array.prototype.forEach;\nif(!Array.prototype.indexOf)Array.prototype.indexOf=function(item,i){\ni||(i=0);\nvar length=this.length;\nif(i<0)i=length+i;\nfor(;i<length;i++)\nif(this[i]===item)return i;\nreturn -1;\n};\nif(!Array.prototype.lastIndexOf)Array.prototype.lastIndexOf=function(item,i){\ni=isNaN(i)?this.length:(i<0?this.length+i:i)+1;\nvar n=this.slice(0,i).reverse().indexOf(item);\nreturn(n<0)?n:i-n-1;\n};\nArray.prototype.toArray=Array.prototype.clone;\nfunction $w(string){\nif(!Object.isString(string))return[];\nstring=string.strip();\nreturn string?string.split(/\\s+/):[];\n}\nif(Prototype.Browser.Opera){\nArray.prototype.concat=function(){\nvar array=[];\nfor(var i=0,length=this.length;i<length;i++)array.push(this[i]);\nfor(var i=0,length=arguments.length;i<length;i++){\nif(Object.isArray(arguments[i])){\nfor(var j=0,arrayLength=arguments[i].length;j<arrayLength;j++)\narray.push(arguments[i][j]);\n}else{\narray.push(arguments[i]);\n}\n}\nreturn array;\n};\n}\nObject.extend(Number.prototype,{\ntoColorPart:function(){\nreturn this.toPaddedString(2,16);\n},\nsucc:function(){\nreturn this +1;\n},\ntimes:function(iterator,context){\n$R(0,this,true).each(iterator,context);\nreturn this;\n},\ntoPaddedString:function(length,radix){\nvar string=this.toString(radix||10);\nreturn '0'.times(length-string.length)+string;\n},\ntoJSON:function(){\nreturn isFinite(this)?this.toString():'null';\n}\n});\n$w('abs round ceil floor').each(function(method){\nNumber.prototype[method]=Math[method].methodize();\n});\nfunction $H(object){\nreturn new Hash(object);\n};\nvar Hash=Class.create(Enumerable,(function(){\nfunction toQueryPair(key,value){\nif(Object.isUndefined(value))return key;\nreturn key+'='+encodeURIComponent(String.interpret(value));\n}\nreturn{\ninitialize:function(object){\nthis._object=Object.isHash(object)?object.toObject():Object.clone(object);\n},\n_each:function(iterator){\nfor(var key in this._object){\nvar value=this._object[key],pair=[key,value];\npair.key=key;\npair.value=value;\niterator(pair);\n}\n},\nset:function(key,value){\nreturn this._object[key]=value;\n},\nget:function(key){\nif(this._object[key]!==Object.prototype[key])\nreturn this._object[key];\n},\nunset:function(key){\nvar value=this._object[key];\ndelete this._object[key];\nreturn value;\n},\ntoObject:function(){\nreturn Object.clone(this._object);\n},\nkeys:function(){\nreturn this.pluck('key');\n},\nvalues:function(){\nreturn this.pluck('value');\n},\nindex:function(value){\nvar match=this.detect(function(pair){\nreturn pair.value===value;\n});\nreturn match&&match.key;\n},\nmerge:function(object){\nreturn this.clone().update(object);\n},\nupdate:function(object){\nreturn new Hash(object).inject(this,function(result,pair){\nresult.set(pair.key,pair.value);\nreturn result;\n});\n},\ntoQueryString:function(){\nreturn this.inject([],function(results,pair){\nvar key=encodeURIComponent(pair.key),values=pair.value;\nif(values&&typeof values=='object'){\nif(Object.isArray(values))\nreturn results.concat(values.map(toQueryPair.curry(key)));\n}else results.push(toQueryPair(key,values));\nreturn results;\n}).join('&');\n},\ninspect:function(){\nreturn '#<Hash:{'+this.map(function(pair){\nreturn pair.map(Object.inspect).join(': ');\n}).join(', ')+'}>';\n},\ntoJSON:function(){\nreturn Object.toJSON(this.toObject());\n},\nclone:function(){\nreturn new Hash(this);\n}\n}\n})());\nHash.prototype.toTemplateReplacements=Hash.prototype.toObject;\nHash.from=$H;\nvar ObjectRange=Class.create(Enumerable,{\ninitialize:function(start,end,exclusive){\nthis.start=start;\nthis.end=end;\nthis.exclusive=exclusive;\n},\n_each:function(iterator){\nvar value=this.start;\nwhile(this.include(value)){\niterator(value);\nvalue=value.succ();\n}\n},\ninclude:function(value){\nif(value<this.start)\nreturn false;\nif(this.exclusive)\nreturn value<this.end;\nreturn value<=this.end;\n}\n});\nvar $R=function(start,end,exclusive){\nreturn new ObjectRange(start,end,exclusive);\n};\nvar Ajax={\ngetTransport:function(){\nreturn Try.these(\nfunction(){return new XMLHttpRequest()},\nfunction(){return new ActiveXObject('Msxml2.XMLHTTP')},\nfunction(){return new ActiveXObject('Microsoft.XMLHTTP')}\n)||false;\n},\nactiveRequestCount:0\n};\nAjax.Responders={\nresponders:[],\n_each:function(iterator){\nthis.responders._each(iterator);\n},\nregister:function(responder){\nif(!this.include(responder))\nthis.responders.push(responder);\n},\nunregister:function(responder){\nthis.responders=this.responders.without(responder);\n},\ndispatch:function(callback,request,transport,json){\nthis.each(function(responder){\nif(Object.isFunction(responder[callback])){\ntry{\nresponder[callback].apply(responder,[request,transport,json]);\n}catch(e){}\n}\n});\n}\n};\nObject.extend(Ajax.Responders,Enumerable);\nAjax.Responders.register({\nonCreate:function(){Ajax.activeRequestCount++},\nonComplete:function(){Ajax.activeRequestCount--}\n});\nAjax.Base=Class.create({\ninitialize:function(options){\nthis.options={\nmethod:'post',\nasynchronous:true,\ncontentType:'application/x-www-form-urlencoded',\nencoding:'UTF-8',\nparameters:'',\nevalJSON:true,\nevalJS:true\n};\nObject.extend(this.options,options||{});\nthis.options.method=this.options.method.toLowerCase();\nif(Object.isString(this.options.parameters))\nthis.options.parameters=this.options.parameters.toQueryParams();\nelse if(Object.isHash(this.options.parameters))\nthis.options.parameters=this.options.parameters.toObject();\n}\n});\nAjax.Request=Class.create(Ajax.Base,{\n_complete:false,\ninitialize:function($super,url,options){\n$super(options);\nthis.transport=Ajax.getTransport();\nthis.request(url);\n},\nrequest:function(url){\nthis.url=url;\nthis.method=this.options.method;\nvar params=Object.clone(this.options.parameters);\nif(!['get','post'].include(this.method)){\nparams['_method']=this.method;\nthis.method='post';\n}\nthis.parameters=params;\nif(params=Object.toQueryString(params)){\nif(this.method=='get')\nthis.url+=(this.url.include('?')?'&':'?')+params;\nelse if(/Konqueror|Safari|KHTML/.test(navigator.userAgent))\nparams+='&_=';\n}\ntry{\nvar response=new Ajax.Response(this);\nif(this.options.onCreate)this.options.onCreate(response);\nAjax.Responders.dispatch('onCreate',this,response);\nthis.transport.open(this.method.toUpperCase(),this.url,\nthis.options.asynchronous);\nif(this.options.asynchronous)this.respondToReadyState.bind(this).defer(1);\nthis.transport.onreadystatechange=this.onStateChange.bind(this);\nthis.setRequestHeaders();\nthis.body=this.method=='post'?(this.options.postBody||params):null;\nthis.transport.send(this.body);\nif(!this.options.asynchronous&&this.transport.overrideMimeType)\nthis.onStateChange();\n}\ncatch(e){\nthis.dispatchException(e);\n}\n},\nonStateChange:function(){\nvar readyState=this.transport.readyState;\nif(readyState>1&&!((readyState==4)&&this._complete))\nthis.respondToReadyState(this.transport.readyState);\n},\nsetRequestHeaders:function(){\nvar headers={\n'X-Requested-With':'XMLHttpRequest',\n'X-Prototype-Version':Prototype.Version,\n'Accept':'text/javascript, text/html, application/xml, text/xml, */*'\n};\nif(this.method=='post'){\nheaders['Content-type']=this.options.contentType+\n(this.options.encoding?'; charset='+this.options.encoding:'');\nif(this.transport.overrideMimeType&&\n(navigator.userAgent.match(/Gecko\\/(\\d{4})/)||[0,2005])[1]<2005)\nheaders['Connection']='close';\n}\nif(typeof this.options.requestHeaders=='object'){\nvar extras=this.options.requestHeaders;\nif(Object.isFunction(extras.push))\nfor(var i=0,length=extras.length;i<length;i+=2)\nheaders[extras[i]]=extras[i+1];\nelse\n$H(extras).each(function(pair){headers[pair.key]=pair.value});\n}\nfor(var name in headers)\nthis.transport.setRequestHeader(name,headers[name]);\n},\nsuccess:function(){\nvar status=this.getStatus();\nreturn !status||(status>=200&&status<300);\n},\ngetStatus:function(){\ntry{\nreturn this.transport.status||0;\n}catch(e){return 0}\n},\nrespondToReadyState:function(readyState){\nvar state=Ajax.Request.Events[readyState],response=new Ajax.Response(this);\nif(state=='Complete'){\ntry{\nthis._complete=true;\n(this.options['on'+response.status]\n||this.options['on'+(this.success()?'Success':'Failure')]\n||Prototype.emptyFunction)(response,response.headerJSON);\n}catch(e){\nthis.dispatchException(e);\n}\nvar contentType=response.getHeader('Content-type');\nif(this.options.evalJS=='force'\n||(this.options.evalJS&&this.isSameOrigin()&&contentType\n&&contentType.match(/^\\s*(text|application)\\/(x-)?(java|ecma)script(;.*)?\\s*$/i)))\nthis.evalResponse();\n}\ntry{\n(this.options['on'+state]||Prototype.emptyFunction)(response,response.headerJSON);\nAjax.Responders.dispatch('on'+state,this,response,response.headerJSON);\n}catch(e){\nthis.dispatchException(e);\n}\nif(state=='Complete'){\nthis.transport.onreadystatechange=Prototype.emptyFunction;\n}\n},\nisSameOrigin:function(){\nvar m=this.url.match(/^\\s*https?:\\/\\/[^\\/]*/);\nreturn !m||(m[0]=='#{protocol}//#{domain}#{port}'.interpolate({\nprotocol:location.protocol,\ndomain:document.domain,\nport:location.port?':'+location.port:''\n}));\n},\ngetHeader:function(name){\ntry{\nreturn this.transport.getResponseHeader(name)||null;\n}catch(e){return null}\n},\nevalResponse:function(){\ntry{\nreturn eval((this.transport.responseText||'').unfilterJSON());\n}catch(e){\nthis.dispatchException(e);\n}\n},\ndispatchException:function(exception){\n(this.options.onException||Prototype.emptyFunction)(this,exception);\nAjax.Responders.dispatch('onException',this,exception);\n}\n});\nAjax.Request.Events=\n['Uninitialized','Loading','Loaded','Interactive','Complete'];\nAjax.Response=Class.create({\ninitialize:function(request){\nthis.request=request;\nvar transport=this.transport=request.transport,\nreadyState=this.readyState=transport.readyState;\nif((readyState>2&&!Prototype.Browser.IE)||readyState==4){\nthis.status=this.getStatus();\nthis.statusText=this.getStatusText();\nthis.responseText=String.interpret(transport.responseText);\nthis.headerJSON=this._getHeaderJSON();\n}\nif(readyState==4){\nvar xml=transport.responseXML;\nthis.responseXML=Object.isUndefined(xml)?null:xml;\nthis.responseJSON=this._getResponseJSON();\n}\n},\nstatus:0,\nstatusText:'',\ngetStatus:Ajax.Request.prototype.getStatus,\ngetStatusText:function(){\ntry{\nreturn this.transport.statusText||'';\n}catch(e){return ''}\n},\ngetHeader:Ajax.Request.prototype.getHeader,\ngetAllHeaders:function(){\ntry{\nreturn this.getAllResponseHeaders();\n}catch(e){return null}\n},\ngetResponseHeader:function(name){\nreturn this.transport.getResponseHeader(name);\n},\ngetAllResponseHeaders:function(){\nreturn this.transport.getAllResponseHeaders();\n},\n_getHeaderJSON:function(){\nvar json=this.getHeader('X-JSON');\nif(!json)return null;\njson=decodeURIComponent(escape(json));\ntry{\nreturn json.evalJSON(this.request.options.sanitizeJSON||\n!this.request.isSameOrigin());\n}catch(e){\nthis.request.dispatchException(e);\n}\n},\n_getResponseJSON:function(){\nvar options=this.request.options;\nif(!options.evalJSON||(options.evalJSON!='force'&&\n!(this.getHeader('Content-type')||'').include('application/json'))||\nthis.responseText.blank())\nreturn null;\ntry{\nreturn this.responseText.evalJSON(options.sanitizeJSON||\n!this.request.isSameOrigin());\n}catch(e){\nthis.request.dispatchException(e);\n}\n}\n});\nAjax.Updater=Class.create(Ajax.Request,{\ninitialize:function($super,container,url,options){\nthis.container={\nsuccess:(container.success||container),\nfailure:(container.failure||(container.success?null:container))\n};\noptions=Object.clone(options);\nvar onComplete=options.onComplete;\noptions.onComplete=(function(response,json){\nthis.updateContent(response.responseText);\nif(Object.isFunction(onComplete))onComplete(response,json);\n}).bind(this);\n$super(url,options);\n},\nupdateContent:function(responseText){\nvar receiver=this.container[this.success()?'success':'failure'],\noptions=this.options;\nif(!options.evalScripts)responseText=responseText.stripScripts();\nif(receiver=$(receiver)){\nif(options.insertion){\nif(Object.isString(options.insertion)){\nvar insertion={};insertion[options.insertion]=responseText;\nreceiver.insert(insertion);\n}\nelse options.insertion(receiver,responseText);\n}\nelse receiver.update(responseText);\n}\n}\n});\nAjax.PeriodicalUpdater=Class.create(Ajax.Base,{\ninitialize:function($super,container,url,options){\n$super(options);\nthis.onComplete=this.options.onComplete;\nthis.frequency=(this.options.frequency||2);\nthis.decay=(this.options.decay||1);\nthis.updater={};\nthis.container=container;\nthis.url=url;\nthis.start();\n},\nstart:function(){\nthis.options.onComplete=this.updateComplete.bind(this);\nthis.onTimerEvent();\n},\nstop:function(){\nthis.updater.options.onComplete=undefined;\nclearTimeout(this.timer);\n(this.onComplete||Prototype.emptyFunction).apply(this,arguments);\n},\nupdateComplete:function(response){\nif(this.options.decay){\nthis.decay=(response.responseText==this.lastText?\nthis.decay*this.options.decay:1);\nthis.lastText=response.responseText;\n}\nthis.timer=this.onTimerEvent.bind(this).delay(this.decay*this.frequency);\n},\nonTimerEvent:function(){\nthis.updater=new Ajax.Updater(this.container,this.url,this.options);\n}\n});\nfunction $(element){\nif(arguments.length>1){\nfor(var i=0,elements=[],length=arguments.length;i<length;i++)\nelements.push($(arguments[i]));\nreturn elements;\n}\nif(Object.isString(element))\nelement=document.getElementById(element);\nreturn Element.extend(element);\n}\nif(Prototype.BrowserFeatures.XPath){\ndocument._getElementsByXPath=function(expression,parentElement){\nvar results=[];\nvar query=document.evaluate(expression,$(parentElement)||document,\nnull,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);\nfor(var i=0,length=query.snapshotLength;i<length;i++)\nresults.push(Element.extend(query.snapshotItem(i)));\nreturn results;\n};\n}\nif(!window.Node)var Node={};\nif(!Node.ELEMENT_NODE){\nObject.extend(Node,{\nELEMENT_NODE:1,\nATTRIBUTE_NODE:2,\nTEXT_NODE:3,\nCDATA_SECTION_NODE:4,\nENTITY_REFERENCE_NODE:5,\nENTITY_NODE:6,\nPROCESSING_INSTRUCTION_NODE:7,\nCOMMENT_NODE:8,\nDOCUMENT_NODE:9,\nDOCUMENT_TYPE_NODE:10,\nDOCUMENT_FRAGMENT_NODE:11,\nNOTATION_NODE:12\n});\n}\n(function(){\nvar element=this.Element;\nthis.Element=function(tagName,attributes){\nattributes=attributes||{};\ntagName=tagName.toLowerCase();\nvar cache=Element.cache;\nif(Prototype.Browser.IE&&attributes.name){\ntagName='<'+tagName+' name=\"'+attributes.name+'\">';\ndelete attributes.name;\nreturn Element.writeAttribute(document.createElement(tagName),attributes);\n}\nif(!cache[tagName])cache[tagName]=Element.extend(document.createElement(tagName));\nreturn Element.writeAttribute(cache[tagName].cloneNode(false),attributes);\n};\nObject.extend(this.Element,element||{});\nif(element)this.Element.prototype=element.prototype;\n}).call(window);\nElement.cache={};\nElement.Methods={\nvisible:function(element){\nreturn $(element).style.display!='none';\n},\ntoggle:function(element){\nelement=$(element);\nElement[Element.visible(element)?'hide':'show'](element);\nreturn element;\n},\nhide:function(element){\nelement=$(element);\nelement.style.display='none';\nreturn element;\n},\nshow:function(element){\nelement=$(element);\nelement.style.display='';\nreturn element;\n},\nremove:function(element){\nelement=$(element);\nelement.parentNode.removeChild(element);\nreturn element;\n},\nupdate:function(element,content){\nelement=$(element);\nif(content&&content.toElement)content=content.toElement();\nif(Object.isElement(content))return element.update().insert(content);\ncontent=Object.toHTML(content);\nelement.innerHTML=content.stripScripts();\ncontent.evalScripts.bind(content).defer();\nreturn element;\n},\nreplace:function(element,content){\nelement=$(element);\nif(content&&content.toElement)content=content.toElement();\nelse if(!Object.isElement(content)){\ncontent=Object.toHTML(content);\nvar range=element.ownerDocument.createRange();\nrange.selectNode(element);\ncontent.evalScripts.bind(content).defer();\ncontent=range.createContextualFragment(content.stripScripts());\n}\nelement.parentNode.replaceChild(content,element);\nreturn element;\n},\ninsert:function(element,insertions){\nelement=$(element);\nif(Object.isString(insertions)||Object.isNumber(insertions)||\nObject.isElement(insertions)||(insertions&&(insertions.toElement||insertions.toHTML)))\ninsertions={bottom:insertions};\nvar content,insert,tagName,childNodes;\nfor(var position in insertions){\ncontent=insertions[position];\nposition=position.toLowerCase();\ninsert=Element._insertionTranslations[position];\nif(content&&content.toElement)content=content.toElement();\nif(Object.isElement(content)){\ninsert(element,content);\ncontinue;\n}\ncontent=Object.toHTML(content);\ntagName=((position=='before'||position=='after')\n?element.parentNode:element).tagName.toUpperCase();\nchildNodes=Element._getContentFromAnonymousElement(tagName,content.stripScripts());\nif(position=='top'||position=='after')childNodes.reverse();\nchildNodes.each(insert.curry(element));\ncontent.evalScripts.bind(content).defer();\n}\nreturn element;\n},\nwrap:function(element,wrapper,attributes){\nelement=$(element);\nif(Object.isElement(wrapper))\n$(wrapper).writeAttribute(attributes||{});\nelse if(Object.isString(wrapper))wrapper=new Element(wrapper,attributes);\nelse wrapper=new Element('div',wrapper);\nif(element.parentNode)\nelement.parentNode.replaceChild(wrapper,element);\nwrapper.appendChild(element);\nreturn wrapper;\n},\ninspect:function(element){\nelement=$(element);\nvar result='<'+element.tagName.toLowerCase();\n$H({'id':'id','className':'class'}).each(function(pair){\nvar property=pair.first(),attribute=pair.last();\nvar value=(element[property]||'').toString();\nif(value)result+=' '+attribute+'='+value.inspect(true);\n});\nreturn result+'>';\n},\nrecursivelyCollect:function(element,property){\nelement=$(element);\nvar elements=[];\nwhile(element=element[property])\nif(element.nodeType==1)\nelements.push(Element.extend(element));\nreturn elements;\n},\nancestors:function(element){\nreturn $(element).recursivelyCollect('parentNode');\n},\ndescendants:function(element){\nreturn $(element).select(\"*\");\n},\nfirstDescendant:function(element){\nelement=$(element).firstChild;\nwhile(element&&element.nodeType!=1)element=element.nextSibling;\nreturn $(element);\n},\nimmediateDescendants:function(element){\nif(!(element=$(element).firstChild))return[];\nwhile(element&&element.nodeType!=1)element=element.nextSibling;\nif(element)return[element].concat($(element).nextSiblings());\nreturn[];\n},\npreviousSiblings:function(element){\nreturn $(element).recursivelyCollect('previousSibling');\n},\nnextSiblings:function(element){\nreturn $(element).recursivelyCollect('nextSibling');\n},\nsiblings:function(element){\nelement=$(element);\nreturn element.previousSiblings().reverse().concat(element.nextSiblings());\n},\nmatch:function(element,selector){\nif(Object.isString(selector))\nselector=new Selector(selector);\nreturn selector.match($(element));\n},\nup:function(element,expression,index){\nelement=$(element);\nif(arguments.length==1)return $(element.parentNode);\nvar ancestors=element.ancestors();\nreturn Object.isNumber(expression)?ancestors[expression]:\nSelector.findElement(ancestors,expression,index);\n},\ndown:function(element,expression,index){\nelement=$(element);\nif(arguments.length==1)return element.firstDescendant();\nreturn Object.isNumber(expression)?element.descendants()[expression]:\nElement.select(element,expression)[index||0];\n},\nprevious:function(element,expression,index){\nelement=$(element);\nif(arguments.length==1)return $(Selector.handlers.previousElementSibling(element));\nvar previousSiblings=element.previousSiblings();\nreturn Object.isNumber(expression)?previousSiblings[expression]:\nSelector.findElement(previousSiblings,expression,index);\n},\nnext:function(element,expression,index){\nelement=$(element);\nif(arguments.length==1)return $(Selector.handlers.nextElementSibling(element));\nvar nextSiblings=element.nextSiblings();\nreturn Object.isNumber(expression)?nextSiblings[expression]:\nSelector.findElement(nextSiblings,expression,index);\n},\nselect:function(){\nvar args=$A(arguments),element=$(args.shift());\nreturn Selector.findChildElements(element,args);\n},\nadjacent:function(){\nvar args=$A(arguments),element=$(args.shift());\nreturn Selector.findChildElements(element.parentNode,args).without(element);\n},\nidentify:function(element){\nelement=$(element);\nvar id=element.readAttribute('id'),self=arguments.callee;\nif(id)return id;\ndo{id='anonymous_element_'+self.counter++}while($(id));\nelement.writeAttribute('id',id);\nreturn id;\n},\nreadAttribute:function(element,name){\nelement=$(element);\nif(Prototype.Browser.IE){\nvar t=Element._attributeTranslations.read;\nif(t.values[name])return t.values[name](element,name);\nif(t.names[name])name=t.names[name];\nif(name.include(':')){\nreturn(!element.attributes||!element.attributes[name])?null:\nelement.attributes[name].value;\n}\n}\nreturn element.getAttribute(name);\n},\nwriteAttribute:function(element,name,value){\nelement=$(element);\nvar attributes={},t=Element._attributeTranslations.write;\nif(typeof name=='object')attributes=name;\nelse attributes[name]=Object.isUndefined(value)?true:value;\nfor(var attr in attributes){\nname=t.names[attr]||attr;\nvalue=attributes[attr];\nif(t.values[attr])name=t.values[attr](element,value);\nif(value===false||value===null)\nelement.removeAttribute(name);\nelse if(value===true)\nelement.setAttribute(name,name);\nelse element.setAttribute(name,value);\n}\nreturn element;\n},\ngetHeight:function(element){\nreturn $(element).getDimensions().height;\n},\ngetWidth:function(element){\nreturn $(element).getDimensions().width;\n},\nclassNames:function(element){\nreturn new Element.ClassNames(element);\n},\nhasClassName:function(element,className){\nif(!(element=$(element)))return;\nvar elementClassName=element.className;\nreturn(elementClassName.length>0&&(elementClassName==className||\nnew RegExp(\"(^|\\\\s)\"+className+\"(\\\\s|$)\").test(elementClassName)));\n},\naddClassName:function(element,className){\nif(!(element=$(element)))return;\nif(!element.hasClassName(className))\nelement.className+=(element.className?' ':'')+className;\nreturn element;\n},\nremoveClassName:function(element,className){\nif(!(element=$(element)))return;\nelement.className=element.className.replace(\nnew RegExp(\"(^|\\\\s+)\"+className+\"(\\\\s+|$)\"),' ').strip();\nreturn element;\n},\ntoggleClassName:function(element,className){\nif(!(element=$(element)))return;\nreturn element[element.hasClassName(className)?\n'removeClassName':'addClassName'](className);\n},\ncleanWhitespace:function(element){\nelement=$(element);\nvar node=element.firstChild;\nwhile(node){\nvar nextNode=node.nextSibling;\nif(node.nodeType==3&&!/\\S/.test(node.nodeValue))\nelement.removeChild(node);\nnode=nextNode;\n}\nreturn element;\n},\nempty:function(element){\nreturn $(element).innerHTML.blank();\n},\ndescendantOf:function(element,ancestor){\nelement=$(element),ancestor=$(ancestor);\nif(element.compareDocumentPosition)\nreturn(element.compareDocumentPosition(ancestor)&8)===8;\nif(ancestor.contains)\nreturn ancestor.contains(element)&&ancestor!==element;\nwhile(element=element.parentNode)\nif(element==ancestor)return true;\nreturn false;\n},\nscrollTo:function(element){\nelement=$(element);\nvar pos=element.cumulativeOffset();\nwindow.scrollTo(pos[0],pos[1]);\nreturn element;\n},\ngetStyle:function(element,style){\nelement=$(element);\nstyle=style=='float'?'cssFloat':style.camelize();\nvar value=element.style[style];\nif(!value||value=='auto'){\nvar css=document.defaultView.getComputedStyle(element,null);\nvalue=css?css[style]:null;\n}\nif(style=='opacity')return value?parseFloat(value):1.0;\nreturn value=='auto'?null:value;\n},\ngetOpacity:function(element){\nreturn $(element).getStyle('opacity');\n},\nsetStyle:function(element,styles){\nelement=$(element);\nvar elementStyle=element.style,match;\nif(Object.isString(styles)){\nelement.style.cssText+=';'+styles;\nreturn styles.include('opacity')?\nelement.setOpacity(styles.match(/opacity:\\s*(\\d?\\.?\\d*)/)[1]):element;\n}\nfor(var property in styles)\nif(property=='opacity')element.setOpacity(styles[property]);\nelse\nelementStyle[(property=='float'||property=='cssFloat')?\n(Object.isUndefined(elementStyle.styleFloat)?'cssFloat':'styleFloat'):\nproperty]=styles[property];\nreturn element;\n},\nsetOpacity:function(element,value){\nelement=$(element);\nelement.style.opacity=(value==1||value==='')?'':\n(value<0.00001)?0:value;\nreturn element;\n},\ngetDimensions:function(element){\nelement=$(element);\nvar display=element.getStyle('display');\nif(display!='none'&&display!=null)\nreturn{width:element.offsetWidth,height:element.offsetHeight};\nvar els=element.style;\nvar originalVisibility=els.visibility;\nvar originalPosition=els.position;\nvar originalDisplay=els.display;\nels.visibility='hidden';\nels.position='absolute';\nels.display='block';\nvar originalWidth=element.clientWidth;\nvar originalHeight=element.clientHeight;\nels.display=originalDisplay;\nels.position=originalPosition;\nels.visibility=originalVisibility;\nreturn{width:originalWidth,height:originalHeight};\n},\nmakePositioned:function(element){\nelement=$(element);\nvar pos=Element.getStyle(element,'position');\nif(pos=='static'||!pos){\nelement._madePositioned=true;\nelement.style.position='relative';\nif(Prototype.Browser.Opera){\nelement.style.top=0;\nelement.style.left=0;\n}\n}\nreturn element;\n},\nundoPositioned:function(element){\nelement=$(element);\nif(element._madePositioned){\nelement._madePositioned=undefined;\nelement.style.position=\nelement.style.top=\nelement.style.left=\nelement.style.bottom=\nelement.style.right='';\n}\nreturn element;\n},\nmakeClipping:function(element){\nelement=$(element);\nif(element._overflow)return element;\nelement._overflow=Element.getStyle(element,'overflow')||'auto';\nif(element._overflow!=='hidden')\nelement.style.overflow='hidden';\nreturn element;\n},\nundoClipping:function(element){\nelement=$(element);\nif(!element._overflow)return element;\nelement.style.overflow=element._overflow=='auto'?'':element._overflow;\nelement._overflow=null;\nreturn element;\n},\ncumulativeOffset:function(element){\nvar valueT=0,valueL=0;\ndo{\nvalueT+=element.offsetTop||0;\nvalueL+=element.offsetLeft||0;\nelement=element.offsetParent;\n}while(element);\nreturn Element._returnOffset(valueL,valueT);\n},\npositionedOffset:function(element){\nvar valueT=0,valueL=0;\ndo{\nvalueT+=element.offsetTop||0;\nvalueL+=element.offsetLeft||0;\nelement=element.offsetParent;\nif(element){\nif(element.tagName.toUpperCase()=='BODY')break;\nvar p=Element.getStyle(element,'position');\nif(p!=='static')break;\n}\n}while(element);\nreturn Element._returnOffset(valueL,valueT);\n},\nabsolutize:function(element){\nelement=$(element);\nif(element.getStyle('position')=='absolute')return element;\nvar offsets=element.positionedOffset();\nvar top=offsets[1];\nvar left=offsets[0];\nvar width=element.clientWidth;\nvar height=element.clientHeight;\nelement._originalLeft=left-parseFloat(element.style.left||0);\nelement._originalTop=top-parseFloat(element.style.top||0);\nelement._originalWidth=element.style.width;\nelement._originalHeight=element.style.height;\nelement.style.position='absolute';\nelement.style.top=top+'px';\nelement.style.left=left+'px';\nelement.style.width=width+'px';\nelement.style.height=height+'px';\nreturn element;\n},\nrelativize:function(element){\nelement=$(element);\nif(element.getStyle('position')=='relative')return element;\nelement.style.position='relative';\nvar top=parseFloat(element.style.top||0)-(element._originalTop||0);\nvar left=parseFloat(element.style.left||0)-(element._originalLeft||0);\nelement.style.top=top+'px';\nelement.style.left=left+'px';\nelement.style.height=element._originalHeight;\nelement.style.width=element._originalWidth;\nreturn element;\n},\ncumulativeScrollOffset:function(element){\nvar valueT=0,valueL=0;\ndo{\nvalueT+=element.scrollTop||0;\nvalueL+=element.scrollLeft||0;\nelement=element.parentNode;\n}while(element);\nreturn Element._returnOffset(valueL,valueT);\n},\ngetOffsetParent:function(element){\nif(element.offsetParent)return $(element.offsetParent);\nif(element==document.body)return $(element);\nwhile((element=element.parentNode)&&element!=document.body)\nif(Element.getStyle(element,'position')!='static')\nreturn $(element);\nreturn $(document.body);\n},\nviewportOffset:function(forElement){\nvar valueT=0,valueL=0;\nvar element=forElement;\ndo{\nvalueT+=element.offsetTop||0;\nvalueL+=element.offsetLeft||0;\nif(element.offsetParent==document.body&&\nElement.getStyle(element,'position')=='absolute')break;\n}while(element=element.offsetParent);\nelement=forElement;\ndo{\nif(!Prototype.Browser.Opera||(element.tagName&&(element.tagName.toUpperCase()=='BODY'))){\nvalueT-=element.scrollTop||0;\nvalueL-=element.scrollLeft||0;\n}\n}while(element=element.parentNode);\nreturn Element._returnOffset(valueL,valueT);\n},\nclonePosition:function(element,source){\nvar options=Object.extend({\nsetLeft:true,\nsetTop:true,\nsetWidth:true,\nsetHeight:true,\noffsetTop:0,\noffsetLeft:0\n},arguments[2]||{});\nsource=$(source);\nvar p=source.viewportOffset();\nelement=$(element);\nvar delta=[0,0];\nvar parent=null;\nif(Element.getStyle(element,'position')=='absolute'){\nparent=element.getOffsetParent();\ndelta=parent.viewportOffset();\n}\nif(parent==document.body){\ndelta[0]-=document.body.offsetLeft;\ndelta[1]-=document.body.offsetTop;\n}\nif(options.setLeft)element.style.left=(p[0]-delta[0]+options.offsetLeft)+'px';\nif(options.setTop)element.style.top=(p[1]-delta[1]+options.offsetTop)+'px';\nif(options.setWidth)element.style.width=source.offsetWidth+'px';\nif(options.setHeight)element.style.height=source.offsetHeight+'px';\nreturn element;\n}\n};\nElement.Methods.identify.counter=1;\nObject.extend(Element.Methods,{\ngetElementsBySelector:Element.Methods.select,\nchildElements:Element.Methods.immediateDescendants\n});\nElement._attributeTranslations={\nwrite:{\nnames:{\nclassName:'class',\nhtmlFor:'for'\n},\nvalues:{}\n}\n};\nif(Prototype.Browser.Opera){\nElement.Methods.getStyle=Element.Methods.getStyle.wrap(\nfunction(proceed,element,style){\nswitch(style){\ncase 'left':case 'top':case 'right':case 'bottom':\nif(proceed(element,'position')==='static')return null;\ncase 'height':case 'width':\nif(!Element.visible(element))return null;\nvar dim=parseInt(proceed(element,style),10);\nif(dim!==element['offset'+style.capitalize()])\nreturn dim+'px';\nvar properties;\nif(style==='height'){\nproperties=['border-top-width','padding-top',\n'padding-bottom','border-bottom-width'];\n}\nelse{\nproperties=['border-left-width','padding-left',\n'padding-right','border-right-width'];\n}\nreturn properties.inject(dim,function(memo,property){\nvar val=proceed(element,property);\nreturn val===null?memo:memo-parseInt(val,10);\n})+'px';\ndefault:return proceed(element,style);\n}\n}\n);\nElement.Methods.readAttribute=Element.Methods.readAttribute.wrap(\nfunction(proceed,element,attribute){\nif(attribute==='title')return element.title;\nreturn proceed(element,attribute);\n}\n);\n}\nelse if(Prototype.Browser.IE){\nElement.Methods.getOffsetParent=Element.Methods.getOffsetParent.wrap(\nfunction(proceed,element){\nelement=$(element);\ntry{element.offsetParent}\ncatch(e){return $(document.body)}\nvar position=element.getStyle('position');\nif(position!=='static')return proceed(element);\nelement.setStyle({position:'relative'});\nvar value=proceed(element);\nelement.setStyle({position:position});\nreturn value;\n}\n);\n$w('positionedOffset viewportOffset').each(function(method){\nElement.Methods[method]=Element.Methods[method].wrap(\nfunction(proceed,element){\nelement=$(element);\ntry{element.offsetParent}\ncatch(e){return Element._returnOffset(0,0)}\nvar position=element.getStyle('position');\nif(position!=='static')return proceed(element);\nvar offsetParent=element.getOffsetParent();\nif(offsetParent&&offsetParent.getStyle('position')==='fixed')\noffsetParent.setStyle({zoom:1});\nelement.setStyle({position:'relative'});\nvar value=proceed(element);\nelement.setStyle({position:position});\nreturn value;\n}\n);\n});\nElement.Methods.cumulativeOffset=Element.Methods.cumulativeOffset.wrap(\nfunction(proceed,element){\ntry{element.offsetParent}\ncatch(e){return Element._returnOffset(0,0)}\nreturn proceed(element);\n}\n);\nElement.Methods.getStyle=function(element,style){\nelement=$(element);\nstyle=(style=='float'||style=='cssFloat')?'styleFloat':style.camelize();\nvar value=element.style[style];\nif(!value&&element.currentStyle)value=element.currentStyle[style];\nif(style=='opacity'){\nif(value=(element.getStyle('filter')||'').match(/alpha\\(opacity=(.*)\\)/))\nif(value[1])return parseFloat(value[1])/100;\nreturn 1.0;\n}\nif(value=='auto'){\nif((style=='width'||style=='height')&&(element.getStyle('display')!='none'))\nreturn element['offset'+style.capitalize()]+'px';\nreturn null;\n}\nreturn value;\n};\nElement.Methods.setOpacity=function(element,value){\nfunction stripAlpha(filter){\nreturn filter.replace(/alpha\\([^\\)]*\\)/gi,'');\n}\nelement=$(element);\nvar currentStyle=element.currentStyle;\nif((currentStyle&&!currentStyle.hasLayout)||\n(!currentStyle&&element.style.zoom=='normal'))\nelement.style.zoom=1;\nvar filter=element.getStyle('filter'),style=element.style;\nif(value==1||value===''){\n(filter=stripAlpha(filter))?\nstyle.filter=filter:style.removeAttribute('filter');\nreturn element;\n}else if(value<0.00001)value=0;\nstyle.filter=stripAlpha(filter)+\n'alpha(opacity='+(value*100)+')';\nreturn element;\n};\nElement._attributeTranslations={\nread:{\nnames:{\n'class':'className',\n'for':'htmlFor'\n},\nvalues:{\n_getAttr:function(element,attribute){\nreturn element.getAttribute(attribute,2);\n},\n_getAttrNode:function(element,attribute){\nvar node=element.getAttributeNode(attribute);\nreturn node?node.value:\"\";\n},\n_getEv:function(element,attribute){\nattribute=element.getAttribute(attribute);\nreturn attribute?attribute.toString().slice(23,-2):null;\n},\n_flag:function(element,attribute){\nreturn $(element).hasAttribute(attribute)?attribute:null;\n},\nstyle:function(element){\nreturn element.style.cssText.toLowerCase();\n},\ntitle:function(element){\nreturn element.title;\n}\n}\n}\n};\nElement._attributeTranslations.write={\nnames:Object.extend({\ncellpadding:'cellPadding',\ncellspacing:'cellSpacing'\n},Element._attributeTranslations.read.names),\nvalues:{\nchecked:function(element,value){\nelement.checked=!!value;\n},\nstyle:function(element,value){\nelement.style.cssText=value?value:'';\n}\n}\n};\nElement._attributeTranslations.has={};\n$w('colSpan rowSpan vAlign dateTime accessKey tabIndex '+\n'encType maxLength readOnly longDesc frameBorder').each(function(attr){\nElement._attributeTranslations.write.names[attr.toLowerCase()]=attr;\nElement._attributeTranslations.has[attr.toLowerCase()]=attr;\n});\n(function(v){\nObject.extend(v,{\nhref:v._getAttr,\nsrc:v._getAttr,\ntype:v._getAttr,\naction:v._getAttrNode,\ndisabled:v._flag,\nchecked:v._flag,\nreadonly:v._flag,\nmultiple:v._flag,\nonload:v._getEv,\nonunload:v._getEv,\nonclick:v._getEv,\nondblclick:v._getEv,\nonmousedown:v._getEv,\nonmouseup:v._getEv,\nonmouseover:v._getEv,\nonmousemove:v._getEv,\nonmouseout:v._getEv,\nonfocus:v._getEv,\nonblur:v._getEv,\nonkeypress:v._getEv,\nonkeydown:v._getEv,\nonkeyup:v._getEv,\nonsubmit:v._getEv,\nonreset:v._getEv,\nonselect:v._getEv,\nonchange:v._getEv\n});\n})(Element._attributeTranslations.read.values);\n}\nelse if(Prototype.Browser.Gecko&&/rv:1\\.8\\.0/.test(navigator.userAgent)){\nElement.Methods.setOpacity=function(element,value){\nelement=$(element);\nelement.style.opacity=(value==1)?0.999999:\n(value==='')?'':(value<0.00001)?0:value;\nreturn element;\n};\n}\nelse if(Prototype.Browser.WebKit){\nElement.Methods.setOpacity=function(element,value){\nelement=$(element);\nelement.style.opacity=(value==1||value==='')?'':\n(value<0.00001)?0:value;\nif(value==1)\nif(element.tagName.toUpperCase()=='IMG'&&element.width){\nelement.width++;element.width--;\n}else try{\nvar n=document.createTextNode(' ');\nelement.appendChild(n);\nelement.removeChild(n);\n}catch(e){}\nreturn element;\n};\nElement.Methods.cumulativeOffset=function(element){\nvar valueT=0,valueL=0;\ndo{\nvalueT+=element.offsetTop||0;\nvalueL+=element.offsetLeft||0;\nif(element.offsetParent==document.body)\nif(Element.getStyle(element,'position')=='absolute')break;\nelement=element.offsetParent;\n}while(element);\nreturn Element._returnOffset(valueL,valueT);\n};\n}\nif(Prototype.Browser.IE||Prototype.Browser.Opera){\nElement.Methods.update=function(element,content){\nelement=$(element);\nif(content&&content.toElement)content=content.toElement();\nif(Object.isElement(content))return element.update().insert(content);\ncontent=Object.toHTML(content);\nvar tagName=element.tagName.toUpperCase();\nif(tagName in Element._insertionTranslations.tags){\n$A(element.childNodes).each(function(node){element.removeChild(node)});\nElement._getContentFromAnonymousElement(tagName,content.stripScripts())\n.each(function(node){element.appendChild(node)});\n}\nelse element.innerHTML=content.stripScripts();\ncontent.evalScripts.bind(content).defer();\nreturn element;\n};\n}\nif('outerHTML' in document.createElement('div')){\nElement.Methods.replace=function(element,content){\nelement=$(element);\nif(content&&content.toElement)content=content.toElement();\nif(Object.isElement(content)){\nelement.parentNode.replaceChild(content,element);\nreturn element;\n}\ncontent=Object.toHTML(content);\nvar parent=element.parentNode,tagName=parent.tagName.toUpperCase();\nif(Element._insertionTranslations.tags[tagName]){\nvar nextSibling=element.next();\nvar fragments=Element._getContentFromAnonymousElement(tagName,content.stripScripts());\nparent.removeChild(element);\nif(nextSibling)\nfragments.each(function(node){parent.insertBefore(node,nextSibling)});\nelse\nfragments.each(function(node){parent.appendChild(node)});\n}\nelse element.outerHTML=content.stripScripts();\ncontent.evalScripts.bind(content).defer();\nreturn element;\n};\n}\nElement._returnOffset=function(l,t){\nvar result=[l,t];\nresult.left=l;\nresult.top=t;\nreturn result;\n};\nElement._getContentFromAnonymousElement=function(tagName,html){\nvar div=new Element('div'),t=Element._insertionTranslations.tags[tagName];\nif(t){\ndiv.innerHTML=t[0]+html+t[1];\nt[2].times(function(){div=div.firstChild});\n}else div.innerHTML=html;\nreturn $A(div.childNodes);\n};\nElement._insertionTranslations={\nbefore:function(element,node){\nelement.parentNode.insertBefore(node,element);\n},\ntop:function(element,node){\nelement.insertBefore(node,element.firstChild);\n},\nbottom:function(element,node){\nelement.appendChild(node);\n},\nafter:function(element,node){\nelement.parentNode.insertBefore(node,element.nextSibling);\n},\ntags:{\nTABLE:['<table>','</table>',1],\nTBODY:['<table><tbody>','</tbody></table>',2],\nTR:['<table><tbody><tr>','</tr></tbody></table>',3],\nTD:['<table><tbody><tr><td>','</td></tr></tbody></table>',4],\nSELECT:['<select>','</select>',1]\n}\n};\n(function(){\nObject.extend(this.tags,{\nTHEAD:this.tags.TBODY,\nTFOOT:this.tags.TBODY,\nTH:this.tags.TD\n});\n}).call(Element._insertionTranslations);\nElement.Methods.Simulated={\nhasAttribute:function(element,attribute){\nattribute=Element._attributeTranslations.has[attribute]||attribute;\nvar node=$(element).getAttributeNode(attribute);\nreturn !!(node&&node.specified);\n}\n};\nElement.Methods.ByTag={};\nObject.extend(Element,Element.Methods);\nif(!Prototype.BrowserFeatures.ElementExtensions&&\ndocument.createElement('div')['__proto__']){\nwindow.HTMLElement={};\nwindow.HTMLElement.prototype=document.createElement('div')['__proto__'];\nPrototype.BrowserFeatures.ElementExtensions=true;\n}\nElement.extend=(function(){\nif(Prototype.BrowserFeatures.SpecificElementExtensions)\nreturn Prototype.K;\nvar Methods={},ByTag=Element.Methods.ByTag;\nvar extend=Object.extend(function(element){\nif(!element||element._extendedByPrototype||\nelement.nodeType!=1||element==window)return element;\nvar methods=Object.clone(Methods),\ntagName=element.tagName.toUpperCase(),property,value;\nif(ByTag[tagName])Object.extend(methods,ByTag[tagName]);\nfor(property in methods){\nvalue=methods[property];\nif(Object.isFunction(value)&&!(property in element))\nelement[property]=value.methodize();\n}\nelement._extendedByPrototype=Prototype.emptyFunction;\nreturn element;\n},{\nrefresh:function(){\nif(!Prototype.BrowserFeatures.ElementExtensions){\nObject.extend(Methods,Element.Methods);\nObject.extend(Methods,Element.Methods.Simulated);\n}\n}\n});\nextend.refresh();\nreturn extend;\n})();\nElement.hasAttribute=function(element,attribute){\nif(element.hasAttribute)return element.hasAttribute(attribute);\nreturn Element.Methods.Simulated.hasAttribute(element,attribute);\n};\nElement.addMethods=function(methods){\nvar F=Prototype.BrowserFeatures,T=Element.Methods.ByTag;\nif(!methods){\nObject.extend(Form,Form.Methods);\nObject.extend(Form.Element,Form.Element.Methods);\nObject.extend(Element.Methods.ByTag,{\n\"FORM\":Object.clone(Form.Methods),\n\"INPUT\":Object.clone(Form.Element.Methods),\n\"SELECT\":Object.clone(Form.Element.Methods),\n\"TEXTAREA\":Object.clone(Form.Element.Methods)\n});\n}\nif(arguments.length==2){\nvar tagName=methods;\nmethods=arguments[1];\n}\nif(!tagName)Object.extend(Element.Methods,methods||{});\nelse{\nif(Object.isArray(tagName))tagName.each(extend);\nelse extend(tagName);\n}\nfunction extend(tagName){\ntagName=tagName.toUpperCase();\nif(!Element.Methods.ByTag[tagName])\nElement.Methods.ByTag[tagName]={};\nObject.extend(Element.Methods.ByTag[tagName],methods);\n}\nfunction copy(methods,destination,onlyIfAbsent){\nonlyIfAbsent=onlyIfAbsent||false;\nfor(var property in methods){\nvar value=methods[property];\nif(!Object.isFunction(value))continue;\nif(!onlyIfAbsent||!(property in destination))\ndestination[property]=value.methodize();\n}\n}\nfunction findDOMClass(tagName){\nvar klass;\nvar trans={\n\"OPTGROUP\":\"OptGroup\",\"TEXTAREA\":\"TextArea\",\"P\":\"Paragraph\",\n\"FIELDSET\":\"FieldSet\",\"UL\":\"UList\",\"OL\":\"OList\",\"DL\":\"DList\",\n\"DIR\":\"Directory\",\"H1\":\"Heading\",\"H2\":\"Heading\",\"H3\":\"Heading\",\n\"H4\":\"Heading\",\"H5\":\"Heading\",\"H6\":\"Heading\",\"Q\":\"Quote\",\n\"INS\":\"Mod\",\"DEL\":\"Mod\",\"A\":\"Anchor\",\"IMG\":\"Image\",\"CAPTION\":\n\"TableCaption\",\"COL\":\"TableCol\",\"COLGROUP\":\"TableCol\",\"THEAD\":\n\"TableSection\",\"TFOOT\":\"TableSection\",\"TBODY\":\"TableSection\",\"TR\":\n\"TableRow\",\"TH\":\"TableCell\",\"TD\":\"TableCell\",\"FRAMESET\":\n\"FrameSet\",\"IFRAME\":\"IFrame\"\n};\nif(trans[tagName])klass='HTML'+trans[tagName]+'Element';\nif(window[klass])return window[klass];\nklass='HTML'+tagName+'Element';\nif(window[klass])return window[klass];\nklass='HTML'+tagName.capitalize()+'Element';\nif(window[klass])return window[klass];\nwindow[klass]={};\nwindow[klass].prototype=document.createElement(tagName)['__proto__'];\nreturn window[klass];\n}\nif(F.ElementExtensions){\ncopy(Element.Methods,HTMLElement.prototype);\ncopy(Element.Methods.Simulated,HTMLElement.prototype,true);\n}\nif(F.SpecificElementExtensions){\nfor(var tag in Element.Methods.ByTag){\nvar klass=findDOMClass(tag);\nif(Object.isUndefined(klass))continue;\ncopy(T[tag],klass.prototype);\n}\n}\nObject.extend(Element,Element.Methods);\ndelete Element.ByTag;\nif(Element.extend.refresh)Element.extend.refresh();\nElement.cache={};\n};\ndocument.viewport={\ngetDimensions:function(){\nvar dimensions={},B=Prototype.Browser;\n$w('width height').each(function(d){\nvar D=d.capitalize();\nif(B.WebKit&&!document.evaluate){\ndimensions[d]=self['inner'+D];\n}else if(B.Opera&&parseFloat(window.opera.version())<9.5){\ndimensions[d]=document.body['client'+D]\n}else{\ndimensions[d]=document.documentElement['client'+D];\n}\n});\nreturn dimensions;\n},\ngetWidth:function(){\nreturn this.getDimensions().width;\n},\ngetHeight:function(){\nreturn this.getDimensions().height;\n},\ngetScrollOffsets:function(){\nreturn Element._returnOffset(\nwindow.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,\nwindow.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop);\n}\n};\nvar Selector=Class.create({\ninitialize:function(expression){\nthis.expression=expression.strip();\nif(this.shouldUseSelectorsAPI()){\nthis.mode='selectorsAPI';\n}else if(this.shouldUseXPath()){\nthis.mode='xpath';\nthis.compileXPathMatcher();\n}else{\nthis.mode=\"normal\";\nthis.compileMatcher();\n}\n},\nshouldUseXPath:function(){\nif(!Prototype.BrowserFeatures.XPath)return false;\nvar e=this.expression;\nif(Prototype.Browser.WebKit&&\n(e.include(\"-of-type\")||e.include(\":empty\")))\nreturn false;\nif((/(\\[[\\w-]*?:|:checked)/).test(e))\nreturn false;\nreturn true;\n},\nshouldUseSelectorsAPI:function(){\nif(!Prototype.BrowserFeatures.SelectorsAPI)return false;\nif(!Selector._div)Selector._div=new Element('div');\ntry{\nSelector._div.querySelector(this.expression);\n}catch(e){\nreturn false;\n}\nreturn true;\n},\ncompileMatcher:function(){\nvar e=this.expression,ps=Selector.patterns,h=Selector.handlers,\nc=Selector.criteria,le,p,m;\nif(Selector._cache[e]){\nthis.matcher=Selector._cache[e];\nreturn;\n}\nthis.matcher=[\"this.matcher = function(root) {\",\n\"var r = root, h = Selector.handlers, c = false, n;\"];\nwhile(e&&le!=e&&(/\\S/).test(e)){\nle=e;\nfor(var i in ps){\np=ps[i];\nif(m=e.match(p)){\nthis.matcher.push(Object.isFunction(c[i])?c[i](m):\nnew Template(c[i]).evaluate(m));\ne=e.replace(m[0],'');\nbreak;\n}\n}\n}\nthis.matcher.push(\"return h.unique(n);\\n}\");\neval(this.matcher.join('\\n'));\nSelector._cache[this.expression]=this.matcher;\n},\ncompileXPathMatcher:function(){\nvar e=this.expression,ps=Selector.patterns,\nx=Selector.xpath,le,m;\nif(Selector._cache[e]){\nthis.xpath=Selector._cache[e];return;\n}\nthis.matcher=['.//*'];\nwhile(e&&le!=e&&(/\\S/).test(e)){\nle=e;\nfor(var i in ps){\nif(m=e.match(ps[i])){\nthis.matcher.push(Object.isFunction(x[i])?x[i](m):\nnew Template(x[i]).evaluate(m));\ne=e.replace(m[0],'');\nbreak;\n}\n}\n}\nthis.xpath=this.matcher.join('');\nSelector._cache[this.expression]=this.xpath;\n},\nfindElements:function(root){\nroot=root||document;\nvar e=this.expression,results;\nswitch(this.mode){\ncase 'selectorsAPI':\nif(root!==document){\nvar oldId=root.id,id=$(root).identify();\ne=\"#\"+id+\" \"+e;\n}\nresults=$A(root.querySelectorAll(e)).map(Element.extend);\nroot.id=oldId;\nreturn results;\ncase 'xpath':\nreturn document._getElementsByXPath(this.xpath,root);\ndefault:\nreturn this.matcher(root);\n}\n},\nmatch:function(element){\nthis.tokens=[];\nvar e=this.expression,ps=Selector.patterns,as=Selector.assertions;\nvar le,p,m;\nwhile(e&&le!==e&&(/\\S/).test(e)){\nle=e;\nfor(var i in ps){\np=ps[i];\nif(m=e.match(p)){\nif(as[i]){\nthis.tokens.push([i,Object.clone(m)]);\ne=e.replace(m[0],'');\n}else{\nreturn this.findElements(document).include(element);\n}\n}\n}\n}\nvar match=true,name,matches;\nfor(var i=0,token;token=this.tokens[i];i++){\nname=token[0],matches=token[1];\nif(!Selector.assertions[name](element,matches)){\nmatch=false;break;\n}\n}\nreturn match;\n},\ntoString:function(){\nreturn this.expression;\n},\ninspect:function(){\nreturn \"#<Selector:\"+this.expression.inspect()+\">\";\n}\n});\nObject.extend(Selector,{\n_cache:{},\nxpath:{\ndescendant:\"//*\",\nchild:\"/*\",\nadjacent:\"/following-sibling::*[1]\",\nlaterSibling:'/following-sibling::*',\ntagName:function(m){\nif(m[1]=='*')return '';\nreturn \"[local-name()='\"+m[1].toLowerCase()+\n\"' or local-name()='\"+m[1].toUpperCase()+\"']\";\n},\nclassName:\"[contains(concat(' ', @class, ' '), ' #{1} ')]\",\nid:\"[@id='#{1}']\",\nattrPresence:function(m){\nm[1]=m[1].toLowerCase();\nreturn new Template(\"[@#{1}]\").evaluate(m);\n},\nattr:function(m){\nm[1]=m[1].toLowerCase();\nm[3]=m[5]||m[6];\nreturn new Template(Selector.xpath.operators[m[2]]).evaluate(m);\n},\npseudo:function(m){\nvar h=Selector.xpath.pseudos[m[1]];\nif(!h)return '';\nif(Object.isFunction(h))return h(m);\nreturn new Template(Selector.xpath.pseudos[m[1]]).evaluate(m);\n},\noperators:{\n'=':\"[@#{1}='#{3}']\",\n'!=':\"[@#{1}!='#{3}']\",\n'^=':\"[starts-with(@#{1}, '#{3}')]\",\n'$=':\"[substring(@#{1}, (string-length(@#{1}) - string-length('#{3}') + 1))='#{3}']\",\n'*=':\"[contains(@#{1}, '#{3}')]\",\n'~=':\"[contains(concat(' ', @#{1}, ' '), ' #{3} ')]\",\n'|=':\"[contains(concat('-', @#{1}, '-'), '-#{3}-')]\"\n},\npseudos:{\n'first-child':'[not(preceding-sibling::*)]',\n'last-child':'[not(following-sibling::*)]',\n'only-child':'[not(preceding-sibling::* or following-sibling::*)]',\n'empty':\"[count(*) = 0 and (count(text()) = 0)]\",\n'checked':\"[@checked]\",\n'disabled':\"[(@disabled) and (@type!='hidden')]\",\n'enabled':\"[not(@disabled) and (@type!='hidden')]\",\n'not':function(m){\nvar e=m[6],p=Selector.patterns,\nx=Selector.xpath,le,v;\nvar exclusion=[];\nwhile(e&&le!=e&&(/\\S/).test(e)){\nle=e;\nfor(var i in p){\nif(m=e.match(p[i])){\nv=Object.isFunction(x[i])?x[i](m):new Template(x[i]).evaluate(m);\nexclusion.push(\"(\"+v.substring(1,v.length-1)+\")\");\ne=e.replace(m[0],'');\nbreak;\n}\n}\n}\nreturn \"[not(\"+exclusion.join(\" and \")+\")]\";\n},\n'nth-child':function(m){\nreturn Selector.xpath.pseudos.nth(\"(count(./preceding-sibling::*) + 1) \",m);\n},\n'nth-last-child':function(m){\nreturn Selector.xpath.pseudos.nth(\"(count(./following-sibling::*) + 1) \",m);\n},\n'nth-of-type':function(m){\nreturn Selector.xpath.pseudos.nth(\"position() \",m);\n},\n'nth-last-of-type':function(m){\nreturn Selector.xpath.pseudos.nth(\"(last() + 1 - position()) \",m);\n},\n'first-of-type':function(m){\nm[6]=\"1\";return Selector.xpath.pseudos['nth-of-type'](m);\n},\n'last-of-type':function(m){\nm[6]=\"1\";return Selector.xpath.pseudos['nth-last-of-type'](m);\n},\n'only-of-type':function(m){\nvar p=Selector.xpath.pseudos;return p['first-of-type'](m)+p['last-of-type'](m);\n},\nnth:function(fragment,m){\nvar mm,formula=m[6],predicate;\nif(formula=='even')formula='2n+0';\nif(formula=='odd')formula='2n+1';\nif(mm=formula.match(/^(\\d+)$/))\nreturn '['+fragment+\"= \"+mm[1]+']';\nif(mm=formula.match(/^(-?\\d*)?n(([+-])(\\d+))?/)){\nif(mm[1]==\"-\")mm[1]=-1;\nvar a=mm[1]?Number(mm[1]):1;\nvar b=mm[2]?Number(mm[2]):0;\npredicate=\"[((#{fragment} - #{b}) mod #{a} = 0) and \"+\n\"((#{fragment} - #{b}) div #{a} >= 0)]\";\nreturn new Template(predicate).evaluate({\nfragment:fragment,a:a,b:b});\n}\n}\n}\n},\ncriteria:{\ntagName:'n = h.tagName(n, r, \"#{1}\", c);      c = false;',\nclassName:'n = h.className(n, r, \"#{1}\", c);    c = false;',\nid:'n = h.id(n, r, \"#{1}\", c);           c = false;',\nattrPresence:'n = h.attrPresence(n, r, \"#{1}\", c); c = false;',\nattr:function(m){\nm[3]=(m[5]||m[6]);\nreturn new Template('n = h.attr(n, r, \"#{1}\", \"#{3}\", \"#{2}\", c); c = false;').evaluate(m);\n},\npseudo:function(m){\nif(m[6])m[6]=m[6].replace(/\"/g,'\\\\\"');\nreturn new Template('n = h.pseudo(n, \"#{1}\", \"#{6}\", r, c); c = false;').evaluate(m);\n},\ndescendant:'c = \"descendant\";',\nchild:'c = \"child\";',\nadjacent:'c = \"adjacent\";',\nlaterSibling:'c = \"laterSibling\";'\n},\npatterns:{\nlaterSibling:/^\\s*~\\s*/,\nchild:/^\\s*>\\s*/,\nadjacent:/^\\s*\\+\\s*/,\ndescendant:/^\\s/,\ntagName:/^\\s*(\\*|[\\w\\-]+)(\\b|$)?/,\nid:/^#([\\w\\-\\*]+)(\\b|$)/,\nclassName:/^\\.([\\w\\-\\*]+)(\\b|$)/,\npseudo:\n/^:((first|last|nth|nth-last|only)(-child|-of-type)|empty|checked|(en|dis)abled|not)(\\((.*?)\\))?(\\b|$|(?=\\s|[:+~>]))/,\nattrPresence:/^\\[((?:[\\w]+:)?[\\w]+)\\]/,\nattr:/\\[((?:[\\w-]*:)?[\\w-]+)\\s*(?:([!^$*~|]?=)\\s*((['\"])([^\\4]*?)\\4|([^'\"][^\\]]*?)))?\\]/\n},\nassertions:{\ntagName:function(element,matches){\nreturn matches[1].toUpperCase()==element.tagName.toUpperCase();\n},\nclassName:function(element,matches){\nreturn Element.hasClassName(element,matches[1]);\n},\nid:function(element,matches){\nreturn element.id===matches[1];\n},\nattrPresence:function(element,matches){\nreturn Element.hasAttribute(element,matches[1]);\n},\nattr:function(element,matches){\nvar nodeValue=Element.readAttribute(element,matches[1]);\nreturn nodeValue&&Selector.operators[matches[2]](nodeValue,matches[5]||matches[6]);\n}\n},\nhandlers:{\nconcat:function(a,b){\nfor(var i=0,node;node=b[i];i++)\na.push(node);\nreturn a;\n},\nmark:function(nodes){\nvar _true=Prototype.emptyFunction;\nfor(var i=0,node;node=nodes[i];i++)\nnode._countedByPrototype=_true;\nreturn nodes;\n},\nunmark:function(nodes){\nfor(var i=0,node;node=nodes[i];i++)\nnode._countedByPrototype=undefined;\nreturn nodes;\n},\nindex:function(parentNode,reverse,ofType){\nparentNode._countedByPrototype=Prototype.emptyFunction;\nif(reverse){\nfor(var nodes=parentNode.childNodes,i=nodes.length-1,j=1;i>=0;i--){\nvar node=nodes[i];\nif(node.nodeType==1&&(!ofType||node._countedByPrototype))node.nodeIndex=j++;\n}\n}else{\nfor(var i=0,j=1,nodes=parentNode.childNodes;node=nodes[i];i++)\nif(node.nodeType==1&&(!ofType||node._countedByPrototype))node.nodeIndex=j++;\n}\n},\nunique:function(nodes){\nif(nodes.length==0)return nodes;\nvar results=[],n;\nfor(var i=0,l=nodes.length;i<l;i++)\nif(!(n=nodes[i])._countedByPrototype){\nn._countedByPrototype=Prototype.emptyFunction;\nresults.push(Element.extend(n));\n}\nreturn Selector.handlers.unmark(results);\n},\ndescendant:function(nodes){\nvar h=Selector.handlers;\nfor(var i=0,results=[],node;node=nodes[i];i++)\nh.concat(results,node.getElementsByTagName('*'));\nreturn results;\n},\nchild:function(nodes){\nvar h=Selector.handlers;\nfor(var i=0,results=[],node;node=nodes[i];i++){\nfor(var j=0,child;child=node.childNodes[j];j++)\nif(child.nodeType==1&&child.tagName!='!')results.push(child);\n}\nreturn results;\n},\nadjacent:function(nodes){\nfor(var i=0,results=[],node;node=nodes[i];i++){\nvar next=this.nextElementSibling(node);\nif(next)results.push(next);\n}\nreturn results;\n},\nlaterSibling:function(nodes){\nvar h=Selector.handlers;\nfor(var i=0,results=[],node;node=nodes[i];i++)\nh.concat(results,Element.nextSiblings(node));\nreturn results;\n},\nnextElementSibling:function(node){\nwhile(node=node.nextSibling)\nif(node.nodeType==1)return node;\nreturn null;\n},\npreviousElementSibling:function(node){\nwhile(node=node.previousSibling)\nif(node.nodeType==1)return node;\nreturn null;\n},\ntagName:function(nodes,root,tagName,combinator){\nvar uTagName=tagName.toUpperCase();\nvar results=[],h=Selector.handlers;\nif(nodes){\nif(combinator){\nif(combinator==\"descendant\"){\nfor(var i=0,node;node=nodes[i];i++)\nh.concat(results,node.getElementsByTagName(tagName));\nreturn results;\n}else nodes=this[combinator](nodes);\nif(tagName==\"*\")return nodes;\n}\nfor(var i=0,node;node=nodes[i];i++)\nif(node.tagName.toUpperCase()===uTagName)results.push(node);\nreturn results;\n}else return root.getElementsByTagName(tagName);\n},\nid:function(nodes,root,id,combinator){\nvar targetNode=$(id),h=Selector.handlers;\nif(!targetNode)return[];\nif(!nodes&&root==document)return[targetNode];\nif(nodes){\nif(combinator){\nif(combinator=='child'){\nfor(var i=0,node;node=nodes[i];i++)\nif(targetNode.parentNode==node)return[targetNode];\n}else if(combinator=='descendant'){\nfor(var i=0,node;node=nodes[i];i++)\nif(Element.descendantOf(targetNode,node))return[targetNode];\n}else if(combinator=='adjacent'){\nfor(var i=0,node;node=nodes[i];i++)\nif(Selector.handlers.previousElementSibling(targetNode)==node)\nreturn[targetNode];\n}else nodes=h[combinator](nodes);\n}\nfor(var i=0,node;node=nodes[i];i++)\nif(node==targetNode)return[targetNode];\nreturn[];\n}\nreturn(targetNode&&Element.descendantOf(targetNode,root))?[targetNode]:[];\n},\nclassName:function(nodes,root,className,combinator){\nif(nodes&&combinator)nodes=this[combinator](nodes);\nreturn Selector.handlers.byClassName(nodes,root,className);\n},\nbyClassName:function(nodes,root,className){\nif(!nodes)nodes=Selector.handlers.descendant([root]);\nvar needle=' '+className+' ';\nfor(var i=0,results=[],node,nodeClassName;node=nodes[i];i++){\nnodeClassName=node.className;\nif(nodeClassName.length==0)continue;\nif(nodeClassName==className||(' '+nodeClassName+' ').include(needle))\nresults.push(node);\n}\nreturn results;\n},\nattrPresence:function(nodes,root,attr,combinator){\nif(!nodes)nodes=root.getElementsByTagName(\"*\");\nif(nodes&&combinator)nodes=this[combinator](nodes);\nvar results=[];\nfor(var i=0,node;node=nodes[i];i++)\nif(Element.hasAttribute(node,attr))results.push(node);\nreturn results;\n},\nattr:function(nodes,root,attr,value,operator,combinator){\nif(!nodes)nodes=root.getElementsByTagName(\"*\");\nif(nodes&&combinator)nodes=this[combinator](nodes);\nvar handler=Selector.operators[operator],results=[];\nfor(var i=0,node;node=nodes[i];i++){\nvar nodeValue=Element.readAttribute(node,attr);\nif(nodeValue===null)continue;\nif(handler(nodeValue,value))results.push(node);\n}\nreturn results;\n},\npseudo:function(nodes,name,value,root,combinator){\nif(nodes&&combinator)nodes=this[combinator](nodes);\nif(!nodes)nodes=root.getElementsByTagName(\"*\");\nreturn Selector.pseudos[name](nodes,value,root);\n}\n},\npseudos:{\n'first-child':function(nodes,value,root){\nfor(var i=0,results=[],node;node=nodes[i];i++){\nif(Selector.handlers.previousElementSibling(node))continue;\nresults.push(node);\n}\nreturn results;\n},\n'last-child':function(nodes,value,root){\nfor(var i=0,results=[],node;node=nodes[i];i++){\nif(Selector.handlers.nextElementSibling(node))continue;\nresults.push(node);\n}\nreturn results;\n},\n'only-child':function(nodes,value,root){\nvar h=Selector.handlers;\nfor(var i=0,results=[],node;node=nodes[i];i++)\nif(!h.previousElementSibling(node)&&!h.nextElementSibling(node))\nresults.push(node);\nreturn results;\n},\n'nth-child':function(nodes,formula,root){\nreturn Selector.pseudos.nth(nodes,formula,root);\n},\n'nth-last-child':function(nodes,formula,root){\nreturn Selector.pseudos.nth(nodes,formula,root,true);\n},\n'nth-of-type':function(nodes,formula,root){\nreturn Selector.pseudos.nth(nodes,formula,root,false,true);\n},\n'nth-last-of-type':function(nodes,formula,root){\nreturn Selector.pseudos.nth(nodes,formula,root,true,true);\n},\n'first-of-type':function(nodes,formula,root){\nreturn Selector.pseudos.nth(nodes,\"1\",root,false,true);\n},\n'last-of-type':function(nodes,formula,root){\nreturn Selector.pseudos.nth(nodes,\"1\",root,true,true);\n},\n'only-of-type':function(nodes,formula,root){\nvar p=Selector.pseudos;\nreturn p['last-of-type'](p['first-of-type'](nodes,formula,root),formula,root);\n},\ngetIndices:function(a,b,total){\nif(a==0)return b>0?[b]:[];\nreturn $R(1,total).inject([],function(memo,i){\nif(0==(i-b)%a&&(i-b)/a>=0)memo.push(i);\nreturn memo;\n});\n},\nnth:function(nodes,formula,root,reverse,ofType){\nif(nodes.length==0)return[];\nif(formula=='even')formula='2n+0';\nif(formula=='odd')formula='2n+1';\nvar h=Selector.handlers,results=[],indexed=[],m;\nh.mark(nodes);\nfor(var i=0,node;node=nodes[i];i++){\nif(!node.parentNode._countedByPrototype){\nh.index(node.parentNode,reverse,ofType);\nindexed.push(node.parentNode);\n}\n}\nif(formula.match(/^\\d+$/)){\nformula=Number(formula);\nfor(var i=0,node;node=nodes[i];i++)\nif(node.nodeIndex==formula)results.push(node);\n}else if(m=formula.match(/^(-?\\d*)?n(([+-])(\\d+))?/)){\nif(m[1]==\"-\")m[1]=-1;\nvar a=m[1]?Number(m[1]):1;\nvar b=m[2]?Number(m[2]):0;\nvar indices=Selector.pseudos.getIndices(a,b,nodes.length);\nfor(var i=0,node,l=indices.length;node=nodes[i];i++){\nfor(var j=0;j<l;j++)\nif(node.nodeIndex==indices[j])results.push(node);\n}\n}\nh.unmark(nodes);\nh.unmark(indexed);\nreturn results;\n},\n'empty':function(nodes,value,root){\nfor(var i=0,results=[],node;node=nodes[i];i++){\nif(node.tagName=='!'||node.firstChild)continue;\nresults.push(node);\n}\nreturn results;\n},\n'not':function(nodes,selector,root){\nvar h=Selector.handlers,selectorType,m;\nvar exclusions=new Selector(selector).findElements(root);\nh.mark(exclusions);\nfor(var i=0,results=[],node;node=nodes[i];i++)\nif(!node._countedByPrototype)results.push(node);\nh.unmark(exclusions);\nreturn results;\n},\n'enabled':function(nodes,value,root){\nfor(var i=0,results=[],node;node=nodes[i];i++)\nif(!node.disabled&&(!node.type||node.type!=='hidden'))\nresults.push(node);\nreturn results;\n},\n'disabled':function(nodes,value,root){\nfor(var i=0,results=[],node;node=nodes[i];i++)\nif(node.disabled)results.push(node);\nreturn results;\n},\n'checked':function(nodes,value,root){\nfor(var i=0,results=[],node;node=nodes[i];i++)\nif(node.checked)results.push(node);\nreturn results;\n}\n},\noperators:{\n'=':function(nv,v){return nv==v;},\n'!=':function(nv,v){return nv!=v;},\n'^=':function(nv,v){return nv==v||nv&&nv.startsWith(v);},\n'$=':function(nv,v){return nv==v||nv&&nv.endsWith(v);},\n'*=':function(nv,v){return nv==v||nv&&nv.include(v);},\n'$=':function(nv,v){return nv.endsWith(v);},\n'*=':function(nv,v){return nv.include(v);},\n'~=':function(nv,v){return(' '+nv+' ').include(' '+v+' ');},\n'|=':function(nv,v){return('-'+(nv||\"\").toUpperCase()+\n'-').include('-'+(v||\"\").toUpperCase()+'-');}\n},\nsplit:function(expression){\nvar expressions=[];\nexpression.scan(/(([\\w#:.~>+()\\s-]+|\\*|\\[.*?\\])+)\\s*(,|$)/,function(m){\nexpressions.push(m[1].strip());\n});\nreturn expressions;\n},\nmatchElements:function(elements,expression){\nvar matches=$$(expression),h=Selector.handlers;\nh.mark(matches);\nfor(var i=0,results=[],element;element=elements[i];i++)\nif(element._countedByPrototype)results.push(element);\nh.unmark(matches);\nreturn results;\n},\nfindElement:function(elements,expression,index){\nif(Object.isNumber(expression)){\nindex=expression;expression=false;\n}\nreturn Selector.matchElements(elements,expression||'*')[index||0];\n},\nfindChildElements:function(element,expressions){\nexpressions=Selector.split(expressions.join(','));\nvar results=[],h=Selector.handlers;\nfor(var i=0,l=expressions.length,selector;i<l;i++){\nselector=new Selector(expressions[i].strip());\nh.concat(results,selector.findElements(element));\n}\nreturn(l>1)?h.unique(results):results;\n}\n});\nif(Prototype.Browser.IE){\nObject.extend(Selector.handlers,{\nconcat:function(a,b){\nfor(var i=0,node;node=b[i];i++)\nif(node.tagName!==\"!\")a.push(node);\nreturn a;\n},\nunmark:function(nodes){\nfor(var i=0,node;node=nodes[i];i++)\nnode.removeAttribute('_countedByPrototype');\nreturn nodes;\n}\n});\n}\nfunction $$(){\nreturn Selector.findChildElements(document,$A(arguments));\n}\nvar Form={\nreset:function(form){\n$(form).reset();\nreturn form;\n},\nserializeElements:function(elements,options){\nif(typeof options!='object')options={hash:!!options};\nelse if(Object.isUndefined(options.hash))options.hash=true;\nvar key,value,submitted=false,submit=options.submit;\nvar data=elements.inject({},function(result,element){\nif(!element.disabled&&element.name){\nkey=element.name;value=$(element).getValue();\nif(value!=null&&element.type!='file'&&(element.type!='submit'||(!submitted&&\nsubmit!==false&&(!submit||key==submit)&&(submitted=true)))){\nif(key in result){\nif(!Object.isArray(result[key]))result[key]=[result[key]];\nresult[key].push(value);\n}\nelse result[key]=value;\n}\n}\nreturn result;\n});\nreturn options.hash?data:Object.toQueryString(data);\n}\n};\nForm.Methods={\nserialize:function(form,options){\nreturn Form.serializeElements(Form.getElements(form),options);\n},\ngetElements:function(form){\nreturn $A($(form).getElementsByTagName('*')).inject([],\nfunction(elements,child){\nif(Form.Element.Serializers[child.tagName.toLowerCase()])\nelements.push(Element.extend(child));\nreturn elements;\n}\n);\n},\ngetInputs:function(form,typeName,name){\nform=$(form);\nvar inputs=form.getElementsByTagName('input');\nif(!typeName&&!name)return $A(inputs).map(Element.extend);\nfor(var i=0,matchingInputs=[],length=inputs.length;i<length;i++){\nvar input=inputs[i];\nif((typeName&&input.type!=typeName)||(name&&input.name!=name))\ncontinue;\nmatchingInputs.push(Element.extend(input));\n}\nreturn matchingInputs;\n},\ndisable:function(form){\nform=$(form);\nForm.getElements(form).invoke('disable');\nreturn form;\n},\nenable:function(form){\nform=$(form);\nForm.getElements(form).invoke('enable');\nreturn form;\n},\nfindFirstElement:function(form){\nvar elements=$(form).getElements().findAll(function(element){\nreturn 'hidden'!=element.type&&!element.disabled;\n});\nvar firstByIndex=elements.findAll(function(element){\nreturn element.hasAttribute('tabIndex')&&element.tabIndex>=0;\n}).sortBy(function(element){return element.tabIndex}).first();\nreturn firstByIndex?firstByIndex:elements.find(function(element){\nreturn['input','select','textarea'].include(element.tagName.toLowerCase());\n});\n},\nfocusFirstElement:function(form){\nform=$(form);\nform.findFirstElement().activate();\nreturn form;\n},\nrequest:function(form,options){\nform=$(form),options=Object.clone(options||{});\nvar params=options.parameters,action=form.readAttribute('action')||'';\nif(action.blank())action=window.location.href;\noptions.parameters=form.serialize(true);\nif(params){\nif(Object.isString(params))params=params.toQueryParams();\nObject.extend(options.parameters,params);\n}\nif(form.hasAttribute('method')&&!options.method)\noptions.method=form.method;\nreturn new Ajax.Request(action,options);\n}\n};\nForm.Element={\nfocus:function(element){\n$(element).focus();\nreturn element;\n},\nselect:function(element){\n$(element).select();\nreturn element;\n}\n};\nForm.Element.Methods={\nserialize:function(element){\nelement=$(element);\nif(!element.disabled&&element.name){\nvar value=element.getValue();\nif(value!=undefined){\nvar pair={};\npair[element.name]=value;\nreturn Object.toQueryString(pair);\n}\n}\nreturn '';\n},\ngetValue:function(element){\nelement=$(element);\nvar method=element.tagName.toLowerCase();\nreturn Form.Element.Serializers[method](element);\n},\nsetValue:function(element,value){\nelement=$(element);\nvar method=element.tagName.toLowerCase();\nForm.Element.Serializers[method](element,value);\nreturn element;\n},\nclear:function(element){\n$(element).value='';\nreturn element;\n},\npresent:function(element){\nreturn $(element).value!='';\n},\nactivate:function(element){\nelement=$(element);\ntry{\nelement.focus();\nif(element.select&&(element.tagName.toLowerCase()!='input'||\n!['button','reset','submit'].include(element.type)))\nelement.select();\n}catch(e){}\nreturn element;\n},\ndisable:function(element){\nelement=$(element);\nelement.disabled=true;\nreturn element;\n},\nenable:function(element){\nelement=$(element);\nelement.disabled=false;\nreturn element;\n}\n};\nvar Field=Form.Element;\nvar $F=Form.Element.Methods.getValue;\nForm.Element.Serializers={\ninput:function(element,value){\nswitch(element.type.toLowerCase()){\ncase 'checkbox':\ncase 'radio':\nreturn Form.Element.Serializers.inputSelector(element,value);\ndefault:\nreturn Form.Element.Serializers.textarea(element,value);\n}\n},\ninputSelector:function(element,value){\nif(Object.isUndefined(value))return element.checked?element.value:null;\nelse element.checked=!!value;\n},\ntextarea:function(element,value){\nif(Object.isUndefined(value))return element.value;\nelse element.value=value;\n},\nselect:function(element,value){\nif(Object.isUndefined(value))\nreturn this[element.type=='select-one'?\n'selectOne':'selectMany'](element);\nelse{\nvar opt,currentValue,single=!Object.isArray(value);\nfor(var i=0,length=element.length;i<length;i++){\nopt=element.options[i];\ncurrentValue=this.optionValue(opt);\nif(single){\nif(currentValue==value){\nopt.selected=true;\nreturn;\n}\n}\nelse opt.selected=value.include(currentValue);\n}\n}\n},\nselectOne:function(element){\nvar index=element.selectedIndex;\nreturn index>=0?this.optionValue(element.options[index]):null;\n},\nselectMany:function(element){\nvar values,length=element.length;\nif(!length)return null;\nfor(var i=0,values=[];i<length;i++){\nvar opt=element.options[i];\nif(opt.selected)values.push(this.optionValue(opt));\n}\nreturn values;\n},\noptionValue:function(opt){\nreturn Element.extend(opt).hasAttribute('value')?opt.value:opt.text;\n}\n};\nAbstract.TimedObserver=Class.create(PeriodicalExecuter,{\ninitialize:function($super,element,frequency,callback){\n$super(callback,frequency);\nthis.element=$(element);\nthis.lastValue=this.getValue();\n},\nexecute:function(){\nvar value=this.getValue();\nif(Object.isString(this.lastValue)&&Object.isString(value)?\nthis.lastValue!=value:String(this.lastValue)!=String(value)){\nthis.callback(this.element,value);\nthis.lastValue=value;\n}\n}\n});\nForm.Element.Observer=Class.create(Abstract.TimedObserver,{\ngetValue:function(){\nreturn Form.Element.getValue(this.element);\n}\n});\nForm.Observer=Class.create(Abstract.TimedObserver,{\ngetValue:function(){\nreturn Form.serialize(this.element);\n}\n});\nAbstract.EventObserver=Class.create({\ninitialize:function(element,callback){\nthis.element=$(element);\nthis.callback=callback;\nthis.lastValue=this.getValue();\nif(this.element.tagName.toLowerCase()=='form')\nthis.registerFormCallbacks();\nelse\nthis.registerCallback(this.element);\n},\nonElementEvent:function(){\nvar value=this.getValue();\nif(this.lastValue!=value){\nthis.callback(this.element,value);\nthis.lastValue=value;\n}\n},\nregisterFormCallbacks:function(){\nForm.getElements(this.element).each(this.registerCallback,this);\n},\nregisterCallback:function(element){\nif(element.type){\nswitch(element.type.toLowerCase()){\ncase 'checkbox':\ncase 'radio':\nEvent.observe(element,'click',this.onElementEvent.bind(this));\nbreak;\ndefault:\nEvent.observe(element,'change',this.onElementEvent.bind(this));\nbreak;\n}\n}\n}\n});\nForm.Element.EventObserver=Class.create(Abstract.EventObserver,{\ngetValue:function(){\nreturn Form.Element.getValue(this.element);\n}\n});\nForm.EventObserver=Class.create(Abstract.EventObserver,{\ngetValue:function(){\nreturn Form.serialize(this.element);\n}\n});\nif(!window.Event)var Event={};\nObject.extend(Event,{\nKEY_BACKSPACE:8,\nKEY_TAB:9,\nKEY_RETURN:13,\nKEY_ESC:27,\nKEY_LEFT:37,\nKEY_UP:38,\nKEY_RIGHT:39,\nKEY_DOWN:40,\nKEY_DELETE:46,\nKEY_HOME:36,\nKEY_END:35,\nKEY_PAGEUP:33,\nKEY_PAGEDOWN:34,\nKEY_INSERT:45,\ncache:{},\nrelatedTarget:function(event){\nvar element;\nswitch(event.type){\ncase 'mouseover':element=event.fromElement;break;\ncase 'mouseout':element=event.toElement;break;\ndefault:return null;\n}\nreturn Element.extend(element);\n}\n});\nEvent.Methods=(function(){\nvar isButton;\nif(Prototype.Browser.IE){\nvar buttonMap={0:1,1:4,2:2};\nisButton=function(event,code){\nreturn event.button==buttonMap[code];\n};\n}else if(Prototype.Browser.WebKit){\nisButton=function(event,code){\nswitch(code){\ncase 0:return event.which==1&&!event.metaKey;\ncase 1:return event.which==1&&event.metaKey;\ndefault:return false;\n}\n};\n}else{\nisButton=function(event,code){\nreturn event.which?(event.which===code+1):(event.button===code);\n};\n}\nreturn{\nisLeftClick:function(event){return isButton(event,0)},\nisMiddleClick:function(event){return isButton(event,1)},\nisRightClick:function(event){return isButton(event,2)},\nelement:function(event){\nevent=Event.extend(event);\nvar node=event.target,\ntype=event.type,\ncurrentTarget=event.currentTarget;\nif(currentTarget&&currentTarget.tagName){\nif(type==='load'||type==='error'||\n(type==='click'&&currentTarget.tagName.toLowerCase()==='input'\n&&currentTarget.type==='radio'))\nnode=currentTarget;\n}\nif(node.nodeType==Node.TEXT_NODE)node=node.parentNode;\nreturn Element.extend(node);\n},\nfindElement:function(event,expression){\nvar element=Event.element(event);\nif(!expression)return element;\nvar elements=[element].concat(element.ancestors());\nreturn Selector.findElement(elements,expression,0);\n},\npointer:function(event){\nvar docElement=document.documentElement,\nbody=document.body||{scrollLeft:0,scrollTop:0};\nreturn{\nx:event.pageX||(event.clientX+\n(docElement.scrollLeft||body.scrollLeft)-\n(docElement.clientLeft||0)),\ny:event.pageY||(event.clientY+\n(docElement.scrollTop||body.scrollTop)-\n(docElement.clientTop||0))\n};\n},\npointerX:function(event){return Event.pointer(event).x},\npointerY:function(event){return Event.pointer(event).y},\nstop:function(event){\nEvent.extend(event);\nevent.preventDefault();\nevent.stopPropagation();\nevent.stopped=true;\n}\n};\n})();\nEvent.extend=(function(){\nvar methods=Object.keys(Event.Methods).inject({},function(m,name){\nm[name]=Event.Methods[name].methodize();\nreturn m;\n});\nif(Prototype.Browser.IE){\nObject.extend(methods,{\nstopPropagation:function(){this.cancelBubble=true},\npreventDefault:function(){this.returnValue=false},\ninspect:function(){return \"[object Event]\"}\n});\nreturn function(event){\nif(!event)return false;\nif(event._extendedByPrototype)return event;\nevent._extendedByPrototype=Prototype.emptyFunction;\nvar pointer=Event.pointer(event);\nObject.extend(event,{\ntarget:event.srcElement,\nrelatedTarget:Event.relatedTarget(event),\npageX:pointer.x,\npageY:pointer.y\n});\nreturn Object.extend(event,methods);\n};\n}else{\nEvent.prototype=Event.prototype||document.createEvent(\"HTMLEvents\")['__proto__'];\nObject.extend(Event.prototype,methods);\nreturn Prototype.K;\n}\n})();\nObject.extend(Event,(function(){\nvar cache=Event.cache;\nfunction getEventID(element){\nif(element._prototypeEventID)return element._prototypeEventID[0];\narguments.callee.id=arguments.callee.id||1;\nreturn element._prototypeEventID=[++arguments.callee.id];\n}\nfunction getDOMEventName(eventName){\nif(eventName&&eventName.include(':'))return \"dataavailable\";\nreturn eventName;\n}\nfunction getCacheForID(id){\nreturn cache[id]=cache[id]||{};\n}\nfunction getWrappersForEventName(id,eventName){\nvar c=getCacheForID(id);\nreturn c[eventName]=c[eventName]||[];\n}\nfunction createWrapper(element,eventName,handler){\nvar id=getEventID(element);\nvar c=getWrappersForEventName(id,eventName);\nif(c.pluck(\"handler\").include(handler))return false;\nvar wrapper=function(event){\nif(!Event||!Event.extend||\n(event.eventName&&event.eventName!=eventName))\nreturn false;\nEvent.extend(event);\nhandler.call(element,event);\n};\nwrapper.handler=handler;\nc.push(wrapper);\nreturn wrapper;\n}\nfunction findWrapper(id,eventName,handler){\nvar c=getWrappersForEventName(id,eventName);\nreturn c.find(function(wrapper){return wrapper.handler==handler});\n}\nfunction destroyWrapper(id,eventName,handler){\nvar c=getCacheForID(id);\nif(!c[eventName])return false;\nc[eventName]=c[eventName].without(findWrapper(id,eventName,handler));\n}\nfunction destroyCache(){\nfor(var id in cache)\nfor(var eventName in cache[id])\ncache[id][eventName]=null;\n}\nif(window.attachEvent){\nwindow.attachEvent(\"onunload\",destroyCache);\n}\nif(Prototype.Browser.WebKit){\nwindow.addEventListener('unload',Prototype.emptyFunction,false);\n}\nreturn{\nobserve:function(element,eventName,handler){\nelement=$(element);\nvar name=getDOMEventName(eventName);\nvar wrapper=createWrapper(element,eventName,handler);\nif(!wrapper)return element;\nif(element.addEventListener){\nelement.addEventListener(name,wrapper,false);\n}else{\nelement.attachEvent(\"on\"+name,wrapper);\n}\nreturn element;\n},\nstopObserving:function(element,eventName,handler){\nelement=$(element);\nvar id=getEventID(element),name=getDOMEventName(eventName);\nif(!handler&&eventName){\ngetWrappersForEventName(id,eventName).each(function(wrapper){\nelement.stopObserving(eventName,wrapper.handler);\n});\nreturn element;\n}else if(!eventName){\nObject.keys(getCacheForID(id)).each(function(eventName){\nelement.stopObserving(eventName);\n});\nreturn element;\n}\nvar wrapper=findWrapper(id,eventName,handler);\nif(!wrapper)return element;\nif(element.removeEventListener){\nelement.removeEventListener(name,wrapper,false);\n}else{\nelement.detachEvent(\"on\"+name,wrapper);\n}\ndestroyWrapper(id,eventName,handler);\nreturn element;\n},\nfire:function(element,eventName,memo){\nelement=$(element);\nif(element==document&&document.createEvent&&!element.dispatchEvent)\nelement=document.documentElement;\nvar event;\nif(document.createEvent){\nevent=document.createEvent(\"HTMLEvents\");\nevent.initEvent(\"dataavailable\",true,true);\n}else{\nevent=document.createEventObject();\nevent.eventType=\"ondataavailable\";\n}\nevent.eventName=eventName;\nevent.memo=memo||{};\nif(document.createEvent){\nelement.dispatchEvent(event);\n}else{\nelement.fireEvent(event.eventType,event);\n}\nreturn Event.extend(event);\n}\n};\n})());\nObject.extend(Event,Event.Methods);\nElement.addMethods({\nfire:Event.fire,\nobserve:Event.observe,\nstopObserving:Event.stopObserving\n});\nObject.extend(document,{\nfire:Element.Methods.fire.methodize(),\nobserve:Element.Methods.observe.methodize(),\nstopObserving:Element.Methods.stopObserving.methodize(),\nloaded:false\n});\n(function(){\nvar timer;\nfunction fireContentLoadedEvent(){\nif(document.loaded)return;\nif(timer)window.clearInterval(timer);\ndocument.fire(\"dom:loaded\");\ndocument.loaded=true;\n}\nif(document.addEventListener){\nif(Prototype.Browser.WebKit){\ntimer=window.setInterval(function(){\nif(/loaded|complete/.test(document.readyState))\nfireContentLoadedEvent();\n},0);\nEvent.observe(window,\"load\",fireContentLoadedEvent);\n}else{\ndocument.addEventListener(\"DOMContentLoaded\",\nfireContentLoadedEvent,false);\n}\n}else{\ndocument.write(\"<script id=__onDOMContentLoaded defer src=//:><\\/script>\");\n$(\"__onDOMContentLoaded\").onreadystatechange=function(){\nif(this.readyState==\"complete\"){\nthis.onreadystatechange=null;\nfireContentLoadedEvent();\n}\n};\n}\n})();\nHash.toQueryString=Object.toQueryString;\nvar Toggle={display:Element.toggle};\nElement.Methods.childOf=Element.Methods.descendantOf;\nvar Insertion={\nBefore:function(element,content){\nreturn Element.insert(element,{before:content});\n},\nTop:function(element,content){\nreturn Element.insert(element,{top:content});\n},\nBottom:function(element,content){\nreturn Element.insert(element,{bottom:content});\n},\nAfter:function(element,content){\nreturn Element.insert(element,{after:content});\n}\n};\nvar $continue=new Error('\"throw $continue\" is deprecated, use \"return\" instead');\nvar Position={\nincludeScrollOffsets:false,\nprepare:function(){\nthis.deltaX=window.pageXOffset\n||document.documentElement.scrollLeft\n||document.body.scrollLeft\n||0;\nthis.deltaY=window.pageYOffset\n||document.documentElement.scrollTop\n||document.body.scrollTop\n||0;\n},\nwithin:function(element,x,y){\nif(this.includeScrollOffsets)\nreturn this.withinIncludingScrolloffsets(element,x,y);\nthis.xcomp=x;\nthis.ycomp=y;\nthis.offset=Element.cumulativeOffset(element);\nreturn(y>=this.offset[1]&&\ny<this.offset[1]+element.offsetHeight&&\nx>=this.offset[0]&&\nx<this.offset[0]+element.offsetWidth);\n},\nwithinIncludingScrolloffsets:function(element,x,y){\nvar offsetcache=Element.cumulativeScrollOffset(element);\nthis.xcomp=x+offsetcache[0]-this.deltaX;\nthis.ycomp=y+offsetcache[1]-this.deltaY;\nthis.offset=Element.cumulativeOffset(element);\nreturn(this.ycomp>=this.offset[1]&&\nthis.ycomp<this.offset[1]+element.offsetHeight&&\nthis.xcomp>=this.offset[0]&&\nthis.xcomp<this.offset[0]+element.offsetWidth);\n},\noverlap:function(mode,element){\nif(!mode)return 0;\nif(mode=='vertical')\nreturn((this.offset[1]+element.offsetHeight)-this.ycomp)/\nelement.offsetHeight;\nif(mode=='horizontal')\nreturn((this.offset[0]+element.offsetWidth)-this.xcomp)/\nelement.offsetWidth;\n},\ncumulativeOffset:Element.Methods.cumulativeOffset,\npositionedOffset:Element.Methods.positionedOffset,\nabsolutize:function(element){\nPosition.prepare();\nreturn Element.absolutize(element);\n},\nrelativize:function(element){\nPosition.prepare();\nreturn Element.relativize(element);\n},\nrealOffset:Element.Methods.cumulativeScrollOffset,\noffsetParent:Element.Methods.getOffsetParent,\npage:Element.Methods.viewportOffset,\nclone:function(source,target,options){\noptions=options||{};\nreturn Element.clonePosition(target,source,options);\n}\n};\nif(!document.getElementsByClassName)document.getElementsByClassName=function(instanceMethods){\nfunction iter(name){\nreturn name.blank()?null:\"[contains(concat(' ', @class, ' '), ' \"+name+\" ')]\";\n}\ninstanceMethods.getElementsByClassName=Prototype.BrowserFeatures.XPath?\nfunction(element,className){\nclassName=className.toString().strip();\nvar cond=/\\s/.test(className)?$w(className).map(iter).join(''):iter(className);\nreturn cond?document._getElementsByXPath('.//*'+cond,element):[];\n}:function(element,className){\nclassName=className.toString().strip();\nvar elements=[],classNames=(/\\s/.test(className)?$w(className):null);\nif(!classNames&&!className)return elements;\nvar nodes=$(element).getElementsByTagName('*');\nclassName=' '+className+' ';\nfor(var i=0,child,cn;child=nodes[i];i++){\nif(child.className&&(cn=' '+child.className+' ')&&(cn.include(className)||\n(classNames&&classNames.all(function(name){\nreturn !name.toString().blank()&&cn.include(' '+name+' ');\n}))))\nelements.push(Element.extend(child));\n}\nreturn elements;\n};\nreturn function(className,parentElement){\nreturn $(parentElement||document.body).getElementsByClassName(className);\n};\n}(Element.Methods);\nElement.ClassNames=Class.create();\nElement.ClassNames.prototype={\ninitialize:function(element){\nthis.element=$(element);\n},\n_each:function(iterator){\nthis.element.className.split(/\\s+/).select(function(name){\nreturn name.length>0;\n})._each(iterator);\n},\nset:function(className){\nthis.element.className=className;\n},\nadd:function(classNameToAdd){\nif(this.include(classNameToAdd))return;\nthis.set($A(this).concat(classNameToAdd).join(' '));\n},\nremove:function(classNameToRemove){\nif(!this.include(classNameToRemove))return;\nthis.set($A(this).without(classNameToRemove).join(' '));\n},\ntoString:function(){\nreturn $A(this).join(' ');\n}\n};\nObject.extend(Element.ClassNames.prototype,Enumerable);\nElement.addMethods();\nRegExp.escape=function(text){\nif(!arguments.callee.sRE){\nvar specials=[\n'/','.','*','+','?','|','^','$',\n'(',')','[',']','{','}','\\\\'\n];\narguments.callee.sRE=new RegExp(\n'(\\\\'+specials.join('|\\\\')+')','g'\n);\n}\nreturn text.replace(arguments.callee.sRE,'\\\\$1');\n}\nCollection=Class.create();\nCollection.prototype={\ninitialize:function(intitalEnumerable){\nthis._contents=intitalEnumerable?$A(intitalEnumerable).toArray():[];\nthis._syncLength();\nObject.extend(this,Enumerable);\nthis.uniqueItemIndexer=0;\n},\n0:function(){\nthrow(\"use itemAt(index).  Remember, this isn't really an 'Array'\");\n},\n1:function(){\nthrow(\"use itemAt(index).  Remember, this isn't really an 'Array'\");\n},\n2:function(){\nthrow(\"use itemAt(index).  Remember, this isn't really an 'Array'\");\n},\n_each:function(iterator){\nvar len=this.length;\nfor(var i=0;i<len;i++)\niterator(this._contents[i]);\n},\npush:function(item){\nitem.uniqueItemIndexer=this.uniqueItemIndexed++;\nthis._contents.push(item);\nthis._syncLength();\nif(this.onPush){\nthis.onPush();\n}\n},\npushAt:function(item,index){\nitem.uniqueItemIndexer=this.uniqueItemIndexed++;\nthis._contents.splice(index,0,item);\nthis._syncLength();\nif(this.onPush){\nthis.onPush();\n}\n},\npop:function(){\nthis._contents.pop();\nthis._syncLength();\n},\nitemAt:function(index){\nreturn this._contents[index];\n},\nremove:function(objectToRemove){\nthis.removeElement(objectToRemove)\n},\nremoveElement:function(objectToRemove){\nthis._contents.splice(this.indexOf(objectToRemove),1);\nthis._syncLength();\n},\n_syncLength:function(){\nthis.length=this._contents.length;\n},\nfirst:function(){\nreturn this.itemAt(0);\n},\nlast:function(){\nreturn this.itemAt(this.length-1);\n},\nindexOf:function(object){\nvar indexFound=-1;\nvar result=\nthis.find(function(item,index){\nindexFound=index;\nreturn item==object;\n})\nif(result==null||indexFound==-1){\nreturn false;\n}\nreturn indexFound;\n},\nfindIndicesOfSubset:function(subset){\nvar me=this;\nvar indexes=\nsubset.collect(function(subsetItem){\nreturn me.indexOf(subsetItem);\n});\nreturn indexes;\n},\ninspect:function(){\nreturn '['+this.map(Object.inspect).join(', ')+']';\n},\ntoString:function(){\nreturn this.inspect();\n},\nisEmpty:function(){\nreturn this.length==0;\n}\n};\nvar U=\n{\nblank:function(object){\nreturn object==undefined||object==null||(typeof object==\"string\"&&object.length==0)\n},\ngetFormElementByName:function(form,name){\nvar result=\n$A(form.elements).find(function(formElement){\nreturn formElement.name==name;\n});\nreturn result;\n},\nnullIfBlank:function(value){\nreturn !value||value.length==0?null:value;\n},\nhandleTransparentPngs:function(container){\nif(!document.all)return;\nif(navigator.appVersion.indexOf(\"MSIE 7.0\")>-1||navigator.appVersion.indexOf(\"MSIE 8.0\")>-1)return;\nvar imgs=U.elt(\"img\",container);\nfor(var i=0;i<imgs.length;++i){\nvar img=imgs[i];\nif(img.src.indexOf(\".png\")>-1){\nU.tempTransparentImg(img);\n}\n}\n},\ntempTransparentImg:function(img){\nvar tempImg=document.createElement(\"IMG\");\ntempImg.onload=function(){\nU.makeImgTransparent(img,tempImg.height,tempImg.width);\n}\ntempImg.src=img.src;\n},\nmakeImgTransparent:function(img,height,width){\nimg.style.height=height;\nimg.style.width=width;\nimg.style.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src='+img.src+',sizingMethod=scale,enabled=1)';\nimg.src=\"/images/blank.gif\";\n},\nfindEquivalentPolylineInstance:function(polylineToFind,polylines){\nvar result=\npolylines.find(function(polyline){\nif(!polylineToFind.getPath){\nalert(\"Google broke getPath again\");\n}\nmyPath=polylineToFind.getPath()\notherPath=polyline.getPath()\nvar match=myPath.length==otherPath.length;\nif(match){\nfor(var i=0;i<polyline.getPath().length;i++){\nvar myVertex=myPath.getAt(i);\nvar otherVertex=otherPath.getAt(i);\nmatch=myVertex.lat()==otherVertex.lat()&&myVertex.lng()==otherVertex.lng();\nif(!match){\nbreak;\n}\n}\n}\nreturn match;\n});\nreturn result?result:null;\n},\nremoveEquivalentPolylineFromArray:function(polylineToFind,polylines){\nvar toRemove=U.findEquivalentPolylineInstance(polylineToFind,polylines);\npolylines.remove(toRemove);\nreturn toRemove;\n},\nclearOptions:function(selectElement){\nfor(var i=selectElement.options.length-1;i>=0;i--){\nselectElement.remove(i);\n}\n},\nconditionalElementSwitch:function(container,condition,showIfTrue,showIfFalse){\nif(condition){\nU.findIdInElement(container,showIfTrue).style.display=\"\";\nU.findIdInElement(container,showIfFalse).style.display=\"none\";\n}else{\nU.findIdInElement(container,showIfTrue).style.display=\"none\";\nU.findIdInElement(container,showIfFalse).style.display=\"\";\n}\n},\ntoggleDisplay:function(element,duration){\nif(element.style.display==\"none\"){\nif(duration)Effect.BlindDown(element,{duration:duration});\nelse Element.show(element);\n}else{\nif(duration)Effect.BlindUp(element,{duration:duration});\nelse Element.hide(element);\n}\n},\nshowAndHide:function(container,idToShow,idToHide){\nU.findIdInElement(container,idToShow).style.display=\"\";\nU.findIdInElement(container,idToHide).style.display=\"none\";\n},\nfindIdInElement:function(container,id){\nvar elements=U.elt(\"*\",container);\nvar elementsLength=elements.length;\nfor(var i=0;i<elementsLength;++i){\nif(elements[i].id==id)return elements[i];\n}\n},\nfindClassNamesInElement:function(container,className){\nvar elements=U.elt(\"*\",container);\nvar returnElements=[];\nvar elementsLength=elements.length;\nfor(var i=0;i<elementsLength;++i){\ntry{\nvar classNames=elements[i].className.split(\" \");\nfor(var j=0;j<classNames.length;++j){\nif(classNames[j]==className){\nreturnElements.push(elements[i]);\n}\n}\n}catch(e){}\n}\nreturn returnElements;\n},\nreplaceClassName:function(object,replaceClassName,withClassName){\nreplaceRegExp=new RegExp(replaceClassName,\"ig\");\nobject.className=object.className.replace(replaceRegExp,withClassName);\n},\nelt:function(name,container){\nif(!container){\ncontainer=document;\n}\nreturn container.getElementsByTagName(name);\n},\neln:function(name){\nreturn document.getElementsByName(name)[0];\n},\ninner:function(id,html){\n$(id).innerHTML=html;\n},\nmetersInMiles:function(meters){\nreturn Math.ceil((meters/ 1609.344)* this._getMeterDivisor(meters))/ this._getMeterDivisor(meters);\n},\nmetersInKilometers:function(meters){\nreturn Math.ceil(meters/(1000/ this._getMeterDivisor(meters)))/this._getMeterDivisor(meters);\n},\n_getMeterDivisor:function(meters){\nvar divisor=1;\nif(meters<10000000)divisor=10;\nif(meters<100000)divisor=100;\nif(meters<1000)divisor=1000;\nreturn divisor;\n},\ncomparePoints:function(point1,point2,span,threshold)\n{\nif(!point1||!point2||point1==null||point2==null)\n{\nreturn true;\n}\nvar w=span.width;\nvar h=span.height;\nvar xd=Math.abs(point1.x-point2.x);\nvar yd=Math.abs(point1.y-point2.y);\nif((xd<(w*threshold))||(yd<(h*threshold)))\n{\nreturn false;\n}\nreturn true;\n},\nhighlight:function(id)\n{\nnew Effect.Highlight($(id),{startcolor:\"#FFFFFF\",endcolor:\"#0000C5\",restorecolor:\"#0000C5\",duration:0.4});\nsetTimeout(function(){\nnew Effect.Highlight($(id),{startcolor:\"#0000C5\",endcolor:\"#FFFFFF\",restorecolor:\"#FFFFFF\",duration:0.4});\n}.bind(this),500);\n},\naddMessage:function(message)\n{\nvar messages=$(\"walk_messages\");\nif(messages==null)\n{\nreturn;\n}\nif(messages.innerHTML.length>0)\n{\nmessage=\"<hr />\"+message+\"<br/><br/><br/><br/>\";\n}\nmessages.innerHTML+=message;\nmessages.scrollTop=9999;\nU.highlight(messages.id);\n},\nheightWithBorders:function(elem){\nreturn Element.getDimensions(elem).height;\n},\nwidthWithBorders:function(elem){\nreturn Element.getDimensions(elem).width;\n},\nheight:function(elem){\nvar height=U.heightWithBorders(elem);\nheight-=U.computedStyleAsNum(elem,\"paddingTop\",\"padding-top\");\nheight-=U.computedStyleAsNum(elem,\"paddingBottom\",\"padding-bottom\");\nif(isNaN(U.computedStyleAsNum(elem,\"borderTopWidth\",\"border-top-width\")))return height;\nheight-=U.computedStyleAsNum(elem,\"borderTopWidth\",\"border-top-width\");\nheight-=U.computedStyleAsNum(elem,\"borderBottomWidth\",\"border-bottom-width\");\nreturn height;\n},\nwidth:function(elem){\nvar width=U.widthWithBorders(elem);\nwidth-=U.computedStyleAsNum(elem,\"paddingLeft\",\"padding-left\");\nwidth-=U.computedStyleAsNum(elem,\"paddingRight\",\"padding-right\");\nif(isNaN(U.computedStyleAsNum(elem,\"borderLeftWidth\",\"border-left-width\")))return width;\nwidth-=U.computedStyleAsNum(elem,\"borderLeftWidth\",\"border-left-width\");\nwidth-=U.computedStyleAsNum(elem,\"borderRightWidth\",\"border-right-width\");\nreturn width;\n},\ncomputedStyleAsNum:function(elem,ieProp,mozillaProp){\nvar computedStyle=U.getElementsComputedStyle(elem,ieProp,mozillaProp);\ncomputedStyle=computedStyle.substr(0,computedStyle.length-2);\nif(isNaN(computedStyle)){\nreturn 0;\n}\nreturn parseInt(computedStyle);\n},\ngetElementsComputedStyle:function(htmlElement,cssProperty,mozillaEquivalentCSS){\nif(arguments.length==2)\nmozillaEquivalentCSS=cssProperty;\nvar el=$(htmlElement);\nif(el.currentStyle)\nreturn el.currentStyle[cssProperty];\nelse\nreturn document.defaultView.getComputedStyle(el,null).getPropertyValue(mozillaEquivalentCSS);\n},\nensureVisible:function(container,element,padding){\nif(!padding)padding=0;\nvar containerHeight=U.heightWithBorders(container);\nvar containerWidth=U.widthWithBorders(container);\nvar containerOffset=Position.cumulativeOffset(container);\nvar elementHeight=U.heightWithBorders(element)+padding;\nvar elementWidth=U.widthWithBorders(element)+padding;\nvar elementOffset=Position.cumulativeOffset(element);\nelementOffset[0]-=padding;\nelementOffset[1]-=padding;\nvar verticalOffsetFromContainer=elementOffset[1]-containerOffset[1];\nvar containerVerticalScroll=container.scrollTop;\nif(containerVerticalScroll>verticalOffsetFromContainer){\ncontainer.scrollTop=verticalOffsetFromContainer;\n}\nelse if(containerVerticalScroll<verticalOffsetFromContainer-containerHeight+elementHeight){\ncontainer.scrollTop=verticalOffsetFromContainer-containerHeight+elementHeight;\n}\nvar horizontalOffsetFromContainer=elementOffset[0]-containerOffset[0];\nvar containerHorizontalScroll=container.scrollLeft;\nif(containerHorizontalScroll>horizontalOffsetFromContainer){\ncontainer.scrollLeft=horizontalOffsetFromContainer;\n}\nelse if(containerHorizontalScroll<horizontalOffsetFromContainer-containerWidth+elementWidth){\ncontainer.scrollLeft=horizontalOffsetFromContainer-containerWidth+elementWidth;\n}\n},\ndisplayEdit:function(type,container)\n{\nU.display(type,container,true);\n},\ndisplayRead:function(type,container)\n{\nU.display(type,container,false);\n},\ndisplay:function(type,container,edit)\n{\nvar display=\"read\";\nvar hide=\"edit\";\nif(edit)\n{\ndisplay=\"edit\";\nhide=\"read\";\n}\nvar children=container.childNodes;\nvar childrenLength=children.length;\nfor(var i=0;i<childrenLength;i++)\n{\nif(children[i].className)\n{\nif(children[i].className.indexOf(type+\"_\"+display)>-1)\n{\nchildren[i].className=children[i].className.replace(\"nodisplay\",\"\");\nchildren[i].style.display=\"\";\n}\nelse if(children[i].className.indexOf(type+\"_\"+hide)>-1)\n{\nchildren[i].style.display=\"none\";\n}\n}\nU.display(type,children[i],edit);\n}\n},\ngetWindowDimension:function(getHeight)\n{\nvar height=0;\nvar width=0;\nif(typeof(window.innerWidth)=='number')\n{\nheight=window.innerHeight;\nwidth=window.innerWidth;\n}\nelse if(document.documentElement&&\n(document.documentElement.clientWidth||document.documentElement.clientHeight))\n{\nheight=document.documentElement.clientHeight;\nwidth=document.documentElement.clientWidth;\n}\nelse if(document.body&&(document.body.clientWidth||document.body.clientHeight))\n{\nheight=document.body.clientHeight;\nwidth=document.body.clientWidth;\n}\nreturn getHeight?height:width;\n},\ngetWindowHeight:function()\n{\nreturn U.getWindowDimension(true);\n},\ngetWindowHeightSubjectToMin:function(minHeight)\n{\nvar height=U.getWindowHeight();\nreturn(height<minHeight)?minHeight:height;\n},\ngetWindowWidth:function()\n{\nreturn U.getWindowDimension(false);\n},\nopenWindow:function(url,height,width,options){\noptions=options||\"resizable=yes,toolbar=no,location=no,status=no\";\nvar uniquename=\"\";\nw=open(url,uniquename,'scrollbars=yes,menubar=no,height='+height+',width='+width+','+options);\nif(!w)\n{\nalert(\"CommunityWalk was unable to open the window. You may have a pop-up blocker that is preventing this window from opening.\");\nreturn null;\n}\nreturn w;\n},\nbuildIcon:function(src,identifier){\ninfo={icon:{}}\ninfo.icon.url=src+\"/\"+identifier+\".png\";\nvar shadow=U.getShadowSrc(src,identifier)\nif(shadow&&shadow.length){\ninfo.shadow={url:shadow}\n}\nif(identifier==\"i\"){\nvar customSrc=src.replace(/\\//ig, '_').replace(/[:.-]/ig,'_');\nvar iconInfo=CwCustomIcons[customSrc];\ninfo.icon.size=new google.maps.Size(iconInfo.markerWidth,iconInfo.markerHeight);\ninfo.shadow.size=new google.maps.Size(iconInfo.containerWidth,iconInfo.containerHeight);\ninfo.icon.anchor=new google.maps.Point(iconInfo.markerOffsetX,iconInfo.markerOffsetY);\ninfo.shadow.anchor=new google.maps.Point(iconInfo.markerOffsetX,iconInfo.markerOffsetY);\ninfo.anchorPoint=new google.maps.Point(0,-1*(iconInfo.markerHeight-2));\n}else if(identifier==\"dot\"){\ninfo.icon.size=new google.maps.Size(11,11);\ninfo.icon.anchor=new google.maps.Point(5,6);\ninfo.anchorPoint=new google.maps.Point(0,-9);\n}else if(identifier==\"sm\"){\ninfo.icon.size=new google.maps.Size(20,29);\ninfo.shadow.size=new google.maps.Size(43,30);\ninfo.icon.anchor=new google.maps.Point(8,26);\ninfo.shadow.anchor=new google.maps.Point(7,25);\ninfo.anchorPoint=new google.maps.Point(0,-27);\n}else if(identifier<=35||isNaN(identifier)){\ninfo.icon.size=new google.maps.Size(22,36);\ninfo.shadow.size=new google.maps.Size(44,35);\ninfo.icon.anchor=new google.maps.Point(11,34);\ninfo.shadow.anchor=new google.maps.Point(10,33);\ninfo.anchorPoint=new google.maps.Point(0,-33);\n}else{\ninfo.icon.size=new google.maps.Size(36,40);\ninfo.shadow.size=new google.maps.Size(72,40);\ninfo.icon.anchor=new google.maps.Point(17,36);\ninfo.shadow.anchor=new google.maps.Point(16,35);\ninfo.anchorPoint=new google.maps.Point(0,-38);\n}\nreturn info;\n},\ngetShadowSrc:function(src,identifier){\nif(identifier==\"i\"){\nreturn src+\"/shadow.png\";\n}else if(identifier==\"dot\"){\nreturn \"\";\n}else if(identifier==\"sm\"){\nreturn \"/images/s_shadow.png\";\n}else if(identifier<=35||isNaN(identifier)){\nreturn \"http://www.google.com/mapfiles/shadow50.png\";\n}else{\nreturn \"http://www.google.com/maplinedraw?width=72&height=40&path=u@c@BAB?BATO?A?AA?K?AABGSFA@K?E?C@C@UN?@B@T?T?FAw@?z@A{@?~@A{@?|@A{@?|@A{@?~@A{@?|@A{@?|@A{@?~@A{@?|@A{@?z@Aw@?h@AS?RAO?NAI?HAE?FAC?}oR&color=0,0,0,191.25&weight=2\";\n}\n},\nchangeButtonText:function(newText,id)\n{\n$(id).value=newText;\n},\nsetFrameSrc:function(frameName,href)\n{\nvar iframe=$(frameName);\nif(iframe==null){\nreturn;\n}\nif(document.all)\n{\nU.setFrameSrcCloneFrame(iframe,href);\n}\nelse\n{\nU.setFrameSrcReplaceLocation(iframe,href);\n}\n},\nsetFrameSrcCloneFrame:function(iframe,href){\nsetTimeout(function(){\ntry{\nvar newIframe=iframe.cloneNode(true);\nnewIframe.src=href;\nvar iframeParent=iframe.parentNode;\niframeParent.insertBefore(newIframe,iframe);\niframeParent.removeChild(iframe);\n}\ncatch(e){}\n},0);\n},\nsetFrameSrcReplaceLocation:function(iframe,href)\n{\nsetTimeout(function(){\nvar doc;\nif(iframe.contentDocument){\ndoc=iframe.contentDocument;\n}else if(iframe.contentWindow){\ndoc=iframe.contentWindow.document;\n}else if(iframe.document){\ndoc=iframe.document;\n}\nif(href.indexOf(\"/\")!=0)\n{\nhref=\"/iframe/external?url=\"+href;\n}\nif(doc){\ndoc.location.replace(href);\n}\n},0);\n},\nstoreButtonText:function(id)\n{\nvar button=$(id);\nif(undefined==button.storedValue){\nbutton.storedValue=button.value;\n}\n},\nrestoreButtonText:function(id){\nvar button=$(id);\nif(undefined !=button.storedValue){\nbutton.value=button.storedValue;\n}\n},\ngetUrlHash:function(){\nvar hash=location.hash;\nif(hash.length==0){\nreturn \"\";\n}\nif(hash.charAt(0)==\"#\"){\nhash=hash.substr(1);\n}\nreturn hash;\n},\nserializeForUrlHash:function(obj){\nvar hash=\"#\";\nvar parameters=[];\nfor(var key in obj){\nif(obj[key]==null)continue;\nparameters.push(key+\"=\"+JSON.stringify(obj[key]));\n}\nhash+=parameters.join(\"&\");\nreturn hash;\n},\ngetParamHash:function(){\nif(location.href.indexOf(\"?\")==-1)return{};\nvar paramArray=location.href.substr(location.href.indexOf(\"?\")+1).split(\"&\");\nvar paramHash={};\nfor(var i=0;i<paramArray.length;++i){\nvar keyValue=paramArray[i].split(\"=\");\nparamHash[keyValue[0]]=keyValue[1].replace(/%20/ig,' ');\n}\nreturn paramHash;\n},\ndeserializeUrlHash:function(){\nvar urlHash=U.getUrlHash();\nif(urlHash.length==0)return null;\nvar parameters=urlHash.split(\"&\");\nvar returnHash={};\nfor(var i=0;i<parameters.length;i++){\nvar keyValuePair=parameters[i].split(\"=\");\nreturnHash[keyValuePair[0]]=JSON.parse(keyValuePair[1]);\n}\nreturn returnHash;\n},\nsetQuietUrlHash:function(hash){\nvar currentHashLength=U.getUrlHash().length;\nvar href=location.href.substr(0,location.href.length-currentHashLength);\nif(href[href.length-1]==\"#\"){\nhref=href.substr(0,href.length-2);\n}\nlocation.replace(href+\"#\"+hash);\n},\ndetermineObjectCountInHash:function(hash){\nreturn U.hashToArray(hash).length;\n},\nhashToArray:function(hash){\nvar array=[];\nfor(var i in hash){\nif(i!=\"extend\"&&hash[i]!=undefined){\narray.push(hash[i]);\n}\n}\nreturn array;\n},\nunmarshalJson:function(json){\nreturn eval('('+json+')');\n},\nserializeObject:function(baseName,object){\nif(!object)return \"\";\nvar serialized=[];\nvar id=object.id;\nfor(var key in object){\nif(typeof object[key]==\"function\")continue;\nif(typeof object[key]==\"object\"){\nvar value=U.serializeObject(baseName+\"[\"+key+\"]\",object[key]);\nif(value.length>0){\nserialized.push(value);\n}\n}else if(object[key]!=undefined&&object[key]!=null){\nserialized.push(U.urlEncode(baseName)+\"[\"+U.urlEncode(key)+\"]=\"+U.urlEncode(\"\"+object[key]));\n}\n}\nreturn serialized.join(\"&\");\n},\nurlEncode:function(string){\nreturn string\n.replace(/\\%/ig,\"%25\")\n.replace(/\\\\/ig,\"%5C\")\n.replace(/\\$/ig,\"%24\")\n.replace(/&/ig,\"%26\")\n.replace(/\\+/ig,\"%2B\")\n.replace(/,/ig,\"%2C\")\n.replace(/\\//ig,\"%2F\")\n.replace(/\\:/ig,\"%3A\")\n.replace(/\\;/ig,\"%3B\")\n.replace(/\\=/ig,\"%3D\")\n.replace(/\\?/ig,\"%3F\")\n.replace(/\\@/ig,\"%40\")\n.replace(/\\ /ig,\"%20\")\n.replace(/\\\"/ig,\"%22\")\n.replace(/\\</ig,\"%3C\")\n.replace(/\\>/ig,\"%3E\")\n.replace(/\\#/ig,\"%23\")\n.replace(/\\{/ig,\"%7B\")\n.replace(/\\}/ig,\"%7D\")\n.replace(/\\|/ig,\"%7C\")\n.replace(/\\^/ig,\"%5E\")\n.replace(/\\~/ig,\"%7E\")\n.replace(/\\[/ig,\"%5B\")\n.replace(/\\]/ig,\"%5D\")\n.replace(/\\`/ig,\"%60\")\n.replace(/\\n/ig,\"%0D\");\n},\nsetFieldValueWhenItExists:function(fieldName,value,tries){\nif(!tries)tries=100;\nif(!fieldName)return;\nif($(fieldName)){\nU.setFieldValue(fieldName,value);\n}\nelse if(tries>1){\nsetTimeout(function(){U.setFieldValueWhenItExists(fieldName,value,tries-1);},200);\n}\n},\nsetFieldValue:function(fieldName,value){\nif($(fieldName))$(fieldName).value=value;\n},\ndebug:function(obj){\nvar info=[];\nif(typeof obj in[\"string\",\"number\"]){\nreturn obj;\n}else{\nfor(property in obj)\nif(typeof obj[property]==\"function\")\ninfo.push(property+' => function');\nelse\ninfo.push(property+' => '+\n(typeof obj[property]==\"string\"?\n'\"'+obj[property]+'\"':\nobj[property]));\n}\nreturn(\"'\"+obj+\"' #\"+typeof obj+\n\": {\"+info.join(\", \")+\"}\");\n},\nscrollToElement:function(element){\nvar fromTop=Position.cumulativeOffset(element)[1];\nvar offset=window.pageYOffset||document.documentElement.scrollTop;\nif(fromTop<offset)\n{\nwindow.scroll(0,fromTop-100);\n}\n},\ngetScaledPhotoDimensions:function(ratio,maxWidth,maxHeight){\nvar dimensions={width:maxWidth,height:maxHeight};\nif(ratio>(maxWidth/maxHeight)){\ndimensions.width=maxWidth;\ndimensions.height=maxWidth/ratio;\n}else{\ndimensions.width=maxHeight*ratio;\ndimensions.height=maxHeight;\n}\nreturn dimensions;\n},\ngetMap:function(){\nreturn window.walkApp?window.walkApp.map:window.walkExplorer.map;\n},\ntranslateGoogleGeocodedResults:function(results){\nif(!results||results.length==0)return[];\nvar resultLength=results.length;\nvar translatedResults=[];\nfor(var i=0;i<resultLength;++i){\nvar translatedResult={\ncountry:'',\nregion:'',\narea:'',\nsubarea:'',\nstreet1:'',\nstreet2:'',\nzipcode:'',\nphonenumber:''\n};\ntranslatedResult.link_title=results[i].formatted_address;\nfor(var j=0;j<results[i].address_components.length;++j){\ncomponent=results[i].address_components[j];\nswitch(component.types[0]){\ncase 'street_number':\nif(translatedResult.street1){\ntranslatedResult.street1=component.short_name+' '+translatedResult.street1;\n}else{\ntranslatedResult.street1=component.short_name;\n}\nbreak;\ncase 'route':\nif(translatedResult.street1){\ntranslatedResult.street1+=' '+component.short_name;\n}else{\ntranslatedResult.street1=component.short_name;\n}\nbreak;\ncase 'neighborhood':\ntranslatedResult.subarea=component.short_name;\nbreak;\ncase 'administrative_area_level_1':\ntranslatedResult.region=component.short_name;\nbreak;\ncase 'locality':\ntranslatedResult.area=component.short_name;\nbreak;\ncase 'country':\ntranslatedResult.country=component.short_name;\nbreak;\ncase 'postal_code':\ntranslatedResult.zipcode=component.short_name;\nbreak;\n}\n}\nswitch(results[i].types[0]){\ncase 'street_address':\ntranslatedResult.zoom=12;\nbreak;\ncase 'route':\ntranslatedResult.zoom=10;\nbreak;\ncase 'locality':\ntranslatedResult.zoom=8;\nbreak;\ncase 'administrative_area_level_2':\ntranslatedResult.zoom=7;\nbreak;\ncase 'postal_code':\ntranslatedResult.zoom=7;\nbreak;\ncase 'administrative_area_level_1':\ntranslatedResult.zoom=6;\nbreak;\ncase 'country':\ntranslatedResult.zoom=4;\nbreak;\ndefault:\ntranslatedResult.zoom=7;\nbreak;\n}\ntranslatedResult.x=results[i].geometry.location.lng();\ntranslatedResult.y=results[i].geometry.location.lat();\ntranslatedResults.push(translatedResult);\n}\nreturn translatedResults;\n},\nformatMoney:function(mnt){\nmnt-=0;\nmnt=(Math.round(mnt*100))/100;\nvar fullAmt=\"\"+((mnt==Math.floor(mnt))?mnt+'.00':((mnt*10==Math.floor(mnt*10))?mnt+'0':mnt));\nwhile(fullAmt.match(/(\\d)(\\d\\d\\d)([.,])/))fullAmt=fullAmt.replace(/(\\d)(\\d\\d\\d)([.,])/ig,\"$1,$2$3\");\nreturn fullAmt;\n},\ntrimWhiteSpace:function(string){\nif(!string)return string;\nreturn string.replace(/^[\\t]*|[\\t]*$/ig,\"\");\n},\ngeneratePolygonFromPoint:function(point,distance,color){\nif(!color)color='#003265'\nvar fourCorners=U.getFourCorners(point,distance);\nreturn new google.maps.Polygon({paths:fourCorners,fillColor:color,strokeWeight:1,opacity:0.4,strokeColor:color,strokeOpacity:0.4});\n},\ngetBoundsZoomLevel:function(map,bound){\nvar MAX_ZOOM=21;\nvar MIN_ZOOM=0;\nvar projection=map.getProjection();\nif(!projection){return 0};\nvar ne=projection.fromLatLngToPoint(bound.getNorthEast());\nvar sw=projection.fromLatLngToPoint(bound.getSouthWest());\nvar worldCoordWidth=Math.abs(ne.x-sw.x);\nvar worldCoordHeight=Math.abs(ne.y-sw.y);\nvar FIT_PAD=40;\nfor(var zoom=MAX_ZOOM;zoom>=MIN_ZOOM;--zoom){\nif(worldCoordWidth*(1<<zoom)+2*FIT_PAD<$(map.getDiv()).getDimensions().width&&\nworldCoordHeight*(1<<zoom)+2*FIT_PAD<$(map.getDiv()).getDimensions().height)\nreturn zoom;\n}\nreturn 0;\n},\ngetBounds:function(polygon){\nvar bounds=new google.maps.LatLngBounds();\nvar path=polygon.getPath();\nfor(var i=0;i<path.getLength();++i){\nbounds.extend(path.getAt(i));\n}\nreturn bounds\n},\ngenerateBoundsFromPoint:function(point,distance){\nvar fourCorners=U.getFourCorners(point,distance);\nvar bounds=new google.maps.LatLngBounds(fourCorners[3],fourCorners[1]);\nbounds.asParams=function(paramName){\nvar boundingBoxString=paramName+\"[top_right_lat]=\"+U.roundFloat(this.getNorthEast().lat(),4);\nboundingBoxString+=\"&\"+paramName+\"[top_right_lng]=\"+U.roundFloat(this.getNorthEast().lng(),4);\nboundingBoxString+=\"&\"+paramName+\"[bottom_left_lat]=\"+U.roundFloat(this.getSouthWest().lat(),4);\nboundingBoxString+=\"&\"+paramName+\"[bottom_left_lng]=\"+U.roundFloat(this.getSouthWest().lng(),4);\nreturn boundingBoxString;\n}\nreturn bounds;\n},\ngetFourCorners:function(point,distance){\nif(!distance)distance=7.5;\nvar mileInMeters=1609.344;\nvar latDistance=google.maps.geometry.spherical.computeDistanceBetween(point,new google.maps.LatLng(parseFloat(point.lat())+1,point.lng()));\nvar lngDistance=google.maps.geometry.spherical.computeDistanceBetween(point,new google.maps.LatLng(point.lat(),parseFloat(point.lng())+1));\nvar north=parseFloat(point.lat())+(distance*(mileInMeters/latDistance));\nvar east=parseFloat(point.lng())+(distance*(mileInMeters/lngDistance));\nvar south=parseFloat(point.lat())-(distance*(mileInMeters/latDistance));\nvar west=parseFloat(point.lng())-(distance*(mileInMeters/lngDistance));\nreturn[\nnew google.maps.LatLng(north,west),\nnew google.maps.LatLng(north,east),\nnew google.maps.LatLng(south,east),\nnew google.maps.LatLng(south,west)\n]\n},\nroundFloat:function(number,digits){\nnumber=parseFloat(number);\ndigits=parseInt(digits);\nvar rounded=Math.round(number*(Math.pow(10,digits)))/(Math.pow(10,digits));\nreturn rounded\n},\ncreateCookie:function(name,value,days){\nif(days){\nvar date=new Date();\ndate.setTime(date.getTime()+(days*24*60*60*1000));\nvar expires=\"; expires=\"+date.toGMTString();\n}\nelse var expires=\"\";\ndocument.cookie=name+\"=\"+value+expires+\"; path=/\";\n},\nreadCookie:function(name){\nvar nameEQ=name+\"=\";\nvar ca=document.cookie.split(';');\nfor(var i=0;i<ca.length;i++){\nvar c=ca[i];\nwhile(c.charAt(0)==' ')c=c.substring(1,c.length);\nif(c.indexOf(nameEQ)==0)return c.substring(nameEQ.length,c.length);\n}\nreturn null;\n},\neraseCookie:function(name){\nU.createCookie(name,\"\",-1);\n},\nsubmitBounds:function(center,place,formal_place,ranges){\nvar url=[\"/bounds/create?bounds[center_lat]=\"]\nurl.push(center.lat());\nurl.push(\"&bounds[center_lng]=\");\nurl.push(center.lng());\nurl.push(\"&bounds[place]=\");\nurl.push(place);\nurl.push(\"&bounds[formal_place]=\");\nurl.push(formal_place);\nfor(var i=0;i<ranges.length;++i){\nvar bound=U.generateBoundsFromPoint(center,ranges[i]);\nurl.push(\"&bounds[polygon_\");\nurl.push(i+1);\nurl.push(\"]=\");\nurl.push(U.boundToMysql(bound));\n}\nnew Ajax.Request(url.join(''),{asynchronous:true,evalScripts:true,post:true});\n},\nboundToMysql:function(bound){\nvar ne=bound.getNorthEast();\nvar sw=bound.getSouthWest();\nreturn U.pointsToMysql([ne,new google.maps.LatLng(sw.lat(),ne.lng()),sw,new google.maps.LatLng(ne.lat(),sw.lng())]);\n},\npointsToMysql:function(points){\nif(points.length==0)return \"\";\nvar values=[]\nfor(var i=0;i<points.length;++i){\nvalues.push(U.roundFloat(points[i].lat(),4)+\" \"+U.roundFloat(points[i].lng(),4))\n}\nvalues.push(U.roundFloat(points[0].lat(),4)+\" \"+U.roundFloat(points[0].lng(),4))\nreturn \"POLYGON((\"+values.join(\", \")+\"))\";\n},\nopenDirectionsWindow:function(addresses){\nvar url=[\"http://maps.google.com/maps?f=d&source=s_d&hl=en&dirflg=&ie=UTF8&saddr=\"];\nfor(var i=0;i<addresses.length;++i){\nif(url.length==2)url.push(\"&daddr=\");\nif(url.length>3)url.push(\"+to:\");\nurl.push(U._makeAddressUrlSafe(addresses[i]));\n}\nvar height=U.getWindowDimension(true);\nvar width=U.getWindowDimension(false);\nwindow.open(url.join(\"\"),'','scrollbars=yes,menubar=no,height='+height+',width='+width+',resizable=yes,toolbar=no,location=no,status=no');\n},\n_makeAddressUrlSafe:function(description){\nreturn description.replace(/&/ig,'and').replace(/#/ig,'%23');\n}\n};\nCommandQueue=Class.create();\nCommandQueue.END_OF_QUEUE=\"End of Queue\"\nCommandQueue.prototype={\ninitialize:function(server){\nif(!server){\nthrow(\"please pass in a server proxy\");\n}\nthis.server=server;\nthis.clear();\nthis.hasFailed=false;\n},\nprocessHead:function(){\nif(this.contents.length==0){\nreturn;\n}\nvar commandAtHead=this.contents[0];\nCwLog.write(\"process: \"+commandAtHead.toString());\nthis.sendToServer(commandAtHead);\n},\nsendToServer:function(command){\nthis.server.sendCommand(command,this.reactToAjaxResponse.bind(this));\n},\nreactToAjaxResponse:function(success,responseJson){\nif(success){\nif(responseJson){\nthis.passCommandResponseFromServerToCommand(responseJson);\n}\nthis.dequeue();\n}else{\nif(this.hasFailed)return;\nif(confirm('The connection to CommunityWalk has either been lost or has slowed down a great deal.\\nPlease click \"Ok\" to refresh the page and ensure that all of your work has been saved.')){\nlocation.reload();\n}\n}\n},\npassCommandResponseFromServerToCommand:function(responseJson){\nCwLog.write(\"passing response: \"+JSON.stringify(responseJson)+\" to command[0]: \"+this.contents[0]);\nthis.contents[0].responseFromServer(responseJson)\n},\nenqueue:function(command){\nvar shouldProcess=this.contents.length==0\nthis.contents.push(command);\nCwLog.write(\"enqueued: \"+command.toString()+\", queue contents:\\n\"+this.toString());\ncommand.execute();\nif(shouldProcess){\nthis.processHead(command);\n}\n},\ndequeue:function(){\nif(this.contents.length==0){\nCwLog.write(\"dequeue, END OF QUEUE\");\nreturn CommandQueue.END_OF_QUEUE;\n}\nvar shifted=this.contents.shift();\nCwLog.write(\"dequeue\"+shifted.toString()+\", queue contents:\\n\"+this.toString());\nthis.processHead();\nreturn shifted;\n},\nclear:function(){\nthis.contents=[];\n},\ntoString:function(){\nreturn $A(this.contents).inspect();\n}\n}\nServerProxy=Class.create();\nServerProxy.TIMEOUT_LENGTH=10000;\nServerProxy.prototype={\ninitialize:function(timeout){\nif(timeout)ServerProxy.TIMEOUT_LENGTH=timeout;\n},\nsendCommand:function(command,callback){\nvar ajaxPayload=command.asAjaxPayload();\nif(!ajaxPayload){\ncallback(true);\nreturn;\n}\nvar parameters=ajaxPayload.parameters;\nvar request=\nnew Ajax.Request(ajaxPayload.url,\n{\nparameters:parameters,\nonSuccess:function(response){\nif(response.responseText.indexOf(\"AAA_DOWN_FOR_MAINTENANCE_XXX\")>-1){\ncallback(false,null);\n}else if(response.responseText.length>0){\nvar responseJson=JSON.parse(response.responseText);\ncallback(true,responseJson);\n}else{\ncallback(true,null);\n}\n}.bind(this),\nonFailure:function(response){\ncallback(false,null);\n}.bind(this),\nonComplete:function(){\nrequest.completed=true;\n}\n});\nthis.currentAjaxRequest=request;\nsetTimeout(function(){\nif(!request.completed){\ncallback(false,null);\n}\n},ServerProxy.TIMEOUT_LENGTH);\n}\n}\nCwLog={};\nCwLog.shouldLog=false;\nCwLog.write=function(msg){\nif(CwLog.shouldLog){\nGLog.write(msg);\n}\n}\nHTMLColor=Class.create();\nHTMLColor.LIGHT_COLOR=\"FFFFFF\";\nHTMLColor.DARK_COLOR=\"000000\";\nHTMLColor.LIGHT_COLORS=[\n\"FFFFFF\",'33FEFE','A5FBFE','66FE00','72DD89','B1F666','00CBCB','E0B2D0','FF9900'\n];\nHTMLColor.prototype={\ninitialize:function(backgroundColor){\nthis.setColor(backgroundColor);\n},\nsetColor:function(backgroundColor){\nbackgroundColor=backgroundColor.replace(/#/ig,\"\").toUpperCase();\nthis.backgroundColor=\"#\"+backgroundColor;\nthis.foregroundColor=\"#\"+this.mapColor(backgroundColor);\nthis.value=backgroundColor;\n},\nmapColor:function(backgroundColor){\nbackgroundColor=backgroundColor;\nfor(var i=0;i<HTMLColor.LIGHT_COLORS.length;++i){\nif(HTMLColor.LIGHT_COLORS[i]==backgroundColor)return HTMLColor.DARK_COLOR;\n}\nreturn HTMLColor.LIGHT_COLOR;\n}\n}\n/*\nCopyright(c)2005 JSON.org\nPermission is hereby granted,free of charge,to any person obtaining a copy\nof this software and associated documentation files(the \"Software\"),to deal\nin the Software without restriction,including without limitation the rights\nto use,copy,modify,merge,publish,distribute,sublicense,and/or sell\ncopies of the Software,and to permit persons to whom the Software is\nfurnished to do so,subject to the following conditions:\nThe Software shall be used for Good,not Evil.\nTHE SOFTWARE IS PROVIDED \"AS IS\",WITHOUT WARRANTY OF ANY KIND,EXPRESS OR\nIMPLIED,INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,DAMAGES OR OTHER\nLIABILITY,WHETHER IN AN ACTION OF CONTRACT,TORT OR OTHERWISE,ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n/*\nThe global object JSON contains two methods.\nJSON.stringify(value)takes a JavaScript value and produces a JSON text.\nThe value must not be cyclical.\nJSON.parse(text)takes a JSON text and produces a JavaScript value. It will\nreturn false if there is an error.\n*/\nvar JSON=function(){\nvar m={\n'\\b':'\\\\b',\n'\\t':'\\\\t',\n'\\n':'\\\\n',\n'\\f':'\\\\f',\n'\\r':'\\\\r',\n'\"':'\\\\\"',\n'\\\\':'\\\\\\\\'\n},\ns={\n'boolean':function(x){\nreturn String(x);\n},\nnumber:function(x){\nreturn isFinite(x)?String(x):'null';\n},\nstring:function(x){\nif(/[\"\\\\\\x00-\\x1f]/.test(x)){\nx=x.replace(/([\\x00-\\x1f\\\\\"])/g,function(a,b){\nvar c=m[b];\nif(c){\nreturn c;\n}\nc=b.charCodeAt();\nreturn '\\\\u00'+\nMath.floor(c/16).toString(16)+\n(c%16).toString(16);\n});\n}\nreturn '\"'+x+'\"';\n},\nobject:function(x){\nif(x){\nvar a=[],b,f,i,l,v;\nif(x instanceof Array){\na[0]='[';\nl=x.length;\nfor(i=0;i<l;i+=1){\nv=x[i];\nf=s[typeof v];\nif(f){\nv=f(v);\nif(typeof v=='string'){\nif(b){\na[a.length]=',';\n}\na[a.length]=v;\nb=true;\n}\n}\n}\na[a.length]=']';\n}else if(x instanceof Object){\na[0]='{';\nfor(i in x){\nv=x[i];\nf=s[typeof v];\nif(f){\nv=f(v);\nif(typeof v=='string'){\nif(b){\na[a.length]=',';\n}\na.push(s.string(i),':',v);\nb=true;\n}\n}\n}\na[a.length]='}';\n}else{\nreturn;\n}\nreturn a.join('');\n}\nreturn 'null';\n}\n};\nreturn{\ncopyright:'(c)2005 JSON.org',\nlicense:'http://www.JSON.org/license.html',\n/*\nStringify a JavaScript value,producing a JSON text.\n*/\nstringify:function(v){\nvar f=s[typeof v];\nif(f){\nv=f(v);\nif(typeof v=='string'){\nreturn v;\n}\n}\nreturn null;\n},\n/*\nParse a JSON text,producing a JavaScript value.\nIt returns false if there is a syntax error.\n*/\nparse:function(text){\ntry{\nreturn !(/[^,:{}\\[\\]0-9.\\-+Eaeflnr-u \\n\\r\\t]/.test(\ntext.replace(/\"(\\\\.|[^\"\\\\])*\"/g,'')))&&\neval('('+text+')');\n}catch(e){\nreturn false;\n}\n}\n};\n}();\nRoundyCorners={\ncreate:function(containedElement,cornerSpecification){\nvar theWholeEnchilada=document.createElement('table');\nvar body=document.createElement(\"tbody\");\nif(cornerSpecification.className)theWholeEnchilada.className=cornerSpecification.className\ntheWholeEnchilada.appendChild(body);\ntheWholeEnchilada.cellPadding=0;\ntheWholeEnchilada.cellSpacing=0;\nvar topRow=document.createElement('tr');\nvar topLeft=this._buildCornerTd(cornerSpecification.topLeft);\nvar topMiddle=this._buildMiddleTd({\nimage:cornerSpecification.topMiddle,\nrepeat:\"repeat-x\",\ncolor:cornerSpecification.color,\nborder:cornerSpecification.border,\nside:\"Top\"\n});\nvar topRight=this._buildCornerTd(cornerSpecification.topRight);\ntopRow.appendChild(topLeft);\ntopRow.appendChild(topMiddle);\ntopRow.appendChild(topRight);\nvar middleRow=document.createElement('tr');\nvar middleLeft=this._buildMiddleTd({\nimage:cornerSpecification.middleLeft,\nrepeat:\"repeat-y\",\ncolor:cornerSpecification.color,\nborder:cornerSpecification.border,\nside:\"Left\"\n});\nvar middleMiddle=this._buildMiddleTd({image:cornerSpecification.middleMiddle,repeat:\"repeat\",color:cornerSpecification.color});\nmiddleMiddle.appendChild(containedElement);\nif(cornerSpecification.expandToFit){\nmiddleMiddle.style.width=\"100%\";\n}\nvar middleRight=this._buildMiddleTd({\nimage:cornerSpecification.middleRight,\nrepeat:\"repeat-y\",\ncolor:cornerSpecification.color,\nborder:cornerSpecification.border,\nside:\"Right\"\n});\nmiddleRow.appendChild(middleLeft);\nmiddleRow.appendChild(middleMiddle);\nmiddleRow.appendChild(middleRight);\nvar bottomRow=document.createElement('tr');\nvar bottomLeft=this._buildCornerTd(cornerSpecification.bottomLeft);\nvar bottomMiddle=this._buildMiddleTd({\nimage:cornerSpecification.bottomMiddle,\nrepeat:\"repeat-x\",\ncolor:cornerSpecification.color,\nborder:cornerSpecification.border,\nside:\"Bottom\"\n});\nvar bottomRight=this._buildCornerTd(cornerSpecification.bottomRight);\nbottomRow.appendChild(bottomLeft);\nbottomRow.appendChild(bottomMiddle);\nbottomRow.appendChild(bottomRight);\nbody.appendChild(topRow);\nbody.appendChild(middleRow);\nbody.appendChild(bottomRow);\nreturn theWholeEnchilada;\n},\n_buildCornerTd:function(imgSrc){\nvar td=document.createElement('td');\nvar img=document.createElement(\"img\");\nimg.style.display=\"block\";\nif(imgSrc.indexOf(\"png\")>-1&&document.all){\nimg.src=\"/images/blank.gif\";\nimg.style.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src='+imgSrc+',enabled=1)';\n}else{\nimg.src=imgSrc;\n}\ntd.appendChild(img);\nreturn td;\n},\n_buildMiddleTd:function(instructions){\nvar td=document.createElement('td');\nif(instructions.image){\ntd.style.backgroundImage='url('+instructions.image+')';\nif(instructions.repeat)td.style.backgroundRepeat=instructions.repeat;\n}else if(instructions.color){\ntd.style.backgroundColor=instructions.color;\nif(instructions.border&&instructions.side){\ntd.style[\"border\"+instructions.side]=instructions.border;\ntd.innerHTML=\"&nbsp;\";\ntd.style.lineHeight=\"1px\";\n}\n}\nreturn td;\n},\nwrapExistingElement:function(id,cornerSpecification,displayWhenDone){\nvar element=document.getElementById(id);\nvar parent=element.parentNode;\nvar children=parent.childNodes;\nvar sibling;\nfor(var i=0;i<children.length;++i){\nif(children[i]==element&&i<children.length-1){\nsibling=children[i+1];\nbreak;\n}\n}\nparent.removeChild(element);\nif(sibling){\nparent.insertBefore(this.create(element,cornerSpecification),sibling);\n}else{\nparent.appendChild(this.create(element,cornerSpecification));\n}\nif(displayWhenDone)Element.show(id);\n},\nwrapExistingElementsOfClass:function(container,className,cornerSpecification,displayWhenDone){\nvar elements=U.findClassNamesInElement(container,className);\nfor(var i=0;i<elements.length;++i){\nvar tempId=\"wrapExistingElementOfClass\"+i;\nif(!elements[i].id)elements[i].id=tempId;\nthis.wrapExistingElement(elements[i].id,cornerSpecification,displayWhenDone);\nif(elements[i].id==tempId)elements[i].id=\"\";\n}\n}\n};\nPopup2=Class.create();\nPopup2.prototype={\ninitialize:function(popupElementId,options){\nthis.popupElementId=popupElementId;\nthis.options={\nplacement:Placement.CENTER_IN_WINDOW,\nmaskOpacity:0.5,\nmaskElementId:\"mask\",\nmaskZindex:1000,\nmaskBackgroundColor:\"#FFFFFF\",\npopupZindex:2000,\npopupCssClass:\"popup\",\nscrollableElementIds:[]\n};\nObject.extend(this.options,options||{});\nthis._initializePopupElement();\n},\nvisible:function(){\nreturn this.popupElement.visible();\n},\nshowPopup:function(){\nthis.options.placement.placeElement(this.popupElement);\nElement.show(this.popupElement);\nElement.hideScrollbarsUnderElement(this.popupElement,this.options.scrollableElementIds);\nElement.reveal(this.popupElement);\n},\nshowMask:function(){\nthis._initializeMaskElement();\nElement.reveal(this.maskElement);\nElement.hideScrollbarsUnderElement(this.maskElement,this.options.scrollableElementIds);\n},\nshowPopupWithMask:function(){\nthis.showMask();\nthis.showPopup();\n},\nhide:function(){\nElement.conceal(this.popupElement);\nElement.hide(this.popupElement);\nif(this.maskElement){\nElement.conceal(this.maskElement);\n}\nElement.unhideScrollbars(this.options.scrollableElementIds);\n},\n_initializeMaskElement:function(){\nthis.maskElement=$(this.options.maskElementId);\nif(this.maskElement==null){\nthis.maskElement=document.createElement('div');\ndocument.body.appendChild(this.maskElement);\ndocument.body.style.height=\"100%\";\nthis.maskElement.id=this.options.maskElementId;\nthis.maskElement.style.backgroundColor=this.options.maskBackgroundColor;\nthis.maskElement.style.width=\"100%\";\nthis.maskElement.style.height=document.documentElement.scrollHeight+\"px\";\nthis.maskElement.style.position=\"absolute\";\nthis.maskElement.style.top=\"0px\";\nthis.maskElement.style.left=\"0px\";\nElement.setOpacity(this.maskElement,this.options.maskOpacity);\nthis.maskElement.style.zIndex=this.options.maskZindex.toString();\nElement.conceal(this.maskElement);\n}\n},\n_initializePopupElement:function(){\nthis.popupElement=$(this.popupElementId);\nif(this.popupElement==null){\nthis.popupElement=document.createElement('div');\ndocument.body.appendChild(this.popupElement);\nthis.popupElement.id=this.popupElementId;\n}\nthis.popupElement.className=this.options.popupCssClass;\nthis.popupElement.style.zIndex=this.options.popupZindex.toString();\nElement.hide(this.popupElement);\nElement.conceal(this.popupElement);\n}\n};\nPlacement=Class.create();\nPlacement.prototype={\ninitialize:function(positionCode,options){\nthis.positionCode=positionCode;\nthis.options={\nspacingPixels:5,\nalign:Placement.ALIGN_LEFT_EDGE,\noffsetHorizontal:0,\noffsetVertical:0\n};\nObject.extend(this.options,options||{});\n},\nplaceElement:function(element){\nswitch(this.positionCode){\ncase Placement.CENTER_CODE:\nUtils.centerInWindow(element);\nbreak;\ncase Placement.DO_NOT_POSITION_CODE:\nbreak;\ncase Placement.BELOW_CODE:\nvar relatedElement=$(this.options.relatedElementId);\nvar relatedOffset=this.getOffsetFor(relatedElement);\nvar relatedHeight=Utils.heightWithBorders(relatedElement);\nelement.style.position=\"absolute\";\nswitch(this.options.align){\ncase Placement.ALIGN_LEFT_EDGE:\nelement.style.left=(relatedOffset[0]+this.options.offsetHorizontal)+\"px\";\nbreak;\ncase Placement.ALIGN_RIGHT_EDGE:\nvar relatedWidth=Utils.widthWithBorders(relatedElement);\nvar elementWidth=Utils.widthWithBorders(element);\nelement.style.left=(relatedOffset[0]+relatedWidth-elementWidth+this.options.offsetHorizontal)+\"px\";\nbreak;\ndefault:\nthrow new Error(\"Unknown alignment - \"+this.options.align);\n}\nelement.style.top=(relatedOffset[1]+relatedHeight+this.options.offsetVertical+this.options.spacingPixels)+\"px\";\nbreak;\ndefault:\nthrow new Error(\"Unknown position code - \"+this.positionCode);\n}\n},\ngetOffsetFor:function(element){\nreturn Position.cumulativeOffset(element);\n}\n};\nPlacement.CENTER_CODE=\"center\";\nPlacement.DO_NOT_POSITION_CODE=\"noposition\";\nPlacement.BELOW_CODE=\"below\";\nPlacement.ALIGN_LEFT_EDGE=\"leftedge\";\nPlacement.ALIGN_RIGHT_EDGE=\"rightedge\";\nPlacement.CENTER_IN_WINDOW=new Placement(Placement.CENTER_CODE);\nPlacement.DO_NOT_POSITION=new Placement(Placement.DO_NOT_POSITION_CODE);\nPlacement.belowElement=function(elementId,options){\noptions.relatedElementId=elementId;\nreturn new Placement(Placement.BELOW_CODE,options);\n}\nElement.descendantsWithClassName=function(parentElement,className){\nvar children=parentElement.getElementsByTagName('*');\nreturn $A(children).inject([],function(elements,child){\nif(Element.hasClassName(child,className)){\nelements.push(child);\n}\nreturn elements;\n});\n};\nElement.conceal=function(element){\nelement.style.visibility='hidden';\n};\nElement.reveal=function(element){\nelement.style.visibility='visible';\n};\nElement.create=function(name){\nreturn document.createElement(name);\n};\nElement.newTextNode=function(text){\nreturn document.createTextNode(text);\n};\nElement.asHTML=function(el){\nvar bar=Element.create('bar');\nbar.appendChild(el);\nreturn bar.innerHTML;\n};\nElement.previousSiblingElement=function(el){\nvar sibling=el.previousSibling;\nwhile(sibling&&sibling.nodeType!=Element.ELEMENT_NODE){\nsibling=sibling.previousSibling;\n}\nreturn sibling;\n};\nElement.nextSiblingElement=function(el){\nvar sibling=el.nextSibling;\nwhile(sibling&&sibling.nodeType!=Element.ELEMENT_NODE){\nsibling=sibling.nextSibling;\n}\nreturn sibling;\n};\nElement.getPosY=function(element){\nreturn YAHOO.util.DragDropMgr.getPosY(element);\n};\nElement.getPosX=function(element){\nreturn YAHOO.util.DragDropMgr.getPosX(element);\n};\nElement.isElementOverVerticalScrollbar=function(element,scrollableElement){\nif(scrollableElement.clientHeight>=scrollableElement.scrollHeight){\nreturn false;\n}\nvar elementPosition={\ny:Element.getPosY(element),\nx:Element.getPosX(element)\n}\nvar scrollableElementPosition={\ny:Element.getPosY(scrollableElement),\nx:Element.getPosX(scrollableElement)\n}\nvar elementRegion=new Region(\nelementPosition.y,\nelementPosition.x+element.clientWidth,\nelementPosition.y+element.clientHeight,\nelementPosition.x);\nvar verticalScrollbarRegion=new Region(\nscrollableElementPosition.y,\nscrollableElementPosition.x+scrollableElement.clientWidth,\nscrollableElementPosition.y+scrollableElement.clientHeight,\nscrollableElementPosition.x+scrollableElement.clientWidth-15);\nreturn elementRegion.intersects(verticalScrollbarRegion);\n}\nElement.hideScrollbarsUnderElement=function(element,scrollableElementIds){\nif(BrowserDetect.OS!=\"Mac\"||\n(BrowserDetect.browser==\"Firefox\"&&BrowserDetect.version==3)||\n(BrowserDetect.browser==\"Safari\")){\nreturn;\n}\nfor(var i=0;i<scrollableElementIds.length;i++){\nvar scrollableElement=document.getElementById(scrollableElementIds[i]);\nif(scrollableElement){\nif(Element.isElementOverHorizontalScrollbar(element,scrollableElement)){\nElement.addClassName(scrollableElement,\"no_xscroll\");\n};\nif(Element.isElementOverVerticalScrollbar(element,scrollableElement)){\nElement.addClassName(scrollableElement,\"no_yscroll\");\n};\n}\n}\n}\nElement.unhideScrollbars=function(scrollableElementIds){\nfor(var i=0;i<scrollableElementIds.length;i++){\nvar element=document.getElementById(scrollableElementIds[i]);\nif(element){\nElement.removeClassName(element,\"no_xscroll\");\nElement.removeClassName(element,\"no_yscroll\");\n};\n}\n}\nElement.isElementOverHorizontalScrollbar=function(element,scrollableElement){\nif(scrollableElement.clientWidth>=scrollableElement.scrollWidth){\nreturn false;\n}\nvar elementPosition={\ny:Element.getPosY(element),\nx:Element.getPosX(element)\n}\nvar scrollableElementPosition={\ny:Element.getPosY(scrollableElement),\nx:Element.getPosX(scrollableElement)\n}\nvar elementRegion=new Region(\nelementPosition.y,\nelementPosition.x+element.clientWidth,\nelementPosition.y+element.clientHeight,\nelementPosition.x);\nvar horizontalScrollbarRegion=new Region(\nscrollableElementPosition.y+scrollableElement.clientHeight-15,\nscrollableElementPosition.x+scrollableElement.clientWidth,\nscrollableElementPosition.y+scrollableElement.clientHeight,\nscrollableElementPosition.x);\nreturn elementRegion.intersects(horizontalScrollbarRegion);\n}\nvar BrowserDetect={\ninit:function(){\nthis.browser=this.searchString(this.dataBrowser)||\"An unknown browser\";\nthis.version=this.searchVersion(navigator.userAgent)\n||this.searchVersion(navigator.appVersion)\n||\"an unknown version\";\nthis.OS=this.searchString(this.dataOS)||\"an unknown OS\";\n},\nsearchString:function(data){\nfor(var i=0;i<data.length;i++){\nvar dataString=data[i].string;\nvar dataProp=data[i].prop;\nthis.versionSearchString=data[i].versionSearch||data[i].identity;\nif(dataString){\nif(dataString.indexOf(data[i].subString)!=-1)\nreturn data[i].identity;\n}\nelse if(dataProp)\nreturn data[i].identity;\n}\n},\nsearchVersion:function(dataString){\nvar index=dataString.indexOf(this.versionSearchString);\nif(index==-1)return;\nreturn parseFloat(dataString.substring(index+this.versionSearchString.length+1));\n},\ndataBrowser:[\n{string:navigator.userAgent,\nsubString:\"OmniWeb\",\nversionSearch:\"OmniWeb/\",\nidentity:\"OmniWeb\"\n},\n{\nstring:navigator.vendor,\nsubString:\"Apple\",\nidentity:\"Safari\"\n},\n{\nprop:window.opera,\nidentity:\"Opera\"\n},\n{\nstring:navigator.vendor,\nsubString:\"iCab\",\nidentity:\"iCab\"\n},\n{\nstring:navigator.vendor,\nsubString:\"KDE\",\nidentity:\"Konqueror\"\n},\n{\nstring:navigator.userAgent,\nsubString:\"Firefox\",\nidentity:\"Firefox\"\n},\n{\nstring:navigator.vendor,\nsubString:\"Camino\",\nidentity:\"Camino\"\n},\n{\nstring:navigator.userAgent,\nsubString:\"Netscape\",\nidentity:\"Netscape\"\n},\n{\nstring:navigator.userAgent,\nsubString:\"MSIE\",\nidentity:\"Explorer\",\nversionSearch:\"MSIE\"\n},\n{\nstring:navigator.userAgent,\nsubString:\"Gecko\",\nidentity:\"Mozilla\",\nversionSearch:\"rv\"\n},\n{\nstring:navigator.userAgent,\nsubString:\"Mozilla\",\nidentity:\"Netscape\",\nversionSearch:\"Mozilla\"\n}\n],\ndataOS:[\n{\nstring:navigator.platform,\nsubString:\"Win\",\nidentity:\"Windows\"\n},\n{\nstring:navigator.platform,\nsubString:\"Mac\",\nidentity:\"Mac\"\n},\n{\nstring:navigator.platform,\nsubString:\"Linux\",\nidentity:\"Linux\"\n}\n]\n};\nBrowserDetect.init();\nvar Utils={\ncenterInWindow:function(element){\nthis.alignInWindow(element,0.5,0.5);\n},\nalignInWindow:function(element,horizontalRatio,verticalRatio){\nvar windowDimensions=Utils.windowDimensions();\nvar elementDimensions=Element.getDimensions(element);\nvar new_left=(windowDimensions.width-elementDimensions.width)*horizontalRatio+\"px\";\nvar new_top=(windowDimensions.height-elementDimensions.height)*verticalRatio+\"px\";\nelement.style.position='absolute';\nelement.style.left=new_left;\nelement.style.top=new_top;\n},\nwindowDimensions:function(){\nreturn{\nheight:this.window().innerHeight||document.documentElement.clientHeight||document.body.clientHeight,\nwidth:this.window().innerWidth||document.documentElement.clientWidth||document.body.clientWidth\n};\n},\nuseMockWindow:function(w){\nthis.mockedWindow=w;\n},\nwindow:function(){\nreturn this.mockedWindow||window;\n},\nredirectTo:function(url){\nwindow.location.href=url;\n},\nheightWithBorders:function(elem){\nreturn Element.getDimensions(elem).height;\n},\nwidthWithBorders:function(elem){\nreturn Element.getDimensions(elem).width;\n},\nwidthWithBordersAndMargins:function(elem){\nvar width=Element.getDimensions(elem).width;\nwidth=width+this.styleAsNum(elem,\"margin-left\");\nwidth=width+this.styleAsNum(elem,\"margin-right\");\nreturn width;\n},\nheight:function(elem){\nreturn this.heightWithBorders(elem)-this.heightPaddingAndBorders(elem);\n},\nheightPaddingAndBorders:function(elem){\nvar padding=this.styleAsNum(elem,\"padding-top\");\npadding+=this.styleAsNum(elem,\"padding-bottom\");\npadding+=this.styleAsNum(elem,\"border-top-width\");\npadding+=this.styleAsNum(elem,\"border-bottom-width\");\nreturn padding;\n},\nwidth:function(elem){\nvar width=this.widthWithBorders(elem);\nwidth=width-this.styleAsNum(elem,\"padding-left\");\nwidth=width-this.styleAsNum(elem,\"padding-right\");\nwidth=width-this.styleAsNum(elem,\"border-left-width\");\nwidth=width-this.styleAsNum(elem,\"border-right-width\");\nreturn width;\n},\nsetWidth:function(elem,pixels){\nelem.style.width=this._pixelsAsStyleUnit(pixels);\n},\nsetHeight:function(elem,pixels){\nelem.style.height=this._pixelsAsStyleUnit(pixels);\n},\n_pixelsAsStyleUnit:function(pixels){\nif(pixels==NaN||(\"\"+pixels)==\"NaN\"){pixels=0;}\npixels=parseInt(pixels);\nif(pixels<0){pixels=0;}\nreturn pixels.toString()+\"px\";\n},\nmarginLeft:function(elem){return this.styleAsNum(elem,\"margin-left\");},\nmarginRight:function(elem){return this.styleAsNum(elem,\"margin-right\");},\nborderLeft:function(elem){return this.styleAsNum(elem,\"border-left-width\");},\nborderRight:function(elem){return this.styleAsNum(elem,\"border-right-width\");},\nstyleAsNum:function(elem,mozillaProp){\nvar computedStyle=Element.getStyle(elem,mozillaProp);\nif(!computedStyle){\nreturn 0;\n}\ncomputedStyle=computedStyle.substr(0,computedStyle.length-2);\nif(isNaN(computedStyle)){\nreturn 0;\n}\nreturn parseInt(computedStyle);\n},\nasString:function(hash){\nvar str=\"{\";\nfor(var key in hash){\nstr=str+key+\":\"+hash[key]+\",\";\n}\nreturn str+\"}\";\n},\nhashEquals:function(hash1,hash2){\nif(hash1==null&&hash2==null){return true;}\nif(hash1==null||hash2==null){return false;}\nfor(var key1 in hash1){\nif(hash2[key1]==null){return false;}\nif(hash1[key1]!=hash2[key1]){return false;}\n}\nfor(var key2 in hash2){\nif(hash1[key2]==null){return false;}\n}\nreturn true;\n},\ndebug:function(obj){\nvar info=[];\nif(typeof obj in[\"string\",\"number\"]){\nreturn obj;\n}else{\nfor(property in obj){\nif(typeof obj[property]==\"function\"){\ninfo.push(property+' => function');\n}else{\ninfo.push(property+' => '+\n(typeof obj[property]==\"string\"?\n'\"'+obj[property]+'\"':\nobj[property]));\n}\n}\n}\nreturn(\"'\"+obj+\"' #\"+typeof obj+\n\": {\"+info.join(\", \")+\"}\");\n},\ntruncatedText:function(origText,maxLength){\nif(origText==null){\nreturn \"&nbsp;\";\n}else if(origText.length>maxLength){\nreturn origText.substr(0,maxLength-2)+\"...\";\n}else{\nreturn origText;\n}\n},\nstripAccents:function(s){\nvar stripped_string=\"\";\nfor(var i=0;i<s.length;i++){\nch=s.charAt(i);\nstripped=Utils.characterMap[ch];\nif(stripped!=null){\nch=stripped;\n}\nstripped_string+=ch;\n}\nreturn stripped_string;\n}\n};\nUtils.isIE=(navigator.userAgent.toLowerCase().indexOf(\"msie\")!=-1);\nUtils.isOpera=(navigator.userAgent.toLowerCase().indexOf(\"opera\")!=-1);\nUtils.isSafari=(navigator.userAgent.toLowerCase().indexOf(\"safari\")!=-1);\nUtils.characterMap={\n'\\u00c0':'A',\n'\\u00c1':'A',\n'\\u00c2':'A',\n'\\u00c3':'A',\n'\\u00c4':'A',\n'\\u00c5':'A',\n'\\u00c6':\"AE\",\n'\\u00c7':'C',\n'\\u00c8':'E',\n'\\u00c9':'E',\n'\\u00ca':'E',\n'\\u00cb':'E',\n'\\u00cc':'I',\n'\\u00cd':'I',\n'\\u00ce':'I',\n'\\u00cf':'I',\n'\\u00d1':'N',\n'\\u00d2':'O',\n'\\u00d3':'O',\n'\\u00d4':'O',\n'\\u00d5':'O',\n'\\u00d6':'O',\n'\\u00d8':'O',\n'\\u00d9':'U',\n'\\u00da':'U',\n'\\u00db':'U',\n'\\u00dc':'U',\n'\\u00dd':'Y',\n'\\u00e0':'a',\n'\\u00e1':'a',\n'\\u00e2':'a',\n'\\u00e3':'a',\n'\\u00e4':'a',\n'\\u00e5':'a',\n'\\u00e6':\"ae\",\n'\\u00e7':'c',\n'\\u00e8':'e',\n'\\u00e9':'e',\n'\\u00ea':'e',\n'\\u00eb':'e',\n'\\u00ec':'i',\n'\\u00ed':'i',\n'\\u00ee':'i',\n'\\u00ef':'i',\n'\\u00f1':'n',\n'\\u00f2':'o',\n'\\u00f3':'o',\n'\\u00f4':'o',\n'\\u00f5':'o',\n'\\u00f6':'o',\n'\\u00f8':'o',\n'\\u00f9':'u',\n'\\u00fa':'u',\n'\\u00fb':'u',\n'\\u00fc':'u',\n'\\u00fd':'y',\n'\\u00ff':'y'\n};\n\n\n// ***************************************** obfuscated/application ********************************************\n\n\nString.prototype.parseColor=function(){\nvar color='#';\nif(this.slice(0,4)=='rgb('){\nvar cols=this.slice(4,this.length-1).split(',');\nvar i=0;do{color+=parseInt(cols[i]).toColorPart()}while(++i<3);\n}else{\nif(this.slice(0,1)=='#'){\nif(this.length==4)for(var i=1;i<4;i++)color+=(this.charAt(i)+this.charAt(i)).toLowerCase();\nif(this.length==7)color=this.toLowerCase();\n}\n}\nreturn(color.length==7?color:(arguments[0]||this));\n};\nElement.collectTextNodes=function(element){\nreturn $A($(element).childNodes).collect(function(node){\nreturn(node.nodeType==3?node.nodeValue:\n(node.hasChildNodes()?Element.collectTextNodes(node):''));\n}).flatten().join('');\n};\nElement.collectTextNodesIgnoreClass=function(element,className){\nreturn $A($(element).childNodes).collect(function(node){\nreturn(node.nodeType==3?node.nodeValue:\n((node.hasChildNodes()&&!Element.hasClassName(node,className))?\nElement.collectTextNodesIgnoreClass(node,className):''));\n}).flatten().join('');\n};\nElement.setContentZoom=function(element,percent){\nelement=$(element);\nelement.setStyle({fontSize:(percent/100)+'em'});\nif(Prototype.Browser.WebKit)window.scrollBy(0,0);\nreturn element;\n};\nElement.getInlineOpacity=function(element){\nreturn $(element).style.opacity||'';\n};\nElement.forceRerendering=function(element){\ntry{\nelement=$(element);\nvar n=document.createTextNode(' ');\nelement.appendChild(n);\nelement.removeChild(n);\n}catch(e){}\n};\nvar Effect={\n_elementDoesNotExistError:{\nname:'ElementDoesNotExistError',\nmessage:'The specified DOM element does not exist, but is required for this effect to operate'\n},\nTransitions:{\nlinear:Prototype.K,\nsinoidal:function(pos){\nreturn(-Math.cos(pos*Math.PI)/2)+.5;\n},\nreverse:function(pos){\nreturn 1-pos;\n},\nflicker:function(pos){\nvar pos=((-Math.cos(pos*Math.PI)/4) + .75) + Math.random()/4;\nreturn pos>1?1:pos;\n},\nwobble:function(pos){\nreturn(-Math.cos(pos*Math.PI*(9*pos))/2)+.5;\n},\npulse:function(pos,pulses){\nreturn(-Math.cos((pos*((pulses||5)-.5)*2)*Math.PI)/2)+.5;\n},\nspring:function(pos){\nreturn 1-(Math.cos(pos*4.5*Math.PI)*Math.exp(-pos*6));\n},\nnone:function(pos){\nreturn 0;\n},\nfull:function(pos){\nreturn 1;\n}\n},\nDefaultOptions:{\nduration:1.0,\nfps:100,\nsync:false,\nfrom:0.0,\nto:1.0,\ndelay:0.0,\nqueue:'parallel'\n},\ntagifyText:function(element){\nvar tagifyStyle='position:relative';\nif(Prototype.Browser.IE)tagifyStyle+=';zoom:1';\nelement=$(element);\n$A(element.childNodes).each(function(child){\nif(child.nodeType==3){\nchild.nodeValue.toArray().each(function(character){\nelement.insertBefore(\nnew Element('span',{style:tagifyStyle}).update(\ncharacter==' '?String.fromCharCode(160):character),\nchild);\n});\nElement.remove(child);\n}\n});\n},\nmultiple:function(element,effect){\nvar elements;\nif(((typeof element=='object')||\nObject.isFunction(element))&&\n(element.length))\nelements=element;\nelse\nelements=$(element).childNodes;\nvar options=Object.extend({\nspeed:0.1,\ndelay:0.0\n},arguments[2]||{});\nvar masterDelay=options.delay;\n$A(elements).each(function(element,index){\nnew effect(element,Object.extend(options,{delay:index*options.speed+masterDelay}));\n});\n},\nPAIRS:{\n'slide':['SlideDown','SlideUp'],\n'blind':['BlindDown','BlindUp'],\n'appear':['Appear','Fade']\n},\ntoggle:function(element,effect){\nelement=$(element);\neffect=(effect||'appear').toLowerCase();\nvar options=Object.extend({\nqueue:{position:'end',scope:(element.id||'global'),limit:1}\n},arguments[2]||{});\nEffect[element.visible()?\nEffect.PAIRS[effect][1]:Effect.PAIRS[effect][0]](element,options);\n}\n};\nEffect.DefaultOptions.transition=Effect.Transitions.sinoidal;\nEffect.ScopedQueue=Class.create(Enumerable,{\ninitialize:function(){\nthis.effects=[];\nthis.interval=null;\n},\n_each:function(iterator){\nthis.effects._each(iterator);\n},\nadd:function(effect){\nvar timestamp=new Date().getTime();\nvar position=Object.isString(effect.options.queue)?\neffect.options.queue:effect.options.queue.position;\nswitch(position){\ncase 'front':\nthis.effects.findAll(function(e){return e.state=='idle'}).each(function(e){\ne.startOn+=effect.finishOn;\ne.finishOn+=effect.finishOn;\n});\nbreak;\ncase 'with-last':\ntimestamp=this.effects.pluck('startOn').max()||timestamp;\nbreak;\ncase 'end':\ntimestamp=this.effects.pluck('finishOn').max()||timestamp;\nbreak;\n}\neffect.startOn+=timestamp;\neffect.finishOn+=timestamp;\nif(!effect.options.queue.limit||(this.effects.length<effect.options.queue.limit))\nthis.effects.push(effect);\nif(!this.interval)\nthis.interval=setInterval(this.loop.bind(this),15);\n},\nremove:function(effect){\nthis.effects=this.effects.reject(function(e){return e==effect});\nif(this.effects.length==0){\nclearInterval(this.interval);\nthis.interval=null;\n}\n},\nloop:function(){\nvar timePos=new Date().getTime();\nfor(var i=0,len=this.effects.length;i<len;i++)\nthis.effects[i]&&this.effects[i].loop(timePos);\n}\n});\nEffect.Queues={\ninstances:$H(),\nget:function(queueName){\nif(!Object.isString(queueName))return queueName;\nreturn this.instances.get(queueName)||\nthis.instances.set(queueName,new Effect.ScopedQueue());\n}\n};\nEffect.Queue=Effect.Queues.get('global');\nEffect.Base=Class.create({\nposition:null,\nstart:function(options){\nfunction codeForEvent(options,eventName){\nreturn(\n(options[eventName+'Internal']?'this.options.'+eventName+'Internal(this);':'')+\n(options[eventName]?'this.options.'+eventName+'(this);':'')\n);\n}\nif(options&&options.transition===false)options.transition=Effect.Transitions.linear;\nthis.options=Object.extend(Object.extend({},Effect.DefaultOptions),options||{});\nthis.currentFrame=0;\nthis.state='idle';\nthis.startOn=this.options.delay*1000;\nthis.finishOn=this.startOn+(this.options.duration*1000);\nthis.fromToDelta=this.options.to-this.options.from;\nthis.totalTime=this.finishOn-this.startOn;\nthis.totalFrames=this.options.fps*this.options.duration;\nthis.render=(function(){\nfunction dispatch(effect,eventName){\nif(effect.options[eventName+'Internal'])\neffect.options[eventName+'Internal'](effect);\nif(effect.options[eventName])\neffect.options[eventName](effect);\n}\nreturn function(pos){\nif(this.state===\"idle\"){\nthis.state=\"running\";\ndispatch(this,'beforeSetup');\nif(this.setup)this.setup();\ndispatch(this,'afterSetup');\n}\nif(this.state===\"running\"){\npos=(this.options.transition(pos)*this.fromToDelta)+this.options.from;\nthis.position=pos;\ndispatch(this,'beforeUpdate');\nif(this.update)this.update(pos);\ndispatch(this,'afterUpdate');\n}\n};\n})();\nthis.event('beforeStart');\nif(!this.options.sync)\nEffect.Queues.get(Object.isString(this.options.queue)?\n'global':this.options.queue.scope).add(this);\n},\nloop:function(timePos){\nif(timePos>=this.startOn){\nif(timePos>=this.finishOn){\nthis.render(1.0);\nthis.cancel();\nthis.event('beforeFinish');\nif(this.finish)this.finish();\nthis.event('afterFinish');\nreturn;\n}\nvar pos=(timePos-this.startOn)/this.totalTime,\nframe=(pos*this.totalFrames).round();\nif(frame>this.currentFrame){\nthis.render(pos);\nthis.currentFrame=frame;\n}\n}\n},\ncancel:function(){\nif(!this.options.sync)\nEffect.Queues.get(Object.isString(this.options.queue)?\n'global':this.options.queue.scope).remove(this);\nthis.state='finished';\n},\nevent:function(eventName){\nif(this.options[eventName+'Internal'])this.options[eventName+'Internal'](this);\nif(this.options[eventName])this.options[eventName](this);\n},\ninspect:function(){\nvar data=$H();\nfor(property in this)\nif(!Object.isFunction(this[property]))data.set(property,this[property]);\nreturn '#<Effect:'+data.inspect()+',options:'+$H(this.options).inspect()+'>';\n}\n});\nEffect.Parallel=Class.create(Effect.Base,{\ninitialize:function(effects){\nthis.effects=effects||[];\nthis.start(arguments[1]);\n},\nupdate:function(position){\nthis.effects.invoke('render',position);\n},\nfinish:function(position){\nthis.effects.each(function(effect){\neffect.render(1.0);\neffect.cancel();\neffect.event('beforeFinish');\nif(effect.finish)effect.finish(position);\neffect.event('afterFinish');\n});\n}\n});\nEffect.Tween=Class.create(Effect.Base,{\ninitialize:function(object,from,to){\nobject=Object.isString(object)?$(object):object;\nvar args=$A(arguments),method=args.last(),\noptions=args.length==5?args[3]:null;\nthis.method=Object.isFunction(method)?method.bind(object):\nObject.isFunction(object[method])?object[method].bind(object):\nfunction(value){object[method]=value};\nthis.start(Object.extend({from:from,to:to},options||{}));\n},\nupdate:function(position){\nthis.method(position);\n}\n});\nEffect.Event=Class.create(Effect.Base,{\ninitialize:function(){\nthis.start(Object.extend({duration:0},arguments[0]||{}));\n},\nupdate:Prototype.emptyFunction\n});\nEffect.Opacity=Class.create(Effect.Base,{\ninitialize:function(element){\nthis.element=$(element);\nif(!this.element)throw(Effect._elementDoesNotExistError);\nif(Prototype.Browser.IE&&(!this.element.currentStyle.hasLayout))\nthis.element.setStyle({zoom:1});\nvar options=Object.extend({\nfrom:this.element.getOpacity()||0.0,\nto:1.0\n},arguments[1]||{});\nthis.start(options);\n},\nupdate:function(position){\nthis.element.setOpacity(position);\n}\n});\nEffect.Move=Class.create(Effect.Base,{\ninitialize:function(element){\nthis.element=$(element);\nif(!this.element)throw(Effect._elementDoesNotExistError);\nvar options=Object.extend({\nx:0,\ny:0,\nmode:'relative'\n},arguments[1]||{});\nthis.start(options);\n},\nsetup:function(){\nthis.element.makePositioned();\nthis.originalLeft=parseFloat(this.element.getStyle('left')||'0');\nthis.originalTop=parseFloat(this.element.getStyle('top')||'0');\nif(this.options.mode=='absolute'){\nthis.options.x=this.options.x-this.originalLeft;\nthis.options.y=this.options.y-this.originalTop;\n}\n},\nupdate:function(position){\nthis.element.setStyle({\nleft:(this.options.x*position+this.originalLeft).round()+'px',\ntop:(this.options.y*position+this.originalTop).round()+'px'\n});\n}\n});\nEffect.MoveBy=function(element,toTop,toLeft){\nreturn new Effect.Move(element,\nObject.extend({x:toLeft,y:toTop},arguments[3]||{}));\n};\nEffect.Scale=Class.create(Effect.Base,{\ninitialize:function(element,percent){\nthis.element=$(element);\nif(!this.element)throw(Effect._elementDoesNotExistError);\nvar options=Object.extend({\nscaleX:true,\nscaleY:true,\nscaleContent:true,\nscaleFromCenter:false,\nscaleMode:'box',\nscaleFrom:100.0,\nscaleTo:percent\n},arguments[2]||{});\nthis.start(options);\n},\nsetup:function(){\nthis.restoreAfterFinish=this.options.restoreAfterFinish||false;\nthis.elementPositioning=this.element.getStyle('position');\nthis.originalStyle={};\n['top','left','width','height','fontSize'].each(function(k){\nthis.originalStyle[k]=this.element.style[k];\n}.bind(this));\nthis.originalTop=this.element.offsetTop;\nthis.originalLeft=this.element.offsetLeft;\nvar fontSize=this.element.getStyle('font-size')||'100%';\n['em','px','%','pt'].each(function(fontSizeType){\nif(fontSize.indexOf(fontSizeType)>0){\nthis.fontSize=parseFloat(fontSize);\nthis.fontSizeType=fontSizeType;\n}\n}.bind(this));\nthis.factor=(this.options.scaleTo-this.options.scaleFrom)/100;\nthis.dims=null;\nif(this.options.scaleMode=='box')\nthis.dims=[this.element.offsetHeight,this.element.offsetWidth];\nif(/^content/.test(this.options.scaleMode))\nthis.dims=[this.element.scrollHeight,this.element.scrollWidth];\nif(!this.dims)\nthis.dims=[this.options.scaleMode.originalHeight,\nthis.options.scaleMode.originalWidth];\n},\nupdate:function(position){\nvar currentScale=(this.options.scaleFrom/100.0)+(this.factor*position);\nif(this.options.scaleContent&&this.fontSize)\nthis.element.setStyle({fontSize:this.fontSize*currentScale+this.fontSizeType});\nthis.setDimensions(this.dims[0]*currentScale,this.dims[1]*currentScale);\n},\nfinish:function(position){\nif(this.restoreAfterFinish)this.element.setStyle(this.originalStyle);\n},\nsetDimensions:function(height,width){\nvar d={};\nif(this.options.scaleX)d.width=width.round()+'px';\nif(this.options.scaleY)d.height=height.round()+'px';\nif(this.options.scaleFromCenter){\nvar topd=(height-this.dims[0])/2;\nvar leftd=(width-this.dims[1])/2;\nif(this.elementPositioning=='absolute'){\nif(this.options.scaleY)d.top=this.originalTop-topd+'px';\nif(this.options.scaleX)d.left=this.originalLeft-leftd+'px';\n}else{\nif(this.options.scaleY)d.top=-topd+'px';\nif(this.options.scaleX)d.left=-leftd+'px';\n}\n}\nthis.element.setStyle(d);\n}\n});\nEffect.Highlight=Class.create(Effect.Base,{\ninitialize:function(element){\nthis.element=$(element);\nif(!this.element)throw(Effect._elementDoesNotExistError);\nvar options=Object.extend({startcolor:'#ffff99'},arguments[1]||{});\nthis.start(options);\n},\nsetup:function(){\nif(this.element.getStyle('display')=='none'){this.cancel();return;}\nthis.oldStyle={};\nif(!this.options.keepBackgroundImage){\nthis.oldStyle.backgroundImage=this.element.getStyle('background-image');\nthis.element.setStyle({backgroundImage:'none'});\n}\nif(!this.options.endcolor)\nthis.options.endcolor=this.element.getStyle('background-color').parseColor('#ffffff');\nif(!this.options.restorecolor)\nthis.options.restorecolor=this.element.getStyle('background-color');\nthis._base=$R(0,2).map(function(i){return parseInt(this.options.startcolor.slice(i*2+1,i*2+3),16)}.bind(this));\nthis._delta=$R(0,2).map(function(i){return parseInt(this.options.endcolor.slice(i*2+1,i*2+3),16)-this._base[i]}.bind(this));\n},\nupdate:function(position){\nthis.element.setStyle({backgroundColor:$R(0,2).inject('#',function(m,v,i){\nreturn m+((this._base[i]+(this._delta[i]*position)).round().toColorPart());}.bind(this))});\n},\nfinish:function(){\nthis.element.setStyle(Object.extend(this.oldStyle,{\nbackgroundColor:this.options.restorecolor\n}));\n}\n});\nEffect.ScrollTo=function(element){\nvar options=arguments[1]||{},\nscrollOffsets=document.viewport.getScrollOffsets(),\nelementOffsets=$(element).cumulativeOffset();\nif(options.offset)elementOffsets[1]+=options.offset;\nreturn new Effect.Tween(null,\nscrollOffsets.top,\nelementOffsets[1],\noptions,\nfunction(p){scrollTo(scrollOffsets.left,p.round());}\n);\n};\nEffect.Fade=function(element){\nelement=$(element);\nvar oldOpacity=element.getInlineOpacity();\nvar options=Object.extend({\nfrom:element.getOpacity()||1.0,\nto:0.0,\nafterFinishInternal:function(effect){\nif(effect.options.to!=0)return;\neffect.element.hide().setStyle({opacity:oldOpacity});\n}\n},arguments[1]||{});\nreturn new Effect.Opacity(element,options);\n};\nEffect.Appear=function(element){\nelement=$(element);\nvar options=Object.extend({\nfrom:(element.getStyle('display')=='none'?0.0:element.getOpacity()||0.0),\nto:1.0,\nafterFinishInternal:function(effect){\neffect.element.forceRerendering();\n},\nbeforeSetup:function(effect){\neffect.element.setOpacity(effect.options.from).show();\n}},arguments[1]||{});\nreturn new Effect.Opacity(element,options);\n};\nEffect.Puff=function(element){\nelement=$(element);\nvar oldStyle={\nopacity:element.getInlineOpacity(),\nposition:element.getStyle('position'),\ntop:element.style.top,\nleft:element.style.left,\nwidth:element.style.width,\nheight:element.style.height\n};\nreturn new Effect.Parallel(\n[new Effect.Scale(element,200,\n{sync:true,scaleFromCenter:true,scaleContent:true,restoreAfterFinish:true}),\nnew Effect.Opacity(element,{sync:true,to:0.0})],\nObject.extend({duration:1.0,\nbeforeSetupInternal:function(effect){\nPosition.absolutize(effect.effects[0].element);\n},\nafterFinishInternal:function(effect){\neffect.effects[0].element.hide().setStyle(oldStyle);}\n},arguments[1]||{})\n);\n};\nEffect.BlindUp=function(element){\nelement=$(element);\nelement.makeClipping();\nreturn new Effect.Scale(element,0,\nObject.extend({scaleContent:false,\nscaleX:false,\nrestoreAfterFinish:true,\nafterFinishInternal:function(effect){\neffect.element.hide().undoClipping();\n}\n},arguments[1]||{})\n);\n};\nEffect.BlindDown=function(element){\nelement=$(element);\nvar elementDimensions=element.getDimensions();\nreturn new Effect.Scale(element,100,Object.extend({\nscaleContent:false,\nscaleX:false,\nscaleFrom:0,\nscaleMode:{originalHeight:elementDimensions.height,originalWidth:elementDimensions.width},\nrestoreAfterFinish:true,\nafterSetup:function(effect){\neffect.element.makeClipping().setStyle({height:'0px'}).show();\n},\nafterFinishInternal:function(effect){\neffect.element.undoClipping();\n}\n},arguments[1]||{}));\n};\nEffect.SwitchOff=function(element){\nelement=$(element);\nvar oldOpacity=element.getInlineOpacity();\nreturn new Effect.Appear(element,Object.extend({\nduration:0.4,\nfrom:0,\ntransition:Effect.Transitions.flicker,\nafterFinishInternal:function(effect){\nnew Effect.Scale(effect.element,1,{\nduration:0.3,scaleFromCenter:true,\nscaleX:false,scaleContent:false,restoreAfterFinish:true,\nbeforeSetup:function(effect){\neffect.element.makePositioned().makeClipping();\n},\nafterFinishInternal:function(effect){\neffect.element.hide().undoClipping().undoPositioned().setStyle({opacity:oldOpacity});\n}\n});\n}\n},arguments[1]||{}));\n};\nEffect.DropOut=function(element){\nelement=$(element);\nvar oldStyle={\ntop:element.getStyle('top'),\nleft:element.getStyle('left'),\nopacity:element.getInlineOpacity()};\nreturn new Effect.Parallel(\n[new Effect.Move(element,{x:0,y:100,sync:true}),\nnew Effect.Opacity(element,{sync:true,to:0.0})],\nObject.extend(\n{duration:0.5,\nbeforeSetup:function(effect){\neffect.effects[0].element.makePositioned();\n},\nafterFinishInternal:function(effect){\neffect.effects[0].element.hide().undoPositioned().setStyle(oldStyle);\n}\n},arguments[1]||{}));\n};\nEffect.Shake=function(element){\nelement=$(element);\nvar options=Object.extend({\ndistance:20,\nduration:0.5\n},arguments[1]||{});\nvar distance=parseFloat(options.distance);\nvar split=parseFloat(options.duration)/10.0;\nvar oldStyle={\ntop:element.getStyle('top'),\nleft:element.getStyle('left')};\nreturn new Effect.Move(element,\n{x:distance,y:0,duration:split,afterFinishInternal:function(effect){\nnew Effect.Move(effect.element,\n{x:-distance*2,y:0,duration:split*2,afterFinishInternal:function(effect){\nnew Effect.Move(effect.element,\n{x:distance*2,y:0,duration:split*2,afterFinishInternal:function(effect){\nnew Effect.Move(effect.element,\n{x:-distance*2,y:0,duration:split*2,afterFinishInternal:function(effect){\nnew Effect.Move(effect.element,\n{x:distance*2,y:0,duration:split*2,afterFinishInternal:function(effect){\nnew Effect.Move(effect.element,\n{x:-distance,y:0,duration:split,afterFinishInternal:function(effect){\neffect.element.undoPositioned().setStyle(oldStyle);\n}});}});}});}});}});}});\n};\nEffect.SlideDown=function(element){\nelement=$(element).cleanWhitespace();\nvar oldInnerBottom=element.down().getStyle('bottom');\nvar elementDimensions=element.getDimensions();\nreturn new Effect.Scale(element,100,Object.extend({\nscaleContent:false,\nscaleX:false,\nscaleFrom:window.opera?0:1,\nscaleMode:{originalHeight:elementDimensions.height,originalWidth:elementDimensions.width},\nrestoreAfterFinish:true,\nafterSetup:function(effect){\neffect.element.makePositioned();\neffect.element.down().makePositioned();\nif(window.opera)effect.element.setStyle({top:''});\neffect.element.makeClipping().setStyle({height:'0px'}).show();\n},\nafterUpdateInternal:function(effect){\neffect.element.down().setStyle({bottom:\n(effect.dims[0]-effect.element.clientHeight)+'px'});\n},\nafterFinishInternal:function(effect){\neffect.element.undoClipping().undoPositioned();\neffect.element.down().undoPositioned().setStyle({bottom:oldInnerBottom});}\n},arguments[1]||{})\n);\n};\nEffect.SlideUp=function(element){\nelement=$(element).cleanWhitespace();\nvar oldInnerBottom=element.down().getStyle('bottom');\nvar elementDimensions=element.getDimensions();\nreturn new Effect.Scale(element,window.opera?0:1,\nObject.extend({scaleContent:false,\nscaleX:false,\nscaleMode:'box',\nscaleFrom:100,\nscaleMode:{originalHeight:elementDimensions.height,originalWidth:elementDimensions.width},\nrestoreAfterFinish:true,\nafterSetup:function(effect){\neffect.element.makePositioned();\neffect.element.down().makePositioned();\nif(window.opera)effect.element.setStyle({top:''});\neffect.element.makeClipping().show();\n},\nafterUpdateInternal:function(effect){\neffect.element.down().setStyle({bottom:\n(effect.dims[0]-effect.element.clientHeight)+'px'});\n},\nafterFinishInternal:function(effect){\neffect.element.hide().undoClipping().undoPositioned();\neffect.element.down().undoPositioned().setStyle({bottom:oldInnerBottom});\n}\n},arguments[1]||{})\n);\n};\nEffect.Squish=function(element){\nreturn new Effect.Scale(element,window.opera?1:0,{\nrestoreAfterFinish:true,\nbeforeSetup:function(effect){\neffect.element.makeClipping();\n},\nafterFinishInternal:function(effect){\neffect.element.hide().undoClipping();\n}\n});\n};\nEffect.Grow=function(element){\nelement=$(element);\nvar options=Object.extend({\ndirection:'center',\nmoveTransition:Effect.Transitions.sinoidal,\nscaleTransition:Effect.Transitions.sinoidal,\nopacityTransition:Effect.Transitions.full\n},arguments[1]||{});\nvar oldStyle={\ntop:element.style.top,\nleft:element.style.left,\nheight:element.style.height,\nwidth:element.style.width,\nopacity:element.getInlineOpacity()};\nvar dims=element.getDimensions();\nvar initialMoveX,initialMoveY;\nvar moveX,moveY;\nswitch(options.direction){\ncase 'top-left':\ninitialMoveX=initialMoveY=moveX=moveY=0;\nbreak;\ncase 'top-right':\ninitialMoveX=dims.width;\ninitialMoveY=moveY=0;\nmoveX=-dims.width;\nbreak;\ncase 'bottom-left':\ninitialMoveX=moveX=0;\ninitialMoveY=dims.height;\nmoveY=-dims.height;\nbreak;\ncase 'bottom-right':\ninitialMoveX=dims.width;\ninitialMoveY=dims.height;\nmoveX=-dims.width;\nmoveY=-dims.height;\nbreak;\ncase 'center':\ninitialMoveX=dims.width/2;\ninitialMoveY=dims.height/2;\nmoveX=-dims.width/2;\nmoveY=-dims.height/2;\nbreak;\n}\nreturn new Effect.Move(element,{\nx:initialMoveX,\ny:initialMoveY,\nduration:0.01,\nbeforeSetup:function(effect){\neffect.element.hide().makeClipping().makePositioned();\n},\nafterFinishInternal:function(effect){\nnew Effect.Parallel(\n[new Effect.Opacity(effect.element,{sync:true,to:1.0,from:0.0,transition:options.opacityTransition}),\nnew Effect.Move(effect.element,{x:moveX,y:moveY,sync:true,transition:options.moveTransition}),\nnew Effect.Scale(effect.element,100,{\nscaleMode:{originalHeight:dims.height,originalWidth:dims.width},\nsync:true,scaleFrom:window.opera?1:0,transition:options.scaleTransition,restoreAfterFinish:true})\n],Object.extend({\nbeforeSetup:function(effect){\neffect.effects[0].element.setStyle({height:'0px'}).show();\n},\nafterFinishInternal:function(effect){\neffect.effects[0].element.undoClipping().undoPositioned().setStyle(oldStyle);\n}\n},options)\n);\n}\n});\n};\nEffect.Shrink=function(element){\nelement=$(element);\nvar options=Object.extend({\ndirection:'center',\nmoveTransition:Effect.Transitions.sinoidal,\nscaleTransition:Effect.Transitions.sinoidal,\nopacityTransition:Effect.Transitions.none\n},arguments[1]||{});\nvar oldStyle={\ntop:element.style.top,\nleft:element.style.left,\nheight:element.style.height,\nwidth:element.style.width,\nopacity:element.getInlineOpacity()};\nvar dims=element.getDimensions();\nvar moveX,moveY;\nswitch(options.direction){\ncase 'top-left':\nmoveX=moveY=0;\nbreak;\ncase 'top-right':\nmoveX=dims.width;\nmoveY=0;\nbreak;\ncase 'bottom-left':\nmoveX=0;\nmoveY=dims.height;\nbreak;\ncase 'bottom-right':\nmoveX=dims.width;\nmoveY=dims.height;\nbreak;\ncase 'center':\nmoveX=dims.width/2;\nmoveY=dims.height/2;\nbreak;\n}\nreturn new Effect.Parallel(\n[new Effect.Opacity(element,{sync:true,to:0.0,from:1.0,transition:options.opacityTransition}),\nnew Effect.Scale(element,window.opera?1:0,{sync:true,transition:options.scaleTransition,restoreAfterFinish:true}),\nnew Effect.Move(element,{x:moveX,y:moveY,sync:true,transition:options.moveTransition})\n],Object.extend({\nbeforeStartInternal:function(effect){\neffect.effects[0].element.makePositioned().makeClipping();\n},\nafterFinishInternal:function(effect){\neffect.effects[0].element.hide().undoClipping().undoPositioned().setStyle(oldStyle);}\n},options)\n);\n};\nEffect.Pulsate=function(element){\nelement=$(element);\nvar options=arguments[1]||{},\noldOpacity=element.getInlineOpacity(),\ntransition=options.transition||Effect.Transitions.linear,\nreverser=function(pos){\nreturn 1-transition((-Math.cos((pos*(options.pulses||5)*2)*Math.PI)/2)+.5);\n};\nreturn new Effect.Opacity(element,\nObject.extend(Object.extend({duration:2.0,from:0,\nafterFinishInternal:function(effect){effect.element.setStyle({opacity:oldOpacity});}\n},options),{transition:reverser}));\n};\nEffect.Fold=function(element){\nelement=$(element);\nvar oldStyle={\ntop:element.style.top,\nleft:element.style.left,\nwidth:element.style.width,\nheight:element.style.height};\nelement.makeClipping();\nreturn new Effect.Scale(element,5,Object.extend({\nscaleContent:false,\nscaleX:false,\nafterFinishInternal:function(effect){\nnew Effect.Scale(element,1,{\nscaleContent:false,\nscaleY:false,\nafterFinishInternal:function(effect){\neffect.element.hide().undoClipping().setStyle(oldStyle);\n}});\n}},arguments[1]||{}));\n};\nEffect.Morph=Class.create(Effect.Base,{\ninitialize:function(element){\nthis.element=$(element);\nif(!this.element)throw(Effect._elementDoesNotExistError);\nvar options=Object.extend({\nstyle:{}\n},arguments[1]||{});\nif(!Object.isString(options.style))this.style=$H(options.style);\nelse{\nif(options.style.include(':'))\nthis.style=options.style.parseStyle();\nelse{\nthis.element.addClassName(options.style);\nthis.style=$H(this.element.getStyles());\nthis.element.removeClassName(options.style);\nvar css=this.element.getStyles();\nthis.style=this.style.reject(function(style){\nreturn style.value==css[style.key];\n});\noptions.afterFinishInternal=function(effect){\neffect.element.addClassName(effect.options.style);\neffect.transforms.each(function(transform){\neffect.element.style[transform.style]='';\n});\n};\n}\n}\nthis.start(options);\n},\nsetup:function(){\nfunction parseColor(color){\nif(!color||['rgba(0, 0, 0, 0)','transparent'].include(color))color='#ffffff';\ncolor=color.parseColor();\nreturn $R(0,2).map(function(i){\nreturn parseInt(color.slice(i*2+1,i*2+3),16);\n});\n}\nthis.transforms=this.style.map(function(pair){\nvar property=pair[0],value=pair[1],unit=null;\nif(value.parseColor('#zzzzzz')!='#zzzzzz'){\nvalue=value.parseColor();\nunit='color';\n}else if(property=='opacity'){\nvalue=parseFloat(value);\nif(Prototype.Browser.IE&&(!this.element.currentStyle.hasLayout))\nthis.element.setStyle({zoom:1});\n}else if(Element.CSS_LENGTH.test(value)){\nvar components=value.match(/^([\\+\\-]?[0-9\\.]+)(.*)$/);\nvalue=parseFloat(components[1]);\nunit=(components.length==3)?components[2]:null;\n}\nvar originalValue=this.element.getStyle(property);\nreturn{\nstyle:property.camelize(),\noriginalValue:unit=='color'?parseColor(originalValue):parseFloat(originalValue||0),\ntargetValue:unit=='color'?parseColor(value):value,\nunit:unit\n};\n}.bind(this)).reject(function(transform){\nreturn(\n(transform.originalValue==transform.targetValue)||\n(\ntransform.unit!='color'&&\n(isNaN(transform.originalValue)||isNaN(transform.targetValue))\n)\n);\n});\n},\nupdate:function(position){\nvar style={},transform,i=this.transforms.length;\nwhile(i--)\nstyle[(transform=this.transforms[i]).style]=\ntransform.unit=='color'?'#'+\n(Math.round(transform.originalValue[0]+\n(transform.targetValue[0]-transform.originalValue[0])*position)).toColorPart()+\n(Math.round(transform.originalValue[1]+\n(transform.targetValue[1]-transform.originalValue[1])*position)).toColorPart()+\n(Math.round(transform.originalValue[2]+\n(transform.targetValue[2]-transform.originalValue[2])*position)).toColorPart():\n(transform.originalValue+\n(transform.targetValue-transform.originalValue)*position).toFixed(3)+\n(transform.unit===null?'':transform.unit);\nthis.element.setStyle(style,true);\n}\n});\nEffect.Transform=Class.create({\ninitialize:function(tracks){\nthis.tracks=[];\nthis.options=arguments[1]||{};\nthis.addTracks(tracks);\n},\naddTracks:function(tracks){\ntracks.each(function(track){\ntrack=$H(track);\nvar data=track.values().first();\nthis.tracks.push($H({\nids:track.keys().first(),\neffect:Effect.Morph,\noptions:{style:data}\n}));\n}.bind(this));\nreturn this;\n},\nplay:function(){\nreturn new Effect.Parallel(\nthis.tracks.map(function(track){\nvar ids=track.get('ids'),effect=track.get('effect'),options=track.get('options');\nvar elements=[$(ids)||$$(ids)].flatten();\nreturn elements.map(function(e){return new effect(e,Object.extend({sync:true},options))});\n}).flatten(),\nthis.options\n);\n}\n});\nElement.CSS_PROPERTIES=$w(\n'backgroundColor backgroundPosition borderBottomColor borderBottomStyle '+\n'borderBottomWidth borderLeftColor borderLeftStyle borderLeftWidth '+\n'borderRightColor borderRightStyle borderRightWidth borderSpacing '+\n'borderTopColor borderTopStyle borderTopWidth bottom clip color '+\n'fontSize fontWeight height left letterSpacing lineHeight '+\n'marginBottom marginLeft marginRight marginTop markerOffset maxHeight '+\n'maxWidth minHeight minWidth opacity outlineColor outlineOffset '+\n'outlineWidth paddingBottom paddingLeft paddingRight paddingTop '+\n'right textIndent top width wordSpacing zIndex');\nElement.CSS_LENGTH=/^(([\\+\\-]?[0-9\\.]+)(em|ex|px|in|cm|mm|pt|pc|\\%))|0$/;\nString.__parseStyleElement=document.createElement('div');\nString.prototype.parseStyle=function(){\nvar style,styleRules=$H();\nif(Prototype.Browser.WebKit)\nstyle=new Element('div',{style:this}).style;\nelse{\nString.__parseStyleElement.innerHTML='<div style=\"'+this +'\"></div>';\nstyle=String.__parseStyleElement.childNodes[0].style;\n}\nElement.CSS_PROPERTIES.each(function(property){\nif(style[property])styleRules.set(property,style[property]);\n});\nif(Prototype.Browser.IE&&this.include('opacity'))\nstyleRules.set('opacity',this.match(/opacity:\\s*((?:0|1)?(?:\\.\\d*)?)/)[1]);\nreturn styleRules;\n};\nif(document.defaultView&&document.defaultView.getComputedStyle){\nElement.getStyles=function(element){\nvar css=document.defaultView.getComputedStyle($(element),null);\nreturn Element.CSS_PROPERTIES.inject({},function(styles,property){\nstyles[property]=css[property];\nreturn styles;\n});\n};\n}else{\nElement.getStyles=function(element){\nelement=$(element);\nvar css=element.currentStyle,styles;\nstyles=Element.CSS_PROPERTIES.inject({},function(results,property){\nresults[property]=css[property];\nreturn results;\n});\nif(!styles.opacity)styles.opacity=element.getOpacity();\nreturn styles;\n};\n}\nEffect.Methods={\nmorph:function(element,style){\nelement=$(element);\nnew Effect.Morph(element,Object.extend({style:style},arguments[2]||{}));\nreturn element;\n},\nvisualEffect:function(element,effect,options){\nelement=$(element);\nvar s=effect.dasherize().camelize(),klass=s.charAt(0).toUpperCase()+s.substring(1);\nnew Effect[klass](element,options);\nreturn element;\n},\nhighlight:function(element,options){\nelement=$(element);\nnew Effect.Highlight(element,options);\nreturn element;\n}\n};\n$w('fade appear grow shrink fold blindUp blindDown slideUp slideDown '+\n'pulsate shake puff squish switchOff dropOut').each(\nfunction(effect){\nEffect.Methods[effect]=function(element,options){\nelement=$(element);\nEffect[effect.charAt(0).toUpperCase()+effect.substring(1)](element,options);\nreturn element;\n};\n}\n);\n$w('getInlineOpacity forceRerendering setContentZoom collectTextNodes collectTextNodesIgnoreClass getStyles').each(\nfunction(f){Effect.Methods[f]=Element[f];}\n);\nElement.addMethods(Effect.Methods);\nif(typeof Effect=='undefined')\nthrow(\"controls.js requires including script.aculo.us' effects.js library\");\nvar Autocompleter={};\nAutocompleter.Base=Class.create({\nbaseInitialize:function(element,update,options){\nelement=$(element);\nthis.element=element;\nthis.update=$(update);\nthis.hasFocus=false;\nthis.changed=false;\nthis.active=false;\nthis.index=0;\nthis.entryCount=0;\nthis.oldElementValue=this.element.value;\nif(this.setOptions)\nthis.setOptions(options);\nelse\nthis.options=options||{};\nthis.options.paramName=this.options.paramName||this.element.name;\nthis.options.tokens=this.options.tokens||[];\nthis.options.frequency=this.options.frequency||0.4;\nthis.options.minChars=this.options.minChars||1;\nthis.options.onShow=this.options.onShow||\nfunction(element,update){\nif(!update.style.position||update.style.position=='absolute'){\nupdate.style.position='absolute';\nPosition.clone(element,update,{\nsetHeight:false,\noffsetTop:element.offsetHeight\n});\n}\nEffect.Appear(update,{duration:0.15});\n};\nthis.options.onHide=this.options.onHide||\nfunction(element,update){new Effect.Fade(update,{duration:0.15})};\nif(typeof(this.options.tokens)=='string')\nthis.options.tokens=new Array(this.options.tokens);\nif(!this.options.tokens.include('\\n'))\nthis.options.tokens.push('\\n');\nthis.observer=null;\nthis.element.setAttribute('autocomplete','off');\nElement.hide(this.update);\nEvent.observe(this.element,'blur',this.onBlur.bindAsEventListener(this));\nEvent.observe(this.element,'keydown',this.onKeyPress.bindAsEventListener(this));\n},\nshow:function(){\nif(Element.getStyle(this.update,'display')=='none')this.options.onShow(this.element,this.update);\nif(!this.iefix&&\n(Prototype.Browser.IE)&&\n(Element.getStyle(this.update,'position')=='absolute')){\nnew Insertion.After(this.update,\n'<iframe id=\"'+this.update.id+'_iefix\" '+\n'style=\"display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);\" '+\n'src=\"javascript:false;\" frameborder=\"0\" scrolling=\"no\"></iframe>');\nthis.iefix=$(this.update.id+'_iefix');\n}\nif(this.iefix)setTimeout(this.fixIEOverlapping.bind(this),50);\n},\nfixIEOverlapping:function(){\nPosition.clone(this.update,this.iefix,{setTop:(!this.update.style.height)});\nthis.iefix.style.zIndex=1;\nthis.update.style.zIndex=2;\nElement.show(this.iefix);\n},\nhide:function(){\nthis.stopIndicator();\nif(Element.getStyle(this.update,'display')!='none')this.options.onHide(this.element,this.update);\nif(this.iefix)Element.hide(this.iefix);\n},\nstartIndicator:function(){\nif(this.options.indicator)Element.show(this.options.indicator);\n},\nstopIndicator:function(){\nif(this.options.indicator)Element.hide(this.options.indicator);\n},\nonKeyPress:function(event){\nif(this.active)\nswitch(event.keyCode){\ncase Event.KEY_TAB:\ncase Event.KEY_RETURN:\nthis.selectEntry();\nEvent.stop(event);\ncase Event.KEY_ESC:\nthis.hide();\nthis.active=false;\nEvent.stop(event);\nreturn;\ncase Event.KEY_LEFT:\ncase Event.KEY_RIGHT:\nreturn;\ncase Event.KEY_UP:\nthis.markPrevious();\nthis.render();\nEvent.stop(event);\nreturn;\ncase Event.KEY_DOWN:\nthis.markNext();\nthis.render();\nEvent.stop(event);\nreturn;\n}\nelse\nif(event.keyCode==Event.KEY_TAB||event.keyCode==Event.KEY_RETURN||\n(Prototype.Browser.WebKit>0&&event.keyCode==0))return;\nthis.changed=true;\nthis.hasFocus=true;\nif(this.observer)clearTimeout(this.observer);\nthis.observer=\nsetTimeout(this.onObserverEvent.bind(this),this.options.frequency*1000);\n},\nactivate:function(){\nthis.changed=false;\nthis.hasFocus=true;\nthis.getUpdatedChoices();\n},\nonHover:function(event){\nvar element=Event.findElement(event,'LI');\nif(this.index!=element.autocompleteIndex)\n{\nthis.index=element.autocompleteIndex;\nthis.render();\n}\nEvent.stop(event);\n},\nonClick:function(event){\nvar element=Event.findElement(event,'LI');\nthis.index=element.autocompleteIndex;\nthis.selectEntry();\nthis.hide();\n},\nonBlur:function(event){\nsetTimeout(this.hide.bind(this),250);\nthis.hasFocus=false;\nthis.active=false;\n},\nrender:function(){\nif(this.entryCount>0){\nfor(var i=0;i<this.entryCount;i++)\nthis.index==i?\nElement.addClassName(this.getEntry(i),\"selected\"):\nElement.removeClassName(this.getEntry(i),\"selected\");\nif(this.hasFocus){\nthis.show();\nthis.active=true;\n}\n}else{\nthis.active=false;\nthis.hide();\n}\n},\nmarkPrevious:function(){\nif(this.index>0)this.index--;\nelse this.index=this.entryCount-1;\nthis.getEntry(this.index).scrollIntoView(true);\n},\nmarkNext:function(){\nif(this.index<this.entryCount-1)this.index++;\nelse this.index=0;\nthis.getEntry(this.index).scrollIntoView(false);\n},\ngetEntry:function(index){\nreturn this.update.firstChild.childNodes[index];\n},\ngetCurrentEntry:function(){\nreturn this.getEntry(this.index);\n},\nselectEntry:function(){\nthis.active=false;\nthis.updateElement(this.getCurrentEntry());\n},\nupdateElement:function(selectedElement){\nif(this.options.updateElement){\nthis.options.updateElement(selectedElement);\nreturn;\n}\nvar value='';\nif(this.options.select){\nvar nodes=$(selectedElement).select('.'+this.options.select)||[];\nif(nodes.length>0)value=Element.collectTextNodes(nodes[0],this.options.select);\n}else\nvalue=Element.collectTextNodesIgnoreClass(selectedElement,'informal');\nvar bounds=this.getTokenBounds();\nif(bounds[0]!=-1){\nvar newValue=this.element.value.substr(0,bounds[0]);\nvar whitespace=this.element.value.substr(bounds[0]).match(/^\\s+/);\nif(whitespace)\nnewValue+=whitespace[0];\nthis.element.value=newValue+value+this.element.value.substr(bounds[1]);\n}else{\nthis.element.value=value;\n}\nthis.oldElementValue=this.element.value;\nthis.element.focus();\nif(this.options.afterUpdateElement)\nthis.options.afterUpdateElement(this.element,selectedElement);\n},\nupdateChoices:function(choices){\nif(!this.changed&&this.hasFocus){\nthis.update.innerHTML=choices;\nElement.cleanWhitespace(this.update);\nElement.cleanWhitespace(this.update.down());\nif(this.update.firstChild&&this.update.down().childNodes){\nthis.entryCount=\nthis.update.down().childNodes.length;\nfor(var i=0;i<this.entryCount;i++){\nvar entry=this.getEntry(i);\nentry.autocompleteIndex=i;\nthis.addObservers(entry);\n}\n}else{\nthis.entryCount=0;\n}\nthis.stopIndicator();\nthis.index=0;\nif(this.entryCount==1&&this.options.autoSelect){\nthis.selectEntry();\nthis.hide();\n}else{\nthis.render();\n}\n}\n},\naddObservers:function(element){\nEvent.observe(element,\"mouseover\",this.onHover.bindAsEventListener(this));\nEvent.observe(element,\"click\",this.onClick.bindAsEventListener(this));\n},\nonObserverEvent:function(){\nthis.changed=false;\nthis.tokenBounds=null;\nif(this.getToken().length>=this.options.minChars){\nthis.getUpdatedChoices();\n}else{\nthis.active=false;\nthis.hide();\n}\nthis.oldElementValue=this.element.value;\n},\ngetToken:function(){\nvar bounds=this.getTokenBounds();\nreturn this.element.value.substring(bounds[0],bounds[1]).strip();\n},\ngetTokenBounds:function(){\nif(null !=this.tokenBounds)return this.tokenBounds;\nvar value=this.element.value;\nif(value.strip().empty())return[-1,0];\nvar diff=arguments.callee.getFirstDifferencePos(value,this.oldElementValue);\nvar offset=(diff==this.oldElementValue.length?1:0);\nvar prevTokenPos=-1,nextTokenPos=value.length;\nvar tp;\nfor(var index=0,l=this.options.tokens.length;index<l;++index){\ntp=value.lastIndexOf(this.options.tokens[index],diff+offset-1);\nif(tp>prevTokenPos)prevTokenPos=tp;\ntp=value.indexOf(this.options.tokens[index],diff+offset);\nif(-1!=tp&&tp<nextTokenPos)nextTokenPos=tp;\n}\nreturn(this.tokenBounds=[prevTokenPos+1,nextTokenPos]);\n}\n});\nAutocompleter.Base.prototype.getTokenBounds.getFirstDifferencePos=function(newS,oldS){\nvar boundary=Math.min(newS.length,oldS.length);\nfor(var index=0;index<boundary;++index)\nif(newS[index]!=oldS[index])\nreturn index;\nreturn boundary;\n};\nAjax.Autocompleter=Class.create(Autocompleter.Base,{\ninitialize:function(element,update,url,options){\nthis.baseInitialize(element,update,options);\nthis.options.asynchronous=true;\nthis.options.onComplete=this.onComplete.bind(this);\nthis.options.defaultParams=this.options.parameters||null;\nthis.url=url;\n},\ngetUpdatedChoices:function(){\nthis.startIndicator();\nvar entry=encodeURIComponent(this.options.paramName)+'='+\nencodeURIComponent(this.getToken());\nthis.options.parameters=this.options.callback?\nthis.options.callback(this.element,entry):entry;\nif(this.options.defaultParams)\nthis.options.parameters+='&'+this.options.defaultParams;\nnew Ajax.Request(this.url,this.options);\n},\nonComplete:function(request){\nthis.updateChoices(request.responseText);\n}\n});\nAutocompleter.Local=Class.create(Autocompleter.Base,{\ninitialize:function(element,update,array,options){\nthis.baseInitialize(element,update,options);\nthis.options.array=array;\n},\ngetUpdatedChoices:function(){\nthis.updateChoices(this.options.selector(this));\n},\nsetOptions:function(options){\nthis.options=Object.extend({\nchoices:10,\npartialSearch:true,\npartialChars:2,\nignoreCase:true,\nfullSearch:false,\nselector:function(instance){\nvar ret=[];\nvar partial=[];\nvar entry=instance.getToken();\nvar count=0;\nfor(var i=0;i<instance.options.array.length&&\nret.length<instance.options.choices;i++){\nvar elem=instance.options.array[i];\nvar foundPos=instance.options.ignoreCase?\nelem.toLowerCase().indexOf(entry.toLowerCase()):\nelem.indexOf(entry);\nwhile(foundPos!=-1){\nif(foundPos==0&&elem.length!=entry.length){\nret.push(\"<li><strong>\"+elem.substr(0,entry.length)+\"</strong>\"+\nelem.substr(entry.length)+\"</li>\");\nbreak;\n}else if(entry.length>=instance.options.partialChars&&\ninstance.options.partialSearch&&foundPos!=-1){\nif(instance.options.fullSearch||/\\s/.test(elem.substr(foundPos-1,1))){\npartial.push(\"<li>\"+elem.substr(0,foundPos)+\"<strong>\"+\nelem.substr(foundPos,entry.length)+\"</strong>\"+elem.substr(\nfoundPos+entry.length)+\"</li>\");\nbreak;\n}\n}\nfoundPos=instance.options.ignoreCase?\nelem.toLowerCase().indexOf(entry.toLowerCase(),foundPos+1):\nelem.indexOf(entry,foundPos+1);\n}\n}\nif(partial.length)\nret=ret.concat(partial.slice(0,instance.options.choices-ret.length));\nreturn \"<ul>\"+ret.join('')+\"</ul>\";\n}\n},options||{});\n}\n});\nField.scrollFreeActivate=function(field){\nsetTimeout(function(){\nField.activate(field);\n},1);\n};\nAjax.InPlaceEditor=Class.create({\ninitialize:function(element,url,options){\nthis.url=url;\nthis.element=element=$(element);\nthis.prepareOptions();\nthis._controls={};\narguments.callee.dealWithDeprecatedOptions(options);\nObject.extend(this.options,options||{});\nif(!this.options.formId&&this.element.id){\nthis.options.formId=this.element.id+'-inplaceeditor';\nif($(this.options.formId))\nthis.options.formId='';\n}\nif(this.options.externalControl)\nthis.options.externalControl=$(this.options.externalControl);\nif(!this.options.externalControl)\nthis.options.externalControlOnly=false;\nthis._originalBackground=this.element.getStyle('background-color')||'transparent';\nthis.element.title=this.options.clickToEditText;\nthis._boundCancelHandler=this.handleFormCancellation.bind(this);\nthis._boundComplete=(this.options.onComplete||Prototype.emptyFunction).bind(this);\nthis._boundFailureHandler=this.handleAJAXFailure.bind(this);\nthis._boundSubmitHandler=this.handleFormSubmission.bind(this);\nthis._boundWrapperHandler=this.wrapUp.bind(this);\nthis.registerListeners();\n},\ncheckForEscapeOrReturn:function(e){\nif(!this._editing||e.ctrlKey||e.altKey||e.shiftKey)return;\nif(Event.KEY_ESC==e.keyCode)\nthis.handleFormCancellation(e);\nelse if(Event.KEY_RETURN==e.keyCode)\nthis.handleFormSubmission(e);\n},\ncreateControl:function(mode,handler,extraClasses){\nvar control=this.options[mode+'Control'];\nvar text=this.options[mode+'Text'];\nif('button'==control){\nvar btn=document.createElement('input');\nbtn.type='submit';\nbtn.value=text;\nbtn.className='editor_'+mode+'_button';\nif('cancel'==mode)\nbtn.onclick=this._boundCancelHandler;\nthis._form.appendChild(btn);\nthis._controls[mode]=btn;\n}else if('link'==control){\nvar link=document.createElement('a');\nlink.href='#';\nlink.appendChild(document.createTextNode(text));\nlink.onclick='cancel'==mode?this._boundCancelHandler:this._boundSubmitHandler;\nlink.className='editor_'+mode+'_link';\nif(extraClasses)\nlink.className+=' '+extraClasses;\nthis._form.appendChild(link);\nthis._controls[mode]=link;\n}\n},\ncreateEditField:function(){\nvar text=(this.options.loadTextURL?this.options.loadingText:this.getText());\nvar fld;\nif(1>=this.options.rows&&!/\\r|\\n/.test(this.getText())){\nfld=document.createElement('input');\nfld.type='text';\nvar size=this.options.size||this.options.cols||0;\nif(0<size)fld.size=size;\n}else{\nfld=document.createElement('textarea');\nfld.rows=(1>=this.options.rows?this.options.autoRows:this.options.rows);\nfld.cols=this.options.cols||40;\n}\nfld.name=this.options.paramName;\nfld.value=text;\nfld.className='editor_field';\nif(this.options.submitOnBlur)\nfld.onblur=this._boundSubmitHandler;\nthis._controls.editor=fld;\nif(this.options.loadTextURL)\nthis.loadExternalText();\nthis._form.appendChild(this._controls.editor);\n},\ncreateForm:function(){\nvar ipe=this;\nfunction addText(mode,condition){\nvar text=ipe.options['text'+mode+'Controls'];\nif(!text||condition===false)return;\nipe._form.appendChild(document.createTextNode(text));\n};\nthis._form=$(document.createElement('form'));\nthis._form.id=this.options.formId;\nthis._form.addClassName(this.options.formClassName);\nthis._form.onsubmit=this._boundSubmitHandler;\nthis.createEditField();\nif('textarea'==this._controls.editor.tagName.toLowerCase())\nthis._form.appendChild(document.createElement('br'));\nif(this.options.onFormCustomization)\nthis.options.onFormCustomization(this,this._form);\naddText('Before',this.options.okControl||this.options.cancelControl);\nthis.createControl('ok',this._boundSubmitHandler);\naddText('Between',this.options.okControl&&this.options.cancelControl);\nthis.createControl('cancel',this._boundCancelHandler,'editor_cancel');\naddText('After',this.options.okControl||this.options.cancelControl);\n},\ndestroy:function(){\nif(this._oldInnerHTML)\nthis.element.innerHTML=this._oldInnerHTML;\nthis.leaveEditMode();\nthis.unregisterListeners();\n},\nenterEditMode:function(e){\nif(this._saving||this._editing)return;\nthis._editing=true;\nthis.triggerCallback('onEnterEditMode');\nif(this.options.externalControl)\nthis.options.externalControl.hide();\nthis.element.hide();\nthis.createForm();\nthis.element.parentNode.insertBefore(this._form,this.element);\nif(!this.options.loadTextURL)\nthis.postProcessEditField();\nif(e)Event.stop(e);\n},\nenterHover:function(e){\nif(this.options.hoverClassName)\nthis.element.addClassName(this.options.hoverClassName);\nif(this._saving)return;\nthis.triggerCallback('onEnterHover');\n},\ngetText:function(){\nreturn this.element.innerHTML.unescapeHTML();\n},\nhandleAJAXFailure:function(transport){\nthis.triggerCallback('onFailure',transport);\nif(this._oldInnerHTML){\nthis.element.innerHTML=this._oldInnerHTML;\nthis._oldInnerHTML=null;\n}\n},\nhandleFormCancellation:function(e){\nthis.wrapUp();\nif(e)Event.stop(e);\n},\nhandleFormSubmission:function(e){\nvar form=this._form;\nvar value=$F(this._controls.editor);\nthis.prepareSubmission();\nvar params=this.options.callback(form,value)||'';\nif(Object.isString(params))\nparams=params.toQueryParams();\nparams.editorId=this.element.id;\nif(this.options.htmlResponse){\nvar options=Object.extend({evalScripts:true},this.options.ajaxOptions);\nObject.extend(options,{\nparameters:params,\nonComplete:this._boundWrapperHandler,\nonFailure:this._boundFailureHandler\n});\nnew Ajax.Updater({success:this.element},this.url,options);\n}else{\nvar options=Object.extend({method:'get'},this.options.ajaxOptions);\nObject.extend(options,{\nparameters:params,\nonComplete:this._boundWrapperHandler,\nonFailure:this._boundFailureHandler\n});\nnew Ajax.Request(this.url,options);\n}\nif(e)Event.stop(e);\n},\nleaveEditMode:function(){\nthis.element.removeClassName(this.options.savingClassName);\nthis.removeForm();\nthis.leaveHover();\nthis.element.style.backgroundColor=this._originalBackground;\nthis.element.show();\nif(this.options.externalControl)\nthis.options.externalControl.show();\nthis._saving=false;\nthis._editing=false;\nthis._oldInnerHTML=null;\nthis.triggerCallback('onLeaveEditMode');\n},\nleaveHover:function(e){\nif(this.options.hoverClassName)\nthis.element.removeClassName(this.options.hoverClassName);\nif(this._saving)return;\nthis.triggerCallback('onLeaveHover');\n},\nloadExternalText:function(){\nthis._form.addClassName(this.options.loadingClassName);\nthis._controls.editor.disabled=true;\nvar options=Object.extend({method:'get'},this.options.ajaxOptions);\nObject.extend(options,{\nparameters:'editorId='+encodeURIComponent(this.element.id),\nonComplete:Prototype.emptyFunction,\nonSuccess:function(transport){\nthis._form.removeClassName(this.options.loadingClassName);\nvar text=transport.responseText;\nif(this.options.stripLoadedTextTags)\ntext=text.stripTags();\nthis._controls.editor.value=text;\nthis._controls.editor.disabled=false;\nthis.postProcessEditField();\n}.bind(this),\nonFailure:this._boundFailureHandler\n});\nnew Ajax.Request(this.options.loadTextURL,options);\n},\npostProcessEditField:function(){\nvar fpc=this.options.fieldPostCreation;\nif(fpc)\n$(this._controls.editor)['focus'==fpc?'focus':'activate']();\n},\nprepareOptions:function(){\nthis.options=Object.clone(Ajax.InPlaceEditor.DefaultOptions);\nObject.extend(this.options,Ajax.InPlaceEditor.DefaultCallbacks);\n[this._extraDefaultOptions].flatten().compact().each(function(defs){\nObject.extend(this.options,defs);\n}.bind(this));\n},\nprepareSubmission:function(){\nthis._saving=true;\nthis.removeForm();\nthis.leaveHover();\nthis.showSaving();\n},\nregisterListeners:function(){\nthis._listeners={};\nvar listener;\n$H(Ajax.InPlaceEditor.Listeners).each(function(pair){\nlistener=this[pair.value].bind(this);\nthis._listeners[pair.key]=listener;\nif(!this.options.externalControlOnly)\nthis.element.observe(pair.key,listener);\nif(this.options.externalControl)\nthis.options.externalControl.observe(pair.key,listener);\n}.bind(this));\n},\nremoveForm:function(){\nif(!this._form)return;\nthis._form.remove();\nthis._form=null;\nthis._controls={};\n},\nshowSaving:function(){\nthis._oldInnerHTML=this.element.innerHTML;\nthis.element.innerHTML=this.options.savingText;\nthis.element.addClassName(this.options.savingClassName);\nthis.element.style.backgroundColor=this._originalBackground;\nthis.element.show();\n},\ntriggerCallback:function(cbName,arg){\nif('function'==typeof this.options[cbName]){\nthis.options[cbName](this,arg);\n}\n},\nunregisterListeners:function(){\n$H(this._listeners).each(function(pair){\nif(!this.options.externalControlOnly)\nthis.element.stopObserving(pair.key,pair.value);\nif(this.options.externalControl)\nthis.options.externalControl.stopObserving(pair.key,pair.value);\n}.bind(this));\n},\nwrapUp:function(transport){\nthis.leaveEditMode();\nthis._boundComplete(transport,this.element);\n}\n});\nObject.extend(Ajax.InPlaceEditor.prototype,{\ndispose:Ajax.InPlaceEditor.prototype.destroy\n});\nAjax.InPlaceCollectionEditor=Class.create(Ajax.InPlaceEditor,{\ninitialize:function($super,element,url,options){\nthis._extraDefaultOptions=Ajax.InPlaceCollectionEditor.DefaultOptions;\n$super(element,url,options);\n},\ncreateEditField:function(){\nvar list=document.createElement('select');\nlist.name=this.options.paramName;\nlist.size=1;\nthis._controls.editor=list;\nthis._collection=this.options.collection||[];\nif(this.options.loadCollectionURL)\nthis.loadCollection();\nelse\nthis.checkForExternalText();\nthis._form.appendChild(this._controls.editor);\n},\nloadCollection:function(){\nthis._form.addClassName(this.options.loadingClassName);\nthis.showLoadingText(this.options.loadingCollectionText);\nvar options=Object.extend({method:'get'},this.options.ajaxOptions);\nObject.extend(options,{\nparameters:'editorId='+encodeURIComponent(this.element.id),\nonComplete:Prototype.emptyFunction,\nonSuccess:function(transport){\nvar js=transport.responseText.strip();\nif(!/^\\[.*\\]$/.test(js))\nthrow('Server returned an invalid collection representation.');\nthis._collection=eval(js);\nthis.checkForExternalText();\n}.bind(this),\nonFailure:this.onFailure\n});\nnew Ajax.Request(this.options.loadCollectionURL,options);\n},\nshowLoadingText:function(text){\nthis._controls.editor.disabled=true;\nvar tempOption=this._controls.editor.firstChild;\nif(!tempOption){\ntempOption=document.createElement('option');\ntempOption.value='';\nthis._controls.editor.appendChild(tempOption);\ntempOption.selected=true;\n}\ntempOption.update((text||'').stripScripts().stripTags());\n},\ncheckForExternalText:function(){\nthis._text=this.getText();\nif(this.options.loadTextURL)\nthis.loadExternalText();\nelse\nthis.buildOptionList();\n},\nloadExternalText:function(){\nthis.showLoadingText(this.options.loadingText);\nvar options=Object.extend({method:'get'},this.options.ajaxOptions);\nObject.extend(options,{\nparameters:'editorId='+encodeURIComponent(this.element.id),\nonComplete:Prototype.emptyFunction,\nonSuccess:function(transport){\nthis._text=transport.responseText.strip();\nthis.buildOptionList();\n}.bind(this),\nonFailure:this.onFailure\n});\nnew Ajax.Request(this.options.loadTextURL,options);\n},\nbuildOptionList:function(){\nthis._form.removeClassName(this.options.loadingClassName);\nthis._collection=this._collection.map(function(entry){\nreturn 2===entry.length?entry:[entry,entry].flatten();\n});\nvar marker=('value' in this.options)?this.options.value:this._text;\nvar textFound=this._collection.any(function(entry){\nreturn entry[0]==marker;\n}.bind(this));\nthis._controls.editor.update('');\nvar option;\nthis._collection.each(function(entry,index){\noption=document.createElement('option');\noption.value=entry[0];\noption.selected=textFound?entry[0]==marker:0==index;\noption.appendChild(document.createTextNode(entry[1]));\nthis._controls.editor.appendChild(option);\n}.bind(this));\nthis._controls.editor.disabled=false;\nField.scrollFreeActivate(this._controls.editor);\n}\n});\nAjax.InPlaceEditor.prototype.initialize.dealWithDeprecatedOptions=function(options){\nif(!options)return;\nfunction fallback(name,expr){\nif(name in options||expr===undefined)return;\noptions[name]=expr;\n};\nfallback('cancelControl',(options.cancelLink?'link':(options.cancelButton?'button':\noptions.cancelLink==options.cancelButton==false?false:undefined)));\nfallback('okControl',(options.okLink?'link':(options.okButton?'button':\noptions.okLink==options.okButton==false?false:undefined)));\nfallback('highlightColor',options.highlightcolor);\nfallback('highlightEndColor',options.highlightendcolor);\n};\nObject.extend(Ajax.InPlaceEditor,{\nDefaultOptions:{\najaxOptions:{},\nautoRows:3,\ncancelControl:'link',\ncancelText:'cancel',\nclickToEditText:'Click to edit',\nexternalControl:null,\nexternalControlOnly:false,\nfieldPostCreation:'activate',\nformClassName:'inplaceeditor-form',\nformId:null,\nhighlightColor:'#ffff99',\nhighlightEndColor:'#ffffff',\nhoverClassName:'',\nhtmlResponse:true,\nloadingClassName:'inplaceeditor-loading',\nloadingText:'Loading...',\nokControl:'button',\nokText:'ok',\nparamName:'value',\nrows:1,\nsavingClassName:'inplaceeditor-saving',\nsavingText:'Saving...',\nsize:0,\nstripLoadedTextTags:false,\nsubmitOnBlur:false,\ntextAfterControls:'',\ntextBeforeControls:'',\ntextBetweenControls:''\n},\nDefaultCallbacks:{\ncallback:function(form){\nreturn Form.serialize(form);\n},\nonComplete:function(transport,element){\nnew Effect.Highlight(element,{\nstartcolor:this.options.highlightColor,keepBackgroundImage:true});\n},\nonEnterEditMode:null,\nonEnterHover:function(ipe){\nipe.element.style.backgroundColor=ipe.options.highlightColor;\nif(ipe._effect)\nipe._effect.cancel();\n},\nonFailure:function(transport,ipe){\nalert('Error communication with the server: '+transport.responseText.stripTags());\n},\nonFormCustomization:null,\nonLeaveEditMode:null,\nonLeaveHover:function(ipe){\nipe._effect=new Effect.Highlight(ipe.element,{\nstartcolor:ipe.options.highlightColor,endcolor:ipe.options.highlightEndColor,\nrestorecolor:ipe._originalBackground,keepBackgroundImage:true\n});\n}\n},\nListeners:{\nclick:'enterEditMode',\nkeydown:'checkForEscapeOrReturn',\nmouseover:'enterHover',\nmouseout:'leaveHover'\n}\n});\nAjax.InPlaceCollectionEditor.DefaultOptions={\nloadingCollectionText:'Loading options...'\n};\nForm.Element.DelayedObserver=Class.create({\ninitialize:function(element,delay,callback){\nthis.delay=delay||0.5;\nthis.element=$(element);\nthis.callback=callback;\nthis.timer=null;\nthis.lastValue=$F(this.element);\nEvent.observe(this.element,'keyup',this.delayedListener.bindAsEventListener(this));\n},\ndelayedListener:function(event){\nif(this.lastValue==$F(this.element))return;\nif(this.timer)clearTimeout(this.timer);\nthis.timer=setTimeout(this.onTimerEvent.bind(this),this.delay*1000);\nthis.lastValue=$F(this.element);\n},\nonTimerEvent:function(){\nthis.timer=null;\nthis.callback(this.element,$F(this.element));\n}\n});\nif(Object.isUndefined(Effect))\nthrow(\"dragdrop.js requires including script.aculo.us' effects.js library\");\nvar Droppables={\ndrops:[],\nremove:function(element){\nthis.drops=this.drops.reject(function(d){return d.element==$(element)});\n},\nadd:function(element){\nelement=$(element);\nvar options=Object.extend({\ngreedy:true,\nhoverclass:null,\ntree:false\n},arguments[1]||{});\nif(options.containment){\noptions._containers=[];\nvar containment=options.containment;\nif(Object.isArray(containment)){\ncontainment.each(function(c){options._containers.push($(c))});\n}else{\noptions._containers.push($(containment));\n}\n}\nif(options.accept)options.accept=[options.accept].flatten();\nElement.makePositioned(element);\noptions.element=element;\nthis.drops.push(options);\n},\nfindDeepestChild:function(drops){\ndeepest=drops[0];\nfor(i=1;i<drops.length;++i)\nif(Element.isParent(drops[i].element,deepest.element))\ndeepest=drops[i];\nreturn deepest;\n},\nisContained:function(element,drop){\nvar containmentNode;\nif(drop.tree){\ncontainmentNode=element.treeNode;\n}else{\ncontainmentNode=element.parentNode;\n}\nreturn drop._containers.detect(function(c){return containmentNode==c});\n},\nisAffected:function(point,element,drop){\nreturn(\n(drop.element!=element)&&\n((!drop._containers)||\nthis.isContained(element,drop))&&\n((!drop.accept)||\n(Element.classNames(element).detect(\nfunction(v){return drop.accept.include(v)})))&&\nPosition.within(drop.element,point[0],point[1]));\n},\ndeactivate:function(drop){\nif(drop.hoverclass)\nElement.removeClassName(drop.element,drop.hoverclass);\nthis.last_active=null;\n},\nactivate:function(drop){\nif(drop.hoverclass)\nElement.addClassName(drop.element,drop.hoverclass);\nthis.last_active=drop;\n},\nshow:function(point,element){\nif(!this.drops.length)return;\nvar drop,affected=[];\nthis.drops.each(function(drop){\nif(Droppables.isAffected(point,element,drop))\naffected.push(drop);\n});\nif(affected.length>0)\ndrop=Droppables.findDeepestChild(affected);\nif(this.last_active&&this.last_active!=drop)this.deactivate(this.last_active);\nif(drop){\nPosition.within(drop.element,point[0],point[1]);\nif(drop.onHover)\ndrop.onHover(element,drop.element,Position.overlap(drop.overlap,drop.element));\nif(drop!=this.last_active)Droppables.activate(drop);\n}\n},\nfire:function(event,element){\nif(!this.last_active)return;\nPosition.prepare();\nif(this.isAffected([Event.pointerX(event),Event.pointerY(event)],element,this.last_active))\nif(this.last_active.onDrop){\nthis.last_active.onDrop(element,this.last_active.element,event);\nreturn true;\n}\n},\nreset:function(){\nif(this.last_active)\nthis.deactivate(this.last_active);\n}\n};\nvar Draggables={\ndrags:[],\nobservers:[],\nregister:function(draggable){\nif(this.drags.length==0){\nthis.eventMouseUp=this.endDrag.bindAsEventListener(this);\nthis.eventMouseMove=this.updateDrag.bindAsEventListener(this);\nthis.eventKeypress=this.keyPress.bindAsEventListener(this);\nEvent.observe(document,\"mouseup\",this.eventMouseUp);\nEvent.observe(document,\"mousemove\",this.eventMouseMove);\nEvent.observe(document,\"keypress\",this.eventKeypress);\n}\nthis.drags.push(draggable);\n},\nunregister:function(draggable){\nthis.drags=this.drags.reject(function(d){return d==draggable});\nif(this.drags.length==0){\nEvent.stopObserving(document,\"mouseup\",this.eventMouseUp);\nEvent.stopObserving(document,\"mousemove\",this.eventMouseMove);\nEvent.stopObserving(document,\"keypress\",this.eventKeypress);\n}\n},\nactivate:function(draggable){\nif(draggable.options.delay){\nthis._timeout=setTimeout(function(){\nDraggables._timeout=null;\nwindow.focus();\nDraggables.activeDraggable=draggable;\n}.bind(this),draggable.options.delay);\n}else{\nwindow.focus();\nthis.activeDraggable=draggable;\n}\n},\ndeactivate:function(){\nthis.activeDraggable=null;\n},\nupdateDrag:function(event){\nif(!this.activeDraggable)return;\nvar pointer=[Event.pointerX(event),Event.pointerY(event)];\nif(this._lastPointer&&(this._lastPointer.inspect()==pointer.inspect()))return;\nthis._lastPointer=pointer;\nthis.activeDraggable.updateDrag(event,pointer);\n},\nendDrag:function(event){\nif(this._timeout){\nclearTimeout(this._timeout);\nthis._timeout=null;\n}\nif(!this.activeDraggable)return;\nthis._lastPointer=null;\nthis.activeDraggable.endDrag(event);\nthis.activeDraggable=null;\n},\nkeyPress:function(event){\nif(this.activeDraggable)\nthis.activeDraggable.keyPress(event);\n},\naddObserver:function(observer){\nthis.observers.push(observer);\nthis._cacheObserverCallbacks();\n},\nremoveObserver:function(element){\nthis.observers=this.observers.reject(function(o){return o.element==element});\nthis._cacheObserverCallbacks();\n},\nnotify:function(eventName,draggable,event){\nif(this[eventName+'Count']>0)\nthis.observers.each(function(o){\nif(o[eventName])o[eventName](eventName,draggable,event);\n});\nif(draggable.options[eventName])draggable.options[eventName](draggable,event);\n},\n_cacheObserverCallbacks:function(){\n['onStart','onEnd','onDrag'].each(function(eventName){\nDraggables[eventName+'Count']=Draggables.observers.select(\nfunction(o){return o[eventName];}\n).length;\n});\n}\n};\nvar Draggable=Class.create({\ninitialize:function(element){\nvar defaults={\nhandle:false,\nreverteffect:function(element,top_offset,left_offset){\nvar dur=Math.sqrt(Math.abs(top_offset^2)+Math.abs(left_offset^2))*0.02;\nnew Effect.Move(element,{x:-left_offset,y:-top_offset,duration:dur,\nqueue:{scope:'_draggable',position:'end'}\n});\n},\nendeffect:function(element){\nvar toOpacity=Object.isNumber(element._opacity)?element._opacity:1.0;\nnew Effect.Opacity(element,{duration:0.2,from:0.7,to:toOpacity,\nqueue:{scope:'_draggable',position:'end'},\nafterFinish:function(){\nDraggable._dragging[element]=false\n}\n});\n},\nzindex:1000,\nrevert:false,\nquiet:false,\nscroll:false,\nscrollSensitivity:20,\nscrollSpeed:15,\nsnap:false,\ndelay:0\n};\nif(!arguments[1]||Object.isUndefined(arguments[1].endeffect))\nObject.extend(defaults,{\nstarteffect:function(element){\nelement._opacity=Element.getOpacity(element);\nDraggable._dragging[element]=true;\nnew Effect.Opacity(element,{duration:0.2,from:element._opacity,to:0.7});\n}\n});\nvar options=Object.extend(defaults,arguments[1]||{});\nthis.element=$(element);\nif(options.handle&&Object.isString(options.handle))\nthis.handle=this.element.down('.'+options.handle,0);\nif(!this.handle)this.handle=$(options.handle);\nif(!this.handle)this.handle=this.element;\nif(options.scroll&&!options.scroll.scrollTo&&!options.scroll.outerHTML){\noptions.scroll=$(options.scroll);\nthis._isScrollChild=Element.childOf(this.element,options.scroll);\n}\nElement.makePositioned(this.element);\nthis.options=options;\nthis.dragging=false;\nthis.eventMouseDown=this.initDrag.bindAsEventListener(this);\nEvent.observe(this.handle,\"mousedown\",this.eventMouseDown);\nDraggables.register(this);\n},\ndestroy:function(){\nEvent.stopObserving(this.handle,\"mousedown\",this.eventMouseDown);\nDraggables.unregister(this);\n},\ncurrentDelta:function(){\nreturn([\nparseInt(Element.getStyle(this.element,'left')||'0'),\nparseInt(Element.getStyle(this.element,'top')||'0')]);\n},\ninitDrag:function(event){\nif(!Object.isUndefined(Draggable._dragging[this.element])&&\nDraggable._dragging[this.element])return;\nif(Event.isLeftClick(event)){\nvar src=Event.element(event);\nif((tag_name=src.tagName.toUpperCase())&&(\ntag_name=='INPUT'||\ntag_name=='SELECT'||\ntag_name=='OPTION'||\ntag_name=='BUTTON'||\ntag_name=='TEXTAREA'))return;\nvar pointer=[Event.pointerX(event),Event.pointerY(event)];\nvar pos=Position.cumulativeOffset(this.element);\nthis.offset=[0,1].map(function(i){return(pointer[i]-pos[i])});\nDraggables.activate(this);\nEvent.stop(event);\n}\n},\nstartDrag:function(event){\nthis.dragging=true;\nif(!this.delta)\nthis.delta=this.currentDelta();\nif(this.options.zindex){\nthis.originalZ=parseInt(Element.getStyle(this.element,'z-index')||0);\nthis.element.style.zIndex=this.options.zindex;\n}\nif(this.options.ghosting){\nthis._clone=this.element.cloneNode(true);\nthis._originallyAbsolute=(this.element.getStyle('position')=='absolute');\nif(!this._originallyAbsolute)\nPosition.absolutize(this.element);\nthis.element.parentNode.insertBefore(this._clone,this.element);\n}\nif(this.options.scroll){\nif(this.options.scroll==window){\nvar where=this._getWindowScroll(this.options.scroll);\nthis.originalScrollLeft=where.left;\nthis.originalScrollTop=where.top;\n}else{\nthis.originalScrollLeft=this.options.scroll.scrollLeft;\nthis.originalScrollTop=this.options.scroll.scrollTop;\n}\n}\nDraggables.notify('onStart',this,event);\nif(this.options.starteffect)this.options.starteffect(this.element);\n},\nupdateDrag:function(event,pointer){\nif(!this.dragging)this.startDrag(event);\nif(!this.options.quiet){\nPosition.prepare();\nDroppables.show(pointer,this.element);\n}\nDraggables.notify('onDrag',this,event);\nthis.draw(pointer);\nif(this.options.change)this.options.change(this);\nif(this.options.scroll){\nthis.stopScrolling();\nvar p;\nif(this.options.scroll==window){\nwith(this._getWindowScroll(this.options.scroll)){p=[left,top,left+width,top+height];}\n}else{\np=Position.page(this.options.scroll);\np[0]+=this.options.scroll.scrollLeft+Position.deltaX;\np[1]+=this.options.scroll.scrollTop+Position.deltaY;\np.push(p[0]+this.options.scroll.offsetWidth);\np.push(p[1]+this.options.scroll.offsetHeight);\n}\nvar speed=[0,0];\nif(pointer[0]<(p[0]+this.options.scrollSensitivity))speed[0]=pointer[0]-(p[0]+this.options.scrollSensitivity);\nif(pointer[1]<(p[1]+this.options.scrollSensitivity))speed[1]=pointer[1]-(p[1]+this.options.scrollSensitivity);\nif(pointer[0]>(p[2]-this.options.scrollSensitivity))speed[0]=pointer[0]-(p[2]-this.options.scrollSensitivity);\nif(pointer[1]>(p[3]-this.options.scrollSensitivity))speed[1]=pointer[1]-(p[3]-this.options.scrollSensitivity);\nthis.startScrolling(speed);\n}\nif(Prototype.Browser.WebKit)window.scrollBy(0,0);\nEvent.stop(event);\n},\nfinishDrag:function(event,success){\nthis.dragging=false;\nif(this.options.quiet){\nPosition.prepare();\nvar pointer=[Event.pointerX(event),Event.pointerY(event)];\nDroppables.show(pointer,this.element);\n}\nif(this.options.ghosting){\nif(!this._originallyAbsolute)\nPosition.relativize(this.element);\ndelete this._originallyAbsolute;\nElement.remove(this._clone);\nthis._clone=null;\n}\nvar dropped=false;\nif(success){\ndropped=Droppables.fire(event,this.element);\nif(!dropped)dropped=false;\n}\nif(dropped&&this.options.onDropped)this.options.onDropped(this.element);\nDraggables.notify('onEnd',this,event);\nvar revert=this.options.revert;\nif(revert&&Object.isFunction(revert))revert=revert(this.element);\nvar d=this.currentDelta();\nif(revert&&this.options.reverteffect){\nif(dropped==0||revert!='failure')\nthis.options.reverteffect(this.element,\nd[1]-this.delta[1],d[0]-this.delta[0]);\n}else{\nthis.delta=d;\n}\nif(this.options.zindex)\nthis.element.style.zIndex=this.originalZ;\nif(this.options.endeffect)\nthis.options.endeffect(this.element);\nDraggables.deactivate(this);\nDroppables.reset();\n},\nkeyPress:function(event){\nif(event.keyCode!=Event.KEY_ESC)return;\nthis.finishDrag(event,false);\nEvent.stop(event);\n},\nendDrag:function(event){\nif(!this.dragging)return;\nthis.stopScrolling();\nthis.finishDrag(event,true);\nEvent.stop(event);\n},\ndraw:function(point){\nvar pos=Position.cumulativeOffset(this.element);\nif(this.options.ghosting){\nvar r=Position.realOffset(this.element);\npos[0]+=r[0]-Position.deltaX;pos[1]+=r[1]-Position.deltaY;\n}\nvar d=this.currentDelta();\npos[0]-=d[0];pos[1]-=d[1];\nif(this.options.scroll&&(this.options.scroll!=window&&this._isScrollChild)){\npos[0]-=this.options.scroll.scrollLeft-this.originalScrollLeft;\npos[1]-=this.options.scroll.scrollTop-this.originalScrollTop;\n}\nvar p=[0,1].map(function(i){\nreturn(point[i]-pos[i]-this.offset[i])\n}.bind(this));\nif(this.options.snap){\nif(Object.isFunction(this.options.snap)){\np=this.options.snap(p[0],p[1],this);\n}else{\nif(Object.isArray(this.options.snap)){\np=p.map(function(v,i){\nreturn(v/this.options.snap[i]).round()*this.options.snap[i]}.bind(this));\n}else{\np=p.map(function(v){\nreturn(v/this.options.snap).round()*this.options.snap}.bind(this));\n}\n}}\nvar style=this.element.style;\nif((!this.options.constraint)||(this.options.constraint=='horizontal'))\nstyle.left=p[0]+\"px\";\nif((!this.options.constraint)||(this.options.constraint=='vertical'))\nstyle.top=p[1]+\"px\";\nif(style.visibility==\"hidden\")style.visibility=\"\";\n},\nstopScrolling:function(){\nif(this.scrollInterval){\nclearInterval(this.scrollInterval);\nthis.scrollInterval=null;\nDraggables._lastScrollPointer=null;\n}\n},\nstartScrolling:function(speed){\nif(!(speed[0]||speed[1]))return;\nthis.scrollSpeed=[speed[0]*this.options.scrollSpeed,speed[1]*this.options.scrollSpeed];\nthis.lastScrolled=new Date();\nthis.scrollInterval=setInterval(this.scroll.bind(this),10);\n},\nscroll:function(){\nvar current=new Date();\nvar delta=current-this.lastScrolled;\nthis.lastScrolled=current;\nif(this.options.scroll==window){\nwith(this._getWindowScroll(this.options.scroll)){\nif(this.scrollSpeed[0]||this.scrollSpeed[1]){\nvar d=delta/1000;\nthis.options.scroll.scrollTo(left+d*this.scrollSpeed[0],top+d*this.scrollSpeed[1]);\n}\n}\n}else{\nthis.options.scroll.scrollLeft+=this.scrollSpeed[0]*delta/1000;\nthis.options.scroll.scrollTop+=this.scrollSpeed[1]*delta/1000;\n}\nPosition.prepare();\nDroppables.show(Draggables._lastPointer,this.element);\nDraggables.notify('onDrag',this);\nif(this._isScrollChild){\nDraggables._lastScrollPointer=Draggables._lastScrollPointer||$A(Draggables._lastPointer);\nDraggables._lastScrollPointer[0]+=this.scrollSpeed[0]*delta/1000;\nDraggables._lastScrollPointer[1]+=this.scrollSpeed[1]*delta/1000;\nif(Draggables._lastScrollPointer[0]<0)\nDraggables._lastScrollPointer[0]=0;\nif(Draggables._lastScrollPointer[1]<0)\nDraggables._lastScrollPointer[1]=0;\nthis.draw(Draggables._lastScrollPointer);\n}\nif(this.options.change)this.options.change(this);\n},\n_getWindowScroll:function(w){\nvar T,L,W,H;\nwith(w.document){\nif(w.document.documentElement&&documentElement.scrollTop){\nT=documentElement.scrollTop;\nL=documentElement.scrollLeft;\n}else if(w.document.body){\nT=body.scrollTop;\nL=body.scrollLeft;\n}\nif(w.innerWidth){\nW=w.innerWidth;\nH=w.innerHeight;\n}else if(w.document.documentElement&&documentElement.clientWidth){\nW=documentElement.clientWidth;\nH=documentElement.clientHeight;\n}else{\nW=body.offsetWidth;\nH=body.offsetHeight;\n}\n}\nreturn{top:T,left:L,width:W,height:H};\n}\n});\nDraggable._dragging={};\nvar SortableObserver=Class.create({\ninitialize:function(element,observer){\nthis.element=$(element);\nthis.observer=observer;\nthis.lastValue=Sortable.serialize(this.element);\n},\nonStart:function(){\nthis.lastValue=Sortable.serialize(this.element);\n},\nonEnd:function(){\nSortable.unmark();\nif(this.lastValue!=Sortable.serialize(this.element))\nthis.observer(this.element)\n}\n});\nvar Sortable={\nSERIALIZE_RULE:/^[^_\\-](?:[A-Za-z0-9\\-\\_]*)[_](.*)$/,\nsortables:{},\n_findRootElement:function(element){\nwhile(element.tagName.toUpperCase()!=\"BODY\"){\nif(element.id&&Sortable.sortables[element.id])return element;\nelement=element.parentNode;\n}\n},\noptions:function(element){\nelement=Sortable._findRootElement($(element));\nif(!element)return;\nreturn Sortable.sortables[element.id];\n},\ndestroy:function(element){\nelement=$(element);\nvar s=Sortable.sortables[element.id];\nif(s){\nDraggables.removeObserver(s.element);\ns.droppables.each(function(d){Droppables.remove(d)});\ns.draggables.invoke('destroy');\ndelete Sortable.sortables[s.element.id];\n}\n},\ncreate:function(element){\nelement=$(element);\nvar options=Object.extend({\nelement:element,\ntag:'li',\ndropOnEmpty:false,\ntree:false,\ntreeTag:'ul',\noverlap:'vertical',\nconstraint:'vertical',\ncontainment:element,\nhandle:false,\nonly:false,\ndelay:0,\nhoverclass:null,\nghosting:false,\nquiet:false,\nscroll:false,\nscrollSensitivity:20,\nscrollSpeed:15,\nformat:this.SERIALIZE_RULE,\nelements:false,\nhandles:false,\nonChange:Prototype.emptyFunction,\nonUpdate:Prototype.emptyFunction\n},arguments[1]||{});\nthis.destroy(element);\nvar options_for_draggable={\nrevert:true,\nquiet:options.quiet,\nscroll:options.scroll,\nscrollSpeed:options.scrollSpeed,\nscrollSensitivity:options.scrollSensitivity,\ndelay:options.delay,\nghosting:options.ghosting,\nconstraint:options.constraint,\nhandle:options.handle};\nif(options.starteffect)\noptions_for_draggable.starteffect=options.starteffect;\nif(options.reverteffect)\noptions_for_draggable.reverteffect=options.reverteffect;\nelse\nif(options.ghosting)options_for_draggable.reverteffect=function(element){\nelement.style.top=0;\nelement.style.left=0;\n};\nif(options.endeffect)\noptions_for_draggable.endeffect=options.endeffect;\nif(options.zindex)\noptions_for_draggable.zindex=options.zindex;\nvar options_for_droppable={\noverlap:options.overlap,\ncontainment:options.containment,\ntree:options.tree,\nhoverclass:options.hoverclass,\nonHover:Sortable.onHover\n};\nvar options_for_tree={\nonHover:Sortable.onEmptyHover,\noverlap:options.overlap,\ncontainment:options.containment,\nhoverclass:options.hoverclass\n};\nElement.cleanWhitespace(element);\noptions.draggables=[];\noptions.droppables=[];\nif(options.dropOnEmpty||options.tree){\nDroppables.add(element,options_for_tree);\noptions.droppables.push(element);\n}\n(options.elements||this.findElements(element,options)||[]).each(function(e,i){\nvar handle=options.handles?$(options.handles[i]):\n(options.handle?$(e).select('.'+options.handle)[0]:e);\noptions.draggables.push(\nnew Draggable(e,Object.extend(options_for_draggable,{handle:handle})));\nDroppables.add(e,options_for_droppable);\nif(options.tree)e.treeNode=element;\noptions.droppables.push(e);\n});\nif(options.tree){\n(Sortable.findTreeElements(element,options)||[]).each(function(e){\nDroppables.add(e,options_for_tree);\ne.treeNode=element;\noptions.droppables.push(e);\n});\n}\nthis.sortables[element.id]=options;\nDraggables.addObserver(new SortableObserver(element,options.onUpdate));\n},\nfindElements:function(element,options){\nreturn Element.findChildren(\nelement,options.only,options.tree?true:false,options.tag);\n},\nfindTreeElements:function(element,options){\nreturn Element.findChildren(\nelement,options.only,options.tree?true:false,options.treeTag);\n},\nonHover:function(element,dropon,overlap){\nif(Element.isParent(dropon,element))return;\nif(overlap>.33&&overlap<.66&&Sortable.options(dropon).tree){\nreturn;\n}else if(overlap>0.5){\nSortable.mark(dropon,'before');\nif(dropon.previousSibling!=element){\nvar oldParentNode=element.parentNode;\nelement.style.visibility=\"hidden\";\ndropon.parentNode.insertBefore(element,dropon);\nif(dropon.parentNode!=oldParentNode)\nSortable.options(oldParentNode).onChange(element);\nSortable.options(dropon.parentNode).onChange(element);\n}\n}else{\nSortable.mark(dropon,'after');\nvar nextElement=dropon.nextSibling||null;\nif(nextElement!=element){\nvar oldParentNode=element.parentNode;\nelement.style.visibility=\"hidden\";\ndropon.parentNode.insertBefore(element,nextElement);\nif(dropon.parentNode!=oldParentNode)\nSortable.options(oldParentNode).onChange(element);\nSortable.options(dropon.parentNode).onChange(element);\n}\n}\n},\nonEmptyHover:function(element,dropon,overlap){\nvar oldParentNode=element.parentNode;\nvar droponOptions=Sortable.options(dropon);\nif(!Element.isParent(dropon,element)){\nvar index;\nvar children=Sortable.findElements(dropon,{tag:droponOptions.tag,only:droponOptions.only});\nvar child=null;\nif(children){\nvar offset=Element.offsetSize(dropon,droponOptions.overlap)*(1.0-overlap);\nfor(index=0;index<children.length;index+=1){\nif(offset-Element.offsetSize(children[index],droponOptions.overlap)>=0){\noffset-=Element.offsetSize(children[index],droponOptions.overlap);\n}else if(offset-(Element.offsetSize(children[index],droponOptions.overlap)/2)>=0){\nchild=index+1<children.length?children[index+1]:null;\nbreak;\n}else{\nchild=children[index];\nbreak;\n}\n}\n}\ndropon.insertBefore(element,child);\nSortable.options(oldParentNode).onChange(element);\ndroponOptions.onChange(element);\n}\n},\nunmark:function(){\nif(Sortable._marker)Sortable._marker.hide();\n},\nmark:function(dropon,position){\nvar sortable=Sortable.options(dropon.parentNode);\nif(sortable&&!sortable.ghosting)return;\nif(!Sortable._marker){\nSortable._marker=\n($('dropmarker')||Element.extend(document.createElement('DIV'))).\nhide().addClassName('dropmarker').setStyle({position:'absolute'});\ndocument.getElementsByTagName(\"body\").item(0).appendChild(Sortable._marker);\n}\nvar offsets=Position.cumulativeOffset(dropon);\nSortable._marker.setStyle({left:offsets[0]+'px',top:offsets[1]+'px'});\nif(position=='after')\nif(sortable.overlap=='horizontal')\nSortable._marker.setStyle({left:(offsets[0]+dropon.clientWidth)+'px'});\nelse\nSortable._marker.setStyle({top:(offsets[1]+dropon.clientHeight)+'px'});\nSortable._marker.show();\n},\n_tree:function(element,options,parent){\nvar children=Sortable.findElements(element,options)||[];\nfor(var i=0;i<children.length;++i){\nvar match=children[i].id.match(options.format);\nif(!match)continue;\nvar child={\nid:encodeURIComponent(match?match[1]:null),\nelement:element,\nparent:parent,\nchildren:[],\nposition:parent.children.length,\ncontainer:$(children[i]).down(options.treeTag)\n};\nif(child.container)\nthis._tree(child.container,options,child);\nparent.children.push(child);\n}\nreturn parent;\n},\ntree:function(element){\nelement=$(element);\nvar sortableOptions=this.options(element);\nvar options=Object.extend({\ntag:sortableOptions.tag,\ntreeTag:sortableOptions.treeTag,\nonly:sortableOptions.only,\nname:element.id,\nformat:sortableOptions.format\n},arguments[1]||{});\nvar root={\nid:null,\nparent:null,\nchildren:[],\ncontainer:element,\nposition:0\n};\nreturn Sortable._tree(element,options,root);\n},\n_constructIndex:function(node){\nvar index='';\ndo{\nif(node.id)index='['+node.position+']'+index;\n}while((node=node.parent)!=null);\nreturn index;\n},\nsequence:function(element){\nelement=$(element);\nvar options=Object.extend(this.options(element),arguments[1]||{});\nreturn $(this.findElements(element,options)||[]).map(function(item){\nreturn item.id.match(options.format)?item.id.match(options.format)[1]:'';\n});\n},\nsetSequence:function(element,new_sequence){\nelement=$(element);\nvar options=Object.extend(this.options(element),arguments[2]||{});\nvar nodeMap={};\nthis.findElements(element,options).each(function(n){\nif(n.id.match(options.format))\nnodeMap[n.id.match(options.format)[1]]=[n,n.parentNode];\nn.parentNode.removeChild(n);\n});\nnew_sequence.each(function(ident){\nvar n=nodeMap[ident];\nif(n){\nn[1].appendChild(n[0]);\ndelete nodeMap[ident];\n}\n});\n},\nserialize:function(element){\nelement=$(element);\nvar options=Object.extend(Sortable.options(element),arguments[1]||{});\nvar name=encodeURIComponent(\n(arguments[1]&&arguments[1].name)?arguments[1].name:element.id);\nif(options.tree){\nreturn Sortable.tree(element,arguments[1]).children.map(function(item){\nreturn[name+Sortable._constructIndex(item)+\"[id]=\"+\nencodeURIComponent(item.id)].concat(item.children.map(arguments.callee));\n}).flatten().join('&');\n}else{\nreturn Sortable.sequence(element,arguments[1]).map(function(item){\nreturn name+\"[]=\"+encodeURIComponent(item);\n}).join('&');\n}\n}\n};\nElement.isParent=function(child,element){\nif(!child.parentNode||child==element)return false;\nif(child.parentNode==element)return true;\nreturn Element.isParent(child.parentNode,element);\n};\nElement.findChildren=function(element,only,recursive,tagName){\nif(!element.hasChildNodes())return null;\ntagName=tagName.toUpperCase();\nif(only)only=[only].flatten();\nvar elements=[];\n$A(element.childNodes).each(function(e){\nif(e.tagName&&e.tagName.toUpperCase()==tagName&&\n(!only||(Element.classNames(e).detect(function(v){return only.include(v)}))))\nelements.push(e);\nif(recursive){\nvar grandchildren=Element.findChildren(e,only,recursive,tagName);\nif(grandchildren)elements.push(grandchildren);\n}\n});\nreturn(elements.length>0?elements.flatten():[]);\n};\nElement.offsetSize=function(element,type){\nreturn element['offset'+((type=='vertical'||type=='height')?'Height':'Width')];\n};\nvar StateResolver=\n{\nSERIALIZATION_ORDER:['MapType','MapZoom','TabId','PointId','PointStyle','CenterLat','CenterLng','PathId'],\ndeserialize:function(serializedState,toDec){\nserializedState=serializedState.replace(/%3C/ig,'<').replace(/%3E/ig,'>')\nvar order=StateResolver.SERIALIZATION_ORDER;\nvar orderLength=order.length;\nvar returnHash={};\nvar index=0;\nfor(var i=0;i<orderLength;i++){\nvar value=null;\nvar length=0;\nif(index<serializedState.length){\nlength=parseInt(serializedState.charAt(index));\n}\nif(length>0){\nvalue=serializedState.substr(index+1,length);\n}\nif(toDec&&value!=null){\nif((order[i]=='CenterLat'||order[i]=='CenterLng')){\nvar decimal=StateResolver.xToDec(value.substr(value.indexOf('.')+1))\nwhile((\"\"+decimal).length<6)decimal=\"0\"+decimal;\nreturnHash[order[i]]=parseFloat(value.substring(0,value.indexOf('.')+1)+decimal);\n}else{\nreturnHash[order[i]]=StateResolver.xToDec(value);\n}\n}else{\nreturnHash[order[i]]=value;\n}\nindex+=length+1;\n}\nreturn returnHash;\n},\ntranslateToGMapType:function(type)\n{\nvar mapTypes={\n0:google.maps.MapTypeId.ROADMAP,\n1:google.maps.MapTypeId.SATELLITE,\n2:google.maps.MapTypeId.HYBRID,\n3:google.maps.MapTypeId.TERRAIN\n};\nreturn mapTypes[type]||mapTypes[0];\n},\ntranslateFromGMapType:function(type)\n{\nswitch(type)\n{\ncase google.maps.MapTypeId.ROADMAP:\nreturn 0;\ncase google.maps.MapTypeId.SATELLITE:\nreturn 1;\ncase google.maps.MapTypeId.HYBRID:\nreturn 2;\ncase google.maps.MapTypeId.TERRAIN:\nreturn 3;\ndefault:\nreturn 0;\n}\n},\ntranslateToStyleName:function(styleId)\n{\nswitch(parseInt(styleId||0))\n{\ncase 0:\nreturn \"basic\";\nbreak;\ncase 1:\nreturn \"photos\";\nbreak;\ncase 2:\nreturn \"directions\";\nbreak;\ncase 3:\nreturn \"comments\";\nbreak;\ncase 4:\nreturn \"basicedit\";\nbreak;\ncase 5:\nreturn \"new\";\nbreak;\ncase 6:\nreturn \"move\";\nbreak;\ncase 7:\nreturn \"noshow\";\nbreak;\ndefault:\nreturn \"basic\";\nbreak;\n}\n},\ntranslateFromStyleName:function(style)\n{\nswitch(style)\n{\ncase \"basic\":\nreturn 0;\nbreak;\ncase \"photos\":\nreturn 1;\nbreak;\ncase \"directions\":\nreturn 2;\nbreak;\ncase \"comments\":\nreturn 3;\nbreak;\ncase \"basicedit\":\nreturn 4;\nbreak;\ncase \"new\":\nreturn 5;\nbreak;\ncase \"move\":\nreturn 6;\nbreak;\ncase \"window\":\nreturn 7;\nbreak;\ncase \"media\":\nreturn 7;\nbreak;\ndefault:\nreturn 0;\nbreak;\n}\n},\nbinToDec:function(b)\n{\nvar result=0;\nfor(var i=0;i<b.length;i++)\n{\nresult+=parseInt(b.charAt(i))*Math.pow(2,((b.length-1)-i));\n}\nreturn result;\n},\nbinToX:function(b)\n{\nvar d=StateResolver.binToDec(b);\nreturn StateResolver.decToX(d);\n},\ndecToBin:function(d)\n{\nvar result=\"\";\nif(d>=2)\n{\nresult=StateResolver.decToBin((d-(d%2))/2);\n}\nresult+=String(d%2);\nreturn result;\n},\ndecToX:function(d)\n{\nvar result=\"\";\nif(d>=64)\n{\nresult=StateResolver.decToX((d-(d%64))/64);\n}\nresult+=String.fromCharCode((d%64)+48);\nreturn result.replace(/[?]/g,\"p\").replace(/[>]/g,\"q\");\n},\nxToDec:function(x)\n{\nx=x.replace(/[p]/g,\"?\").replace(/[q]/g,\">\");\nvar result=0;\nfor(var i=0;i<x.length;i++)\n{\nresult+=(x.charCodeAt(i)-48)*Math.pow(64,((x.length-1)-i));\n}\nreturn result;\n},\nxToBin:function(x)\n{\nvar d=StateResolver.xToDec(x);\nreturn StateResolver.decToBin(d);\n}\n};\nZoomLevel={};\nZoomLevel.WORLD=1;\nZoomLevel.COUNTRY=4;\nZoomLevel.STATE=7;\nZoomLevel.REGION=10;\nZoomLevel.CITY=12;\nZoomLevel.PLANE=14;\nZoomLevel.SMALL_PLANE=15;\nZoomLevel.HOT_AIR_BALLOON=16;\nZoomLevel.LOW_FLYING_HOT_AIR_BALLOON=17;\nZoomLevel.SKY_SCRAPER=18;\nZoomLevel.BIG_BUILDING=19;\nZoomLevel.SMALL_BUILDING=19;\nZoomLevel.MAX=19;\nZoomLevels=function(){\nvar levels=[];\nfor(var level in ZoomLevel){\nlevels.push(ZoomLevel[level]);\n}\nreturn levels;\n}\nWalkMap=Class.create();\nWalkMap.USE_CW_OVERLAY=true;\nWalkMap.DOUBLECLICK_WAIT=200;\nWalkMap.DOUBLECLICK_WAIT_CUSHION=100;\nWalkMap.prototype={\ninitialize:function(container,mapTypes,initialState,doubleClickToZoom){\ndoubleClickToZoom=true;\nthis.mapTypes=mapTypes;\nthis.container=container;\nthis.container.style.cursor='default';\nthis._clickZoomEnabled=!doubleClickToZoom;\nthis.movementDisabled=false;\nthis.listeners=[];\nthis.lastIdentifier=0;\nthis.showTitles=false;\nthis.displayMarkerMessage=$('display_marker_message');\nthis.overlays=new Collection();\nthis.markers={};\n},\nonBitmapReset:function(){},\nunload:function(){\nthis.overlays.each(function(overlay){\nthis.removeMarker(overlay);\noverlay=null;\n}.bind(this));\n},\ninstantiateMapAPI:function(state){\nvar mapOptions={\nzoom:12,\nmapTypeId:google.maps.MapTypeId.ROADMAP,\ndisableDoubleClickZoom:this._clickZoomEnabled\n};\nthis.gmap=new google.maps.Map(this.container,mapOptions);\nthis.registerListeners();\nthis.changeState(state);\nthis.zoomLevels=[];\nthis.controls=this.gmap.controls;\nvar customLevelContained=false;\nfor(var level in ZoomLevel){\nvar levelNumber=ZoomLevel[level];\nthis.zoomLevels.push(levelNumber);\nif(levelNumber==state.MapZoom)customLevelContained=true;\n}\nif(!customLevelContained)this.zoomLevels.push(state.MapZoom);\nthis.zoomLevels=this.zoomLevels.sort(function(a,b){return a-b;});\nthis.instantiateZoomSteps();\nif(WalkMap.USE_CW_OVERLAY)this.instantiateFastOverlay();\n},\ninstantiateFastOverlay:function(){\nthis._fastOverlay=new CwOverlay(this.getMapApp());\n},\nregisterListeners:function(){\nthis.mapClickedCount=0;\nthis.ctrlClicking=false;\nvar events=google.maps.event;\nthis.listeners.push(events.addListener(this.getMapApp(),\"click\",this.handleMapClick.bind(this)));\nthis.container.onmouseup=this.handleMapMouseUp.bind(this);\n},\nclearEventListeners:function(){\nvar length=this.listeners;\nfor(var i=0;i<length;i++)\n{\ngoogle.maps.event.removeListener(this.listeners[i]);\nthis.listeners[i]=null;\n}\n},\nclickZoomEnabled:function(){\nif(!this._clickZoomEnabled)return false;\nreturn true;\n},\nenableClickZoom:function(){\nif(WalkMap.USE_CW_OVERLAY)return;\nthis._clickZoomEnabled=true;\nthis.container.style.cursor='default';\n},\ndisableClickZoom:function(){\nif(WalkMap.USE_CW_OVERLAY)return;\nthis._clickZoomEnabled=false;\nthis.container.style.cursor='pointer';\n},\ninstantiateZoomSteps:function(){\nthis.zoomSteps={};\nvar zoomLevelPointer=0;\nfor(var i=0;i<=ZoomLevel.MAX;++i){\nif(this.zoomLevels[zoomLevelPointer]<=i){\nzoomLevelPointer++;\n}\nthis.zoomSteps[i]=this.zoomLevels[zoomLevelPointer];\n}\n},\nregisterKeyHandlers:function(){\n},\nchangeState:function(state){\nvar center=new google.maps.LatLng(parseFloat(state.CenterLat),parseFloat(state.CenterLng));\nvar zoom=parseInt(state.MapZoom);\nvar mapType=StateResolver.translateToGMapType(state.MapType);\nthis.getMapApp().setCenter(center);\nthis.getMapApp().setZoom(zoom);\nthis.getMapApp().setMapTypeId(mapType)\n},\nzoomTo:function(zoom){\nif(this.movementDisabled)return;\nthis.getMapApp().setZoom(parseInt(zoom));\n},\nzoomToNextLevel:function(point){\nvar newZoom=this.zoomSteps[this.getZoomLevel()];\nif(point){\nthis.zooming=true;\nthis.centerAndZoom(point,newZoom);\n}\nelse{\nthis.zoomTo(newZoom);\n}\n},\nzoomToPrevLevel:function(point){\nvar zoom=this.getZoomLevel();\nvar newFixedLevel=0;\nfor(var i=0;i<this.zoomLevels.length;++i){\nvar fixedLevel=this.zoomLevels[i];\nif(fixedLevel<zoom&&fixedLevel>newFixedLevel){\nnewFixedLevel=fixedLevel;\n}\n}\nif(point){\nthis.centerAndZoom(point,newFixedLevel);\n}\nelse{\nthis.zoomTo(newFixedLevel);\n}\n},\ngotoLatLng:function(coordinate){\nthis.getMapApp().panTo(coordinate);\n},\nisLoaded:function(){\nreturn(google&&google.maps&&this.getMapApp())\n},\ngetMapApp:function(){\nreturn this.gmap;\n},\nsetHeight:function(height){\nthis.container.style.height=height+\"px\";\nif(this.getMapApp()){\ngoogle.maps.event.trigger(this.getMapApp(),'resize')\n}\n},\nsetOptions:function(options){\nthis.getMapApp().setOptions(options)\n},\ngetCenterLatLng:function(){\nreturn this.getMapApp().getCenter();\n},\ndisableDragging:function(){\nthis.getMapApp().disableDragging();\n},\ncenterAndZoom:function(latlng,zoom){\nif(this.movementDisabled)return;\nthis.getMapApp().setCenter(latlng);\nthis.getMapApp().setZoom(zoom);\n},\ncenterAtLatLng:function(latlng){\nthis.getMapApp().setCenter(latlng);\n},\nrecenterOrPanToLatLng:function(latlng){\nif(this.movementDisabled)return;\nthis.getMapApp().panTo(latlng);\n},\naddControl:function(control,position){\nthis.getMapApp().addControl(control,position);\n},\naddMarker:function(marker){\nif(!marker.identifier)this.identify(marker);\nthis.showDisplayMarkerMessage(true);\nsetTimeout(function(){\nif(window.CwMarker&&marker.type==CwMarker.TYPE&&WalkMap.USE_CW_OVERLAY){\nthis._fastOverlay.addMarker(marker);\n}else{\nmarker.setMap(this.getMapApp())\n}\nif(marker.getPath){\nthis.overlays.push(marker);\n}else{\nthis.markers[marker.identifier]=marker;\n}\nmarker.displayed=true;\nif(this.showTitles)google.maps.event.trigger(marker,\"mouseover\");\nthis.showDisplayMarkerMessage(false);\n}.bind(this),0);\n},\nidentify:function(marker){\nthis.lastIdentifier++;\nmarker.identifier=this.lastIdentifier;\n},\ngetZoomLevel:function(){\nreturn this.getMapApp().getZoom();\n},\nsetMapType:function(type){\nthis.getMapApp().setMapTypeId(StateResolver.translateToGMapType(type));\n},\ngetCurrentMapType:function(){\nreturn StateResolver.translateFromGMapType(this.getMapApp().getMapTypeId());\n},\ngetMapTypes:function(){\nreturn this.getMapApp().mapTypes;\n},\nfindPolylineInstanceEquivalentTo:function(polylineToFind){\nvar result=U.findEquivalentPolylineInstance(polylineToFind,this.overlays)\nreturn result;\n},\nremoveMarkerByIdentifier:function(markerIdentifier){\nif(this.markers[markerIdentifier]){\nthis.removeMarker(this.markers[markerIdentifier]);\n}\n},\nremoveMarker:function(marker){\nthis.showDisplayMarkerMessage(true);\nsetTimeout(function(){\nif(marker.getPath){\nvar overlayInstanceToRemove=U.removeEquivalentPolylineFromArray(marker,this.overlays);\noverlayInstanceToRemove.setMap(null);\nmarker.setMap(null);\n}else{\nif(window.CwMarker&&marker.type==CwMarker.TYPE&&WalkMap.USE_CW_OVERLAY){\nthis._fastOverlay.removeMarker(marker);\n}else{\nmarker.setMap(null);\n}\ndelete this.markers[marker.identifier];\n}\nmarker.displayed=false;\nthis.showDisplayMarkerMessage(false);\n}.bind(this),0);\n},\nremoveAllMarkers:function(){\nthis.getMapApp().clearOverlays();\n},\ninfoWindowClose:function(){\nwalkApp.locations.closeInfoWindows();\n},\ngetBoundsLatLng:function(){\nvar bounds=this.getMapApp().getBounds();\nbounds.asParams=function(paramName){\nvar boundingBoxString=paramName+\"[top_right_lat]=\"+U.roundFloat(this.getNorthEast().lat(),4);\nboundingBoxString+=\"&\"+paramName+\"[top_right_lng]=\"+U.roundFloat(this.getNorthEast().lng(),4);\nboundingBoxString+=\"&\"+paramName+\"[bottom_left_lat]=\"+U.roundFloat(this.getSouthWest().lat(),4);\nboundingBoxString+=\"&\"+paramName+\"[bottom_left_lng]=\"+U.roundFloat(this.getSouthWest().lng(),4);\nreturn boundingBoxString;\n}\nreturn bounds;\n},\nhandleMapClick:function(overlay,point){\nif(!overlay){\nthis.infoWindowClose();\n}\nif(overlay||!this.clickZoomEnabled())return;\n},\nzoomInClick:function(point){\nif(!this.clickZoomEnabled())return;\nthis.zoomToNextLevel(point);\n},\nzoomOutClick:function(){\nif(!this.clickZoomEnabled()||this.infoWindowOpened){\nreturn;\n}\nthis.zooming=true;\nthis.zoomToPrevLevel();\n},\nhandleMapMouseUp:function(event){\nevent=event||window.event;\nif(event.ctrlKey){\nthis.ctrlClicking=true;\n}\nelse{\nthis.ctrlClicking=false;\n}\nif(event.button==2||this.ctrlClicking){\nthis.zoomOutClick();\n}\nif(event.button==1||event.button==0){\n++this.mapClickedCount;\nsetTimeout(function(){\nthis.mapClickedCount=0;\nthis.ctrlClicking=false;\nthis.zooming=false;\n}.bind(this),WalkMap.DOUBLECLICK_WAIT+WalkMap.DOUBLECLICK_WAIT_CUSHION);\n}\n},\nsetMovementDisabled:function(disable){\nthis.movementDisabled=disable;\n},\nshowDisplayMarkerMessage:function(starting,message){\nif(!this.displayMarkerMessage){\nthis.displayingMarkerCount=0;\nthis.displayMarkerMessage=document.createElement(\"DIV\");\nthis.displayMarkerMessage.style.display=\"none\";\nthis.displayMarkerMessage.className='map_control';\nthis.displayMarkerMessage.innerHTML=\"Working...\";\nthis.displayMarkerMessage.id=\"display_marker_message\";\nthis.container.appendChild(this.displayMarkerMessage);\n}\nthis.displayingMarkerCount+=starting?1:-1;\nif(this.displayingMarkerCount>0){\nthis.displayMarkerMessage.style.display=\"block\";\n}\nelse{\nthis.displayMarkerMessage.style.display=\"none\";\n}\n}\n};\nWalkMarker={\ncreate:function(info,wrapText,locationId,groupId,offset){\nvar marker=new google.maps.Marker(info);\nmarker.locationId=locationId;\nmarker.groupId=groupId;\nvar tooltip=new Tooltip(info.title,wrapText,((!offset||isNaN(offset.height))?marker.getIcon().size:offset),marker.getPosition.bind(marker),locationId,groupId);\ngoogle.maps.event.addListener(marker,\"mouseover\",tooltip.show.bind(tooltip));\ngoogle.maps.event.addListener(marker,\"mouseout\",tooltip.hide.bind(tooltip));\ngoogle.maps.event.addListener(marker,\"remove\",function(){this.hide(true)}.bind(tooltip));\nmarker.tooltip=tooltip;\nmarker.withinBounds=this.withinBounds.bind(marker);\nmarker.replaceTooltipText=this.replaceTooltipText.bind(marker);\nreturn marker;\n},\nwithinBounds:function(bounds){\nvar point=this.getPosition();\nreturn(point.lng()>bounds.getSouthWest().lng()&&\npoint.lat()>bounds.getSouthWest().lat()&&\npoint.lng()<bounds.getNorthEast().lng()&&\npoint.lat()<bounds.getNorthEast().lat())\n},\nreplaceTooltipText:function(text){\nthis.tooltip.changeContents(text);\n}\n}\nWalkGLocalResult=Class.create();\nWalkGLocalResult.prototype={\ninitialize:function(gLocalResult){\nthis.gLocalResult=gLocalResult;\n},\nasInfo:function(){\nvar g=this.gLocalResult;\nvar info={\ny:g.geometry.location.lat(),\nx:g.geometry.location.lng(),\nfullAddress:g.formatted_address,\nlink_title:g.name+'<br/>'+g.formatted_address,\ntitle:g.name\n};\nreturn info;\n}\n}\nTooltip=Class.create();\nTooltip.tooltipCount=0;\nTooltip.prototype={\ninitialize:function(tooltipContents,wrapText,offset,currentLatLngFunction,locationId,groupId){\nthis.locationId=locationId;\nthis.groupId=groupId;\nthis.tooltipContents=tooltipContents==undefined?\"\":tooltipContents;\nthis.currentLatLngFunction=currentLatLngFunction;\nthis.isShowing=false;\nthis.offset=offset;\nthis.id=Tooltip.tooltipCount;\nTooltip.tooltipCount++;\nvar map=U.getMap().getMapApp();\nif(!map.tooltipOverlay){\nmap.tooltipOverlay=new google.maps.OverlayView();\nmap.tooltipOverlay.draw=function(){};\nmap.tooltipOverlay.setMap(map);\n}\nthis.overlay=map.tooltipOverlay;\nif(map.showTitles)this.show();\n},\nchangeContents:function(contents){\nthis.tooltipContents=contents;\nif(this.isShowing)Element.hide(this.tooltipDiv);\nthis.tooltipDiv=null;\nif(this.isShowing)this.show(this.currentlatlng);\n},\nshow:function(event){\nthis.currentlatlng=(event&&event.latlng)?event.latlng:this.currentLatLngFunction();\nvar bitmapCoordinate=this.overlay.getProjection().fromLatLngToDivPixel(this.currentlatlng);\nif(!this.tooltipDiv){\nthis.tooltipDiv=document.createElement(\"div\");\nthis.tooltipDiv.id='tooltip_'+this.id;\nthis.tooltipDiv.style.display=\"none\";\nthis.tooltipDiv.style.cursor=\"move\";\nthis.tooltipDiv.style.position=\"absolute\";\nthis.tooltipDiv.style.padding=\"0\";\nthis.tooltipDiv.style.margin=\"0\";\nvar html=\"<div class='tooltip_background'>\";\nhtml+=\"<div class='fake_text printonly'>\"+this.tooltipContents+\"</div>\";\nhtml+=\"<div class=\\\"tooltip\\\" style='\";\nif(this.wrapText){\nhtml+=\"white-space: normal;\";\n}\nhtml+=\"'>\"+this.tooltipContents+\"</div></div>\";\nthis.tooltipDiv.innerHTML=html;\nthis.overlay.getPanes().overlayMouseTarget.appendChild(this.tooltipDiv);\n}\nthis.tooltipDiv.style.zIndex=(90-parseInt(this.currentlatlng.lat()));\nthis.originalY=bitmapCoordinate.y;\nthis.originalX=bitmapCoordinate.x;\nthis.tooltipDiv.style.top=(this.originalY-this.offset.height)+\"px\";\nthis.tooltipDiv.style.left=(this.originalX)+\"px\";\nElement.show(this.tooltipDiv);\nthis.isShowing=true;\nnew Draggable(this.tooltipDiv,{\nstarteffect:function(){},\nendeffect:this.handleDrag.bind(this)\n});\n},\nupdateLocation:function(){\nthis.currentlatlng=this.currentLatLngFunction();\nvar bitmapCoordinate=this.overlay.getProjection().fromLatLngToDivPixel(this.currentlatlng);\nif(this.tooltipDiv&&this.isShowing){\nthis.originalY=bitmapCoordinate.y;\nthis.originalX=bitmapCoordinate.x\nthis.tooltipDiv.style.top=(this.originalY-this.offset.height)+\"px\";\nthis.tooltipDiv.style.left=(this.originalX+this.offset.width)+\"px\";\n}\n},\nhandleDrag:function(){\nthis.offset.height=this.originalY-parseInt(this.tooltipDiv.style.top);\nthis.offset.width=parseInt(this.tooltipDiv.style.left)-this.originalX;\nif(this.locationId&&this.groupId){\nwalkApp.queue.enqueue(new UpdateTitleOffset(this.locationId,this.groupId,this.offset.height,this.offset.width));\n}\nthis.overlay.getPanes().overlayMouseTarget.removeChild(this.tooltipDiv);\nthis.tooltipDiv=null;\nthis.show();\n},\nhide:function(latlng,path){\nif(path&&this.tooltipDiv){\nElement.hide(this.tooltipDiv);\nreturn;\n}\nif(U.getMap().showTitles||this.permanentlyShown)return;\nif(this.tooltipDiv){\nElement.hide(this.tooltipDiv);\n}\nthis.isShowing=false;\nthis.permanentlyShown=false;\n}\n}\nUpdateTitleOffset=Class.create();\nUpdateTitleOffset.prototype={\ninitialize:function(locationId,groupId,offsetTop,offsetLeft){\nthis.locationId=locationId;\nthis.groupId=groupId;\nthis.offsetTop=offsetTop;\nthis.offsetLeft=offsetLeft;\n},\nexecute:function(){\n},\nasAjaxPayload:function(){\nreturn{url:\"/locations/update_title_offset/\"+this.groupId+\"/\"+this.locationId,\nparameters:\"location[title_offset_left]=\"+this.offsetLeft+\"&location[title_offset_top]=\"+this.offsetTop};\n},\nresponseFromServer:function(responseJson){\n},\ntoString:function(){\nreturn \"UpdateTitleOffset: locationId=\"+this.locationId+\", offsetTop=\"+this.offsetTop+\", offsetLeft=\"+this.offsetLeft;\n}\n};\nfunction CwOverlay(map){\nthis.initialize(map);\n}\nCwOverlay.prototype={\ninitialize:function(map){\nthis.map=map;\nthis._markers={};\nthis.initOverlay();\n},\ninitOverlay:function(){\nthis.overlay=new google.maps.OverlayView();\nthis.overlay.draw=this.draw.bind(this);\nthis.overlay.onAdd=this.onAdd.bind(this);\nthis.overlay.onRemove=this.onRemove.bind(this);\nthis.overlay.setMap(this.map);\ngoogle.maps.event.addListener(this.map,'bounds_changed',this.draw.bind(this));\n},\ndraw:function(){\nvar bounds=this.map.getBounds();\nfor(var id in this._markers){\nthis.showMarker(this._markers[id],bounds);\n};\n},\nonAdd:function(){\nthis.parentNode=this.overlay.getPanes().overlayImage;\nthis.container=document.createElement(\"div\");\nthis.container.style.border=\"none\";\nthis.container.style.borderWidth=\"0px\";\nthis.container.style.position=\"absolute\";\nthis.parentNode.appendChild(this.container);\nthis.overlay.div_=this.container;\n},\nonRemove:function(){\nthis._clearContainer();\nthis.parentNode.removeChild(this.container);\nthis.container=null;\nthis.parentNode=null;\n},\ncopy:function(){\nreturn this;\n},\naddMarker:function(marker){\nif(this._markers[marker.locationId])return;\nvar bounds=this.map.getBounds();\nif(!bounds){\nsetTimeout(function(){\nthis.addMarker(marker)\n}.bind(this),100);\nreturn;\n}\nthis._markers[marker.locationId]=marker;\nthis.showMarker(marker,bounds);\n},\nremoveMarker:function(marker){\nthis.hideMarker(marker);\ndelete this._markers[marker.locationId];\n},\nshowMarker:function(marker,bounds){\nvar point=marker.getPoint();\nif(!bounds.contains(point)){\nif(marker.icon){\nthis.hideMarker(marker);\nmarker.icon=null;\n}\nreturn;\n}\nif(marker.icon){\nmarker.icon.position();\n}else{\nvar icon=marker.renderIcon(this);\n}\n},\nhideMarker:function(marker){\nmarker.removeIcon();\n},\n_clearContainer:function(){\nthis.container.innerHTML=\"\";\nfor(var id in this._markers){\nthis.hideMarker(this._markers[id]);\n}\n}\n}\nvar CwMarker=Class.create();\nCwMarker.TYPE=\"CwMarker\"\nCwMarker.prototype={\ninitialize:function(location,src,identifier,tooltipContents,wrapText,groupId,titleOffset){\nthis.type=CwMarker.TYPE;\nthis.location=location;\nthis._src=src;\nthis._identifier=identifier;\nthis._groupId=groupId;\nthis._titleOffset=titleOffset;\nthis.locationId=location.id;\nthis.tooltipContents=tooltipContents;\nthis.wrapText=wrapText;\nthis.displayed=false;\n},\nget:function(key){\nswitch(key){\ncase 'map':\nreturn U.getMap().getMapApp();\nbreak;\ncase 'anchorPoint':\nreturn this.infoWindowOffset()\nbreak;\ncase 'position':\nreturn this.getPoint();\nbreak;\ndefault:\nbreak;\n}\n},\ninitializeTooltip:function(tooltipContents,wrapText){\nvar offset=new google.maps.Size((this.icon.size.width/2/1),this.icon.size.height);\nif(!this.tooltip){\nthis.tooltip=new Tooltip(tooltipContents,wrapText,(this._titleOffset||offset),this.getPoint.bind(this),this.locationId,this._groupId);\n}\ngoogle.maps.event.addListener(this.icon.marker,\"mouseover\",this.tooltip.show.bind(this.tooltip));\ngoogle.maps.event.addListener(this.icon.marker,\"mouseout\",this.tooltip.hide.bind(this.tooltip));\ngoogle.maps.event.addListener(this.icon,\"remove\",function(){this.hide(true)}.bind(this.tooltip));\n},\nreplaceToolTipText:function(text){\nthis.tooltip.changeContents(text);\n},\nshowTooltip:function(force){\nif(this.icon)google.maps.event.trigger(this.icon.marker,\"mouseover\",force);\n},\nhideTooltip:function(force){\nif(this.icon)google.maps.event.trigger(this.icon.marker,\"mouseout\",force);\n},\nsetPosition:function(latlng){\nthis.icon.setPosition(latlng);\n},\nrenderIcon:function(overlay){\nif(this.icon)return;\nif(!overlay.container){\nsetTimeout(function(){this.renderIcon(overlay);}.bind(this),100);\nreturn;\n}\nthis.icon=new CwIcon(this._src,this._identifier,overlay.overlay,this.getPoint())\nthis.initializeTooltip(this.tooltipContents,this.wrapText);\nthis.icon.marker.onclick=this.location.handleClick.bind(this.location);\ngoogle.maps.event.addDomListener(this.icon.marker,\"click\",this.location.handleClick.bind(this.location));\noverlay.container.appendChild(this.icon.container);\nthis.displayed=true;\n},\nswitchIcon:function(src,identifier){\nthis._src=src||this._src;\nthis._identifier=identifier||this._identifier;\nif(!this.icon)return;\nthis.icon.transform(this._src,this._identifier);\n},\nremoveIcon:function(){\nif(!this.icon)return;\nthis.icon.remove();\ngoogle.maps.event.trigger(this.icon,\"remove\");\nthis.icon=null;\nthis.displayed=false;\n},\nwithinBounds:function(bounds){\nreturn bounds.contains(this.getPoint());\n},\ngetPoint:function(){\nreturn this.location.asGLatLng();\n},\nopenInfoWindowHtml:function(html){\nthis._openInfoWindowWithOpener('openInfoWindowHtml',html);\n},\nopenInfoWindowTabsHtml:function(tabs){\nthis._openInfoWindowWithOpener('openInfoWindowTabsHtml',tabs);\n},\ninfoWindowOffset:function(){\nvar iconAttributes=CwIcon.getIconAttributes(this._identifier,this._src);\nvar offsetY=iconAttributes.markerHeight-iconAttributes.windowOffsetY;\nvar offsetX=(iconAttributes.markerWidth/2)-iconAttributes.windowOffsetX;\nreturn new google.maps.Point(-offsetX,-offsetY)\n},\n_openInfoWindowWithOpener:function(opener,data){\nvar iconAttributes=CwIcon.getIconAttributes(this._identifier,this._src);\nvar offsetY=iconAttributes.markerHeight-iconAttributes.windowOffsetY;\nvar offsetX=(iconAttributes.markerWidth/2)-iconAttributes.windowOffsetX;\nvar map=U.getMap().getMapApp();\nwalkApp.closeInfoWindow();\nmap[opener](this.getPoint(),data,{pixelOffset:this.infoWindowOffset()});\n}\n}\nvar CwIcon=Class.create();\nCwIcon.SINGLE_DIGIT_MARKER={\ncontainerHeight:36,\ncontainerWidth:40,\nmarkerHeight:36,\nmarkerWidth:22,\nmarkerOffsetX:11,\nmarkerOffsetY:36,\nwindowOffsetX:11,\nwindowOffsetY:2\n};\nCwIcon.DOUBLE_DIGIT_MARKER={\ncontainerHeight:42,\ncontainerWidth:55,\nmarkerHeight:38,\nmarkerWidth:34,\nmarkerOffsetX:17,\nmarkerOffsetY:42,\nwindowOffsetX:17,\nwindowOffsetY:2\n};\nCwIcon.SMALL_MARKER={\ncontainerHeight:29,\ncontainerWidth:36,\nmarkerHeight:29,\nmarkerWidth:20,\nmarkerOffsetX:10,\nmarkerOffsetY:29,\nwindowOffsetX:10,\nwindowOffsetY:2\n};\nCwIcon.DOT_MARKER={\ncontainerHeight:8,\ncontainerWidth:10,\nmarkerHeight:8,\nmarkerWidth:10,\nmarkerOffsetX:5,\nmarkerOffsetY:8,\nwindowOffsetX:5,\nwindowOffsetY:2\n};\nCwIcon.getIconAttributes=function(identifier,customSrc){\nif(customSrc)customSrc=customSrc.replace(/\\//ig, '_').replace(/[:.-]/ig,'_');\nif(identifier==\"i\")return CwCustomIcons[customSrc];\nelse if(identifier==\"sm\")return CwIcon.SMALL_MARKER;\nelse if(identifier==\"dot\")return CwIcon.DOT_MARKER;\nelse if(identifier==\"l\")return CwIcon.SINGLE_DIGIT_MARKER;\nelse if(identifier<10)return CwIcon.SINGLE_DIGIT_MARKER;\nelse return CwIcon.DOUBLE_DIGIT_MARKER;\n};\nCwIcon.prototype={\ninitialize:function(src,identifier,overlay,point){\nthis.overlay=overlay;\nthis.point=point;\nthis.src=src;\nthis.identifier=identifier;\nthis._initializeDomElements();\nthis.transform(src,identifier);\n},\n_initializeDomElements:function(){\nthis.container=document.createElement(\"DIV\");\nthis.marker=document.createElement(\"DIV\");\nthis.text=document.createElement(\"DIV\");\nthis.container.style.position=\"absolute\";\nthis.marker.style.position=\"relative\";\nthis.container.appendChild(this.marker);\nthis.marker.appendChild(this.text);\nthis.marker.onmouseover=function(){google.maps.event.trigger(this.marker,\"mouseover\")}.bind(this);\nthis.marker.onmouseout=function(){google.maps.event.trigger(this.marker,\"mouseout\")}.bind(this);\nthis.text.onmouseover=function(){google.maps.event.trigger(this.marker,\"mouseover\")}.bind(this);\nthis.text.onmouseout=function(){google.maps.event.trigger(this.marker,\"mouseout\")}.bind(this);\n},\nsetPosition:function(point){\nthis.point=point;\nthis.position();\n},\nremove:function(){\nif(this.container.parentNode){\nthis.container.parentNode.removeChild(this.container);\n}\n},\ntransform:function(src,identifier){\nvar isIcon=src.indexOf(\"icon\")>-1;\nthis.text.innerHTML=(U.blank(identifier)||isIcon)?\"\":identifier;\nthis.container.className=\"single_digit_marker_icon\";\nthis.icon=isIcon?\"i\":\"l\";\nif(isNaN(identifier)){\nthis.icon=identifier||this.identifier;\nif(this.icon==\"i\"){\nthis.container.className=\"custom_icon\";\nif(document.all){\nthis.container.background=\"transparent\"\nthis.container.style.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src='+src+'/shadow.png,enabled=1)';\n}else{\nthis.container.style.backgroundImage=\"url(\"+src+\"/shadow.png)\";\n}\n}else if(this.icon==\"sm\"){\nthis.container.className=\"small_marker_icon\";\n}else if(this.icon==\"dot\"){\nthis.container.className=\"dot_marker_icon\";\n}\nthis.text.innerHTML=\"\";\n}else if(identifier>9&&this.icon!=\"i\"){\nthis.icon=\"big\";\nthis.container.className=\"double_digit_marker_icon\";\n}\nthis.src=src||this.src;\nif(this.iconImage)this.marker.removeChild(this.iconImage);\nif(this.printImage)this.marker.removeChild(this.printImage);\nthis.iconImage=document.createElement(\"img\");\nvar iconSrc=src+'/'+this.icon+'.png';\nif(document.all){\nthis.iconImage.src=\"/images/blank.gif\";\nthis.iconImage.style.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src='+iconSrc+',enabled=1)';\nthis.iconImage.className=\"screenonly\";\nthis.printImage=document.createElement(\"img\");\nthis.printImage.className=\"printonly\";\nthis.printImage.src=src+'/'+this.icon+'.gif';\nthis.marker.insertBefore(this.printImage,this.text);\n}else{\nthis.iconImage.src=iconSrc;\n}\nthis.marker.insertBefore(this.iconImage,this.text);\nthis.marker.className=src.substr(src.lastIndexOf(\"/\"))+\"_\"+identifier;\nthis.position();\n},\nposition:function(){\nvar iconAttributes=CwIcon.getIconAttributes(this.icon,this.src);\nthis.container.style.width=iconAttributes.containerWidth+\"px\";\nthis.container.style.height=iconAttributes.containerHeight+\"px\";\nthis.marker.style.width=iconAttributes.markerWidth+\"px\";\nthis.marker.style.height=iconAttributes.markerHeight+\"px\";\nthis.size=new google.maps.Size(iconAttributes.markerWidth,iconAttributes.markerHeight);\nthis.iconPosition=this.overlay.getProjection().fromLatLngToDivPixel(this.point);\nthis.container.style.left=(this.iconPosition.x-iconAttributes.markerOffsetX)+\"px\";\nthis.container.style.top=(this.iconPosition.y-iconAttributes.containerHeight)+\"px\";\nthis.container.style.zIndex=parseInt(1000*(90-this.point.lat()));\n}\n}\nGeocoder=Class.create();\nGeocoder.prototype={\ninitialize:function(){\nthis._googleGeocoder=new google.maps.Geocoder();\nthis._geocodeCounter=0;\n},\ngeocode:function(address,handleResultsFunction,forRedirect){\nif(address.length==0)return;\nthis._address=address;\nthis._handleResultsFunction=handleResultsFunction;\nthis._geocodeCounter++;\nthis._googleGeocode(address.replace(/\\r/ig,' ').replace(/\\n/ig,' '));\nthis._forRedirect=forRedirect?1:0;\n},\n_googleGeocode:function(address){\nthis._googleGeocoder.geocode({address:address},this._handleGoogleResults.bind(this));\n},\n_telcontarGeocode:function(address){\nvar counter=this._geocodeCounter;\nnew Ajax.Request(\"/map/find_geocoded_address/?query_type=geo&geo_address_query=\"+address+\"&geo_country_code=GB&for_redirect=\"+this._forRedirect,{\nasynchronous:true,evalScripts:true,post:true,\nonSuccess:function(request){\nif(counter!=this._geocodeCounter)return;\nvar translatedResults=JSON.parse(request.responseText);\ndebugger\nthis._handleResultsFunction(translatedResults);\n}.bind(this)\n});\n},\n_handleGoogleResults:function(googleJson){\nvar translatedResults=U.translateGoogleGeocodedResults(googleJson,true);\nif(translatedResults.length==0){\nthis._handleResultsFunction(translatedResults);\n}else{\nthis._handleResultsFunction(translatedResults);\n}\n}\n}\n\n\n\n//-->\n\n</script>\n\n\n</body>"}
