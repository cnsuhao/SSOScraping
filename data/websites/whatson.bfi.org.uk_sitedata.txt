{"link":"https://whatson.bfi.org.uk/Online/login.asp","html":"<head>\n<title>Login</title>\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<meta name=\"apple-mobile-web-app-capable\" content=\"yes\">\n\n<meta http-equiv=\"Imagetoolbar\" content=\"no\">\n\n\n<!-- inclusion of bootstrap specific CSS -->\n<!-- http://twitter.github.com for documentation on bootstrap -->\n<link rel=\"Stylesheet\" href=\"bootstrap/css/bootstrap.css\">\n<!-- end of bootstrap specific CSS -->    \n\n<link rel=\"stylesheet\" href=\"branding/global.css\" type=\"text/css\">\n\n<!--[if lt IE 9]>\n    <link rel=\"stylesheet\" href=\"branding/global_IE.css\" type=\"text/css\">\n<![endif]-->\n\n<script type=\"text/javascript\" async=\"\" src=\"//ml314.com/tag.aspx?2232017\"></script><script type=\"text/javascript\" src=\"https://cdn.krxd.net/userdata/get?pub=cabc37dd-0c34-4404-ba90-534a251ee159&amp;technographics=1&amp;callback=Krux.ns.immediate.kxjsonp_userdata\"></script><script type=\"text/javascript\" src=\"https://beacon.krxd.net/optout_check?callback=Krux.ns.immediate.kxjsonp_optOutCheck\"></script><script src=\"https://js-agent.newrelic.com/nr-632.min.js\"></script><script type=\"text/javascript\" src=\"https://beacon.krxd.net/cookie2json?callback=Krux.ns.immediate.kxjsonp_3pevents\"></script><script async=\"\" src=\"//cdn.krxd.net/ctjs/controltag.js.714934d71ca8a8cd8c474d2f7d4608ec\"></script><script type=\"text/javascript\" async=\"\" src=\"https://cdn.krxd.net/controltag?confid=KhGNDyUe\"></script><script type=\"text/javascript\" async=\"\" src=\"https://ssl.google-analytics.com/ga.js\"></script><script async=\"\" src=\"//www.googletagmanager.com/gtm.js?id=GTM-KHDW8Q\"></script><script type=\"text/javascript\" src=\"../Common/newRelic.js.asp\"></script>\n\n\n\t<link rel=\"stylesheet\" href=\"/ArticleMedia/Files/CSS/bfi-styling-201703.css\" type=\"text/css\">\n\n\n<script type=\"text/javascript\">\n\n</script>\n<script type=\"text/javascript\">\t\t\n  // Check whether cookies are enabled.\t\t\n\tdocument.cookie = \"TestCookie=1\";\n\tvar testCookie = document.cookie;\n\n\t// Try to retrieve the value we just set.\n\tif (testCookie.indexOf(\"TestCookie=1\") == -1)\n\t{\n\t\t\n\t\t    document.location = \"error.asp?nocookie=\";\n\t\t\n    }\n\telse\n\t\tdocument.cookie = \"TestCookie=;expires=Thu, 01-Jan-1970 00:00:00 GMT\";\n</script>\n<script type=\"text/javascript\" src=\"browser_detect.js\"></script>\n<script type=\"text/javascript\">\n  var genericConfirmationMessage = \"Are you sure?\";\n  var offerExpired = \"We\\'re sorry, your order has expired.\";\n  var admissionsExpired = \"An offer on one of your tickets has expired.\";\n  var alertHeaderText = \"Attention\";\n  var helpHeaderText = \"Help\";\n  var sectionHeaderText = \"More info\";\n  \n  var okayButtonText = \"OK\";\n  var cancelButtonText = \"Cancel\";\n  var closeButtonText = \"Close\";\n\n  var sTokenName = 'sToken';\n  var sToken = '1,13ed893b,58faf0ae,46E368B7-98C6-4929-A561-F8D81A7D11BD,uwxRNnKRj/hcbjuom4sxbdDjNes=';\n</script>\n<script type=\"text/javascript\" src=\"../Common/online-jscript.js\"></script>\n<script type=\"text/javascript\" src=\"../Common/online-navigation-jscript.js\"></script>\n<script type=\"text/javascript\" src=\"../Common/Widgets/widgetParent.js\"></script>\n<script type=\"text/javascript\">\n/*\n\n*/\nfunction displayMessage(onClickEvent)\n{\n\n}\n\nfunction tsOrderChanged( url )\n{\n  new showConfirmPopup( '', 'The current order has unsaved changes that may be lost. Continue anyway?', function () { document.location = url }, '' );  \n}\n\n// Used for drop-down menu in IE 6\n<!--//--><![CDATA[//><!--\nfunction startList() {\n\tif (document.all&&document.getElementById) {\n\t\tnavRoot = document.getElementById(\"menuTop\");\n\t\tfor (i=0; i<navRoot.childNodes.length; i++) {\n\t\t\tnode = navRoot.childNodes[i];\t\t\t\n\t\t\tif (node.id==\"menuTopItem\") {\n\t\t\t\tnode.onmouseover=function() {\n\t\t\t\t\tthis.className+=\" over\";\n\t\t\t\t}\n\n                node.onfocus=function(){\n                    this.className+=\" over\";\n                }\n\n\t\t\t\tnode.onmouseout=function() {\n\t\t\t\t\tthis.className=this.className.replace(\" over\", \"\");\n\t\t\t\t}\n\n                node.onblur=function() {\n\t\t\t\t\tthis.className=this.className.replace(\" over\", \"\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n//--><!]]>\n\nvar plusApi_loaded = false;\nvar twitterApi_loaded = false;\nvar fbApi_loaded = false;\n\n</script>\n<noscript>\n  &lt;meta http-equiv=\"refresh\" content=\"0; URL=error.asp\"&gt;\n</noscript>\n\n<script type=\"text/javascript\">\nfunction loadLocalPage()\n{\n}\n</script>\n\n<script type=\"text/javascript\">\n    function doGAClicks(selectedItem) {\n        //do nothing\n    };\n\n    function gaTrackEvent(category, action) {\n        //do nothing\n    };\n</script>\n\n<style type=\"text/css\">.tk-adelle{font-family:\"adelle-1\",\"adelle-2\",georgia;}.tk-soleil{font-family:\"soleil-1\",\"soleil-2\",sans-serif;}</style><style type=\"text/css\">@font-face{font-family:adelle-1;src:url(https://use.typekit.net/af/33a31d/000000000000000000012b41/26/l?subset_id=2&fvd=n7&v=3) format(\"woff2\"),url(https://use.typekit.net/af/33a31d/000000000000000000012b41/26/d?subset_id=2&fvd=n7&v=3) format(\"woff\"),url(https://use.typekit.net/af/33a31d/000000000000000000012b41/26/a?subset_id=2&fvd=n7&v=3) format(\"opentype\");font-weight:700;font-style:normal;}@font-face{font-family:adelle-1;src:url(https://use.typekit.net/af/adebb1/000000000000000000012b42/26/l?subset_id=2&fvd=i7&v=3) format(\"woff2\"),url(https://use.typekit.net/af/adebb1/000000000000000000012b42/26/d?subset_id=2&fvd=i7&v=3) format(\"woff\"),url(https://use.typekit.net/af/adebb1/000000000000000000012b42/26/a?subset_id=2&fvd=i7&v=3) format(\"opentype\");font-weight:700;font-style:italic;}@font-face{font-family:adelle-1;src:url(https://use.typekit.net/af/bdd26d/000000000000000000012b3d/26/l?subset_id=2&fvd=n4&v=3) format(\"woff2\"),url(https://use.typekit.net/af/bdd26d/000000000000000000012b3d/26/d?subset_id=2&fvd=n4&v=3) format(\"woff\"),url(https://use.typekit.net/af/bdd26d/000000000000000000012b3d/26/a?subset_id=2&fvd=n4&v=3) format(\"opentype\");font-weight:400;font-style:normal;}@font-face{font-family:adelle-1;src:url(https://use.typekit.net/af/afabe8/000000000000000000012b3e/26/l?subset_id=2&fvd=i4&v=3) format(\"woff2\"),url(https://use.typekit.net/af/afabe8/000000000000000000012b3e/26/d?subset_id=2&fvd=i4&v=3) format(\"woff\"),url(https://use.typekit.net/af/afabe8/000000000000000000012b3e/26/a?subset_id=2&fvd=i4&v=3) format(\"opentype\");font-weight:400;font-style:italic;}@font-face{font-family:adelle-1;src:url(https://use.typekit.net/af/cde114/000000000000000000012b3f/26/l?subset_id=2&fvd=n6&v=3) format(\"woff2\"),url(https://use.typekit.net/af/cde114/000000000000000000012b3f/26/d?subset_id=2&fvd=n6&v=3) format(\"woff\"),url(https://use.typekit.net/af/cde114/000000000000000000012b3f/26/a?subset_id=2&fvd=n6&v=3) format(\"opentype\");font-weight:600;font-style:normal;}@font-face{font-family:adelle-1;src:url(https://use.typekit.net/af/d819c7/000000000000000000012b40/26/l?subset_id=2&fvd=i6&v=3) format(\"woff2\"),url(https://use.typekit.net/af/d819c7/000000000000000000012b40/26/d?subset_id=2&fvd=i6&v=3) format(\"woff\"),url(https://use.typekit.net/af/d819c7/000000000000000000012b40/26/a?subset_id=2&fvd=i6&v=3) format(\"opentype\");font-weight:600;font-style:italic;}@font-face{font-family:adelle-1;src:url(https://use.typekit.net/af/4832e0/000000000000000000012b3b/26/l?subset_id=2&fvd=n3&v=3) format(\"woff2\"),url(https://use.typekit.net/af/4832e0/000000000000000000012b3b/26/d?subset_id=2&fvd=n3&v=3) format(\"woff\"),url(https://use.typekit.net/af/4832e0/000000000000000000012b3b/26/a?subset_id=2&fvd=n3&v=3) format(\"opentype\");font-weight:300;font-style:normal;}@font-face{font-family:adelle-1;src:url(https://use.typekit.net/af/f3df26/000000000000000000012b3c/26/l?subset_id=2&fvd=i3&v=3) format(\"woff2\"),url(https://use.typekit.net/af/f3df26/000000000000000000012b3c/26/d?subset_id=2&fvd=i3&v=3) format(\"woff\"),url(https://use.typekit.net/af/f3df26/000000000000000000012b3c/26/a?subset_id=2&fvd=i3&v=3) format(\"opentype\");font-weight:300;font-style:italic;}@font-face{font-family:adelle-1;src:url(https://use.typekit.net/af/17f9de/000000000000000000012b2b/26/l?subset_id=2&fvd=n1&v=3) format(\"woff2\"),url(https://use.typekit.net/af/17f9de/000000000000000000012b2b/26/d?subset_id=2&fvd=n1&v=3) format(\"woff\"),url(https://use.typekit.net/af/17f9de/000000000000000000012b2b/26/a?subset_id=2&fvd=n1&v=3) format(\"opentype\");font-weight:100;font-style:normal;}@font-face{font-family:adelle-1;src:url(https://use.typekit.net/af/387525/000000000000000000012b2c/26/l?subset_id=2&fvd=i1&v=3) format(\"woff2\"),url(https://use.typekit.net/af/387525/000000000000000000012b2c/26/d?subset_id=2&fvd=i1&v=3) format(\"woff\"),url(https://use.typekit.net/af/387525/000000000000000000012b2c/26/a?subset_id=2&fvd=i1&v=3) format(\"opentype\");font-weight:100;font-style:italic;}@font-face{font-family:soleil-1;src:url(https://use.typekit.net/af/97cd67/0000000000000000000148f6/26/l?subset_id=2&fvd=n7&v=3) format(\"woff2\"),url(https://use.typekit.net/af/97cd67/0000000000000000000148f6/26/d?subset_id=2&fvd=n7&v=3) format(\"woff\"),url(https://use.typekit.net/af/97cd67/0000000000000000000148f6/26/a?subset_id=2&fvd=n7&v=3) format(\"opentype\");font-weight:700;font-style:normal;}@font-face{font-family:soleil-1;src:url(https://use.typekit.net/af/a94f01/0000000000000000000148f1/26/l?subset_id=2&fvd=n4&v=3) format(\"woff2\"),url(https://use.typekit.net/af/a94f01/0000000000000000000148f1/26/d?subset_id=2&fvd=n4&v=3) format(\"woff\"),url(https://use.typekit.net/af/a94f01/0000000000000000000148f1/26/a?subset_id=2&fvd=n4&v=3) format(\"opentype\");font-weight:400;font-style:normal;}@font-face{font-family:soleil-1;src:url(https://use.typekit.net/af/8ebfb1/0000000000000000000148f7/26/l?subset_id=2&fvd=i7&v=3) format(\"woff2\"),url(https://use.typekit.net/af/8ebfb1/0000000000000000000148f7/26/d?subset_id=2&fvd=i7&v=3) format(\"woff\"),url(https://use.typekit.net/af/8ebfb1/0000000000000000000148f7/26/a?subset_id=2&fvd=i7&v=3) format(\"opentype\");font-weight:700;font-style:italic;}@font-face{font-family:soleil-1;src:url(https://use.typekit.net/af/c9802e/0000000000000000000148f0/26/l?subset_id=2&fvd=i4&v=3) format(\"woff2\"),url(https://use.typekit.net/af/c9802e/0000000000000000000148f0/26/d?subset_id=2&fvd=i4&v=3) format(\"woff\"),url(https://use.typekit.net/af/c9802e/0000000000000000000148f0/26/a?subset_id=2&fvd=i4&v=3) format(\"opentype\");font-weight:400;font-style:italic;}</style><script async=\"\" src=\"//static.hotjar.com/c/hotjar-34760.js?sv=5\"></script><script async=\"\" src=\"https://script.hotjar.com/modules-fa2b48a238bb646d8cc1b2e82176a64f.js\"></script><style type=\"text/css\">iframe#_hjRemoteVarsFrame {display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;}</style></head>\n<body onload=\"startList();loadLocalPage(); displayMessage(&quot;&quot;); displayOnOfferTimeout();\" onunload=\"closeChildren()\">\n\n\n\n\n<script type=\"text/javascript\">\n\nfunction testValue(value, pattern)\n{\n  if(!value || !pattern)\n    return false;\n\n  if(pattern.constructor === RegExp)\n    return pattern.test(value.toString());\n\n  return value.toString() == pattern.toString();\n}\n\nfunction isGTM()\n{\n\treturn true;\n}\n\nfunction getSessionObject()\n{\n\treturn {av: {session: {language: \"EN\", \nrole: \"Internet\", \nreferrer: null, \nuser_id: undefined, \npromo_codes: []}}};\n}\n\nfunction getErrorObject()\n{\n\t\n\treturn null;\n\t\n}\n\nfunction getPageObject()\n{\n\treturn {av: {page: { page_script: \"/Online/login.asp\", \n search: { total_records: null, \n total_pages: null, \n page_size: null, \n current_page: null, \n criteria: { search_from :null, \n search_to :null, \n search_criteria :null, \n category_filter :null, \n city_filter :null, \n venue_filter :null, \n month_filter :null, \n object_type_filter :null}}, \n articles: [{article_name: \"\", article_title: \"default header\", article_type: \"1\", article_id: \"F8103D8C-7EA0-4B4B-A37E-9DE398B9313D\"},\n{article_name: \"\", article_title: \"default footer\", article_type: \"1\", article_id: \"5D09622E-A899-411D-B525-B2F262B34B63\"}],\n\n          articleExists: function (article_type, article_title) \n          {\n            if (article_type == null && article_title == null)\n            {\n              if(this.articles.length)\n                return true;\n            }\n            else if (article_type == null)\n            {\n              for(var i = 0; i < this.articles.length; i++) {\n                  if(testValue(this.articles[i].article_title, article_title))\n                    return true;\n              }\n            }\n            else if (article_title == null)\n            {\n              for(var i = 0; i < this.articles.length; i++) {\n                if (testValue(this.articles[i].article_type, article_type))\n                  return true;\n              }\n            }\n            else\n            {\n              for(var i = 0; i < this.articles.length; i++) {\n                if (testValue(this.articles[i].article_title, article_title) && testValue(this.articles[i].article_type, article_type))\n                  return true;\n              }\n            }\n      \n            return false;\n          }\n\t}}};\n}\n\n\nfunction getOrderEventObject()\n{\n\treturn {event: {av : {event: {order: { action: \"\"}}}, toString: function() {return \"av.event.order-\" + this.av.event.order.action}}};\n}\n\nfunction getCartEventObject()\n{\n\treturn {event: {av : {event: {cart: { action: \"\"}}}, toString: function() {return \"av.event.cart-\" + this.av.event.cart.action}}};\n}\n\nfunction admissionExists(object, product_name)\n{\n\tvar ids = new Array();\n\tfor (var i = 0; i < object.performances.length; i++)\n\t{\n\t\tif (testValue(object.performances[i].name, product_name) || \n\t\t\ttestValue(object.performances[i].description, product_name) ||\n\t\t\ttestValue(object.performances[i].short_description, product_name))\n\t\t{\n\t\t\tids.push(object.performances[i].performance_id);\n\t\t}\n\t}\n\tif (ids.length > 0)\n\t{\n\t\tfor (var i = 0; i < object.order_admissions.length; i++)\n\t\t{\n\t\t\tif (ids.indexOf(object.order_admissions[i].performance_id) != -1)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction bundleExists(object, product_name)\n{\n\tvar ids = new Array();\n\tfor (var i = 0; i < object.bundles.length; i++)\n\t{\n\t\tif (testValue(object.bundles[i].name, product_name) || \n\t\t\ttestValue(object.bundles[i].description, product_name) ||\n\t\t\ttestValue(object.bundles[i].short_description, product_name))\n\t\t{\n\t\t\tids.push(object.bundles[i].bundle_id);\n\t\t}\n\t}\n\tif (ids.length > 0)\n\t{\n\t\tfor (var i = 0; i < object.order_bundle.length; i++)\n\t\t{\n\t\t\tif (ids.indexOf(object.order_bundle[i].bundle_id) != -1)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction miscItemExists(object, product_name)\n{\n\tvar ids = new Array();\n\tfor (var i = 0; i < object.misc_items.length; i++)\n\t{\n\t\tif (testValue(object.misc_items[i].name, product_name) || \n\t\t\ttestValue(object.misc_items[i].description, product_name) ||\n\t\t\ttestValue(object.misc_items[i].short_description, product_name))\n\t\t{\n\t\t\tids.push(object.misc_items[i].miscellaneous_item_id);\n\t\t}\n\t}\n\tif (ids.length > 0)\n\t{\n\t\tfor (var i = 0; i < object.order_misc_items.length; i++)\n\t\t{\n\t\t\tif (ids.indexOf(object.order_misc_items[i].item_id) != -1)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction giftExists(object, product_name)\n{\n\tvar ids = new Array();\n\tfor (var i = 0; i < object.gifts.length; i++)\n\t{\n\t\tif (testValue(object.gifts[i].name, product_name) || \n\t\t\ttestValue(object.gifts[i].description, product_name) ||\n\t\t\ttestValue(object.gifts[i].short_description, product_name))\n\t\t{\n\t\t\tids.push(object.gifts[i].gift_id);\n\t\t}\n\t}\n\tif (ids.length > 0)\n\t{\n\t\tfor (var i = 0; i < object.order_gifts.length; i++)\n\t\t{\n\t\t\tif (ids.indexOf(object.order_gifts[i].gift_id) != -1)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction storeValueExists(object, product_name)\n{\n\tvar ids = new Array();\n\tfor (var i = 0; i < object.stored_values.length; i++)\n\t{\n\t\tif (testValue(object.stored_values[i].name, product_name) || \n\t\t\ttestValue(object.stored_values[i].description, product_name) ||\n\t\t\ttestValue(object.stored_values[i].short_description, product_name))\n\t\t{\n\t\t\tids.push(object.stored_values[i].stored_value_id);\n\t\t}\n\t}\n\tif (ids.length > 0)\n\t{\n\t\tfor (var i = 0; i < object.order_stored_values.length; i++)\n\t\t{\n\t\t\tif (ids.indexOf(object.order_stored_values[i].stored_value_id) != -1)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction productExists(object, product_type, product_name)\n{\n\tvar result = false;\n\tif (product_name == null && product_type == null)\n\t{\n\t\tif (object.order_admissions.length || object.order_bundle.length || object.order_misc_items.length ||\n\t\tobject.order_gifts.length || object.order_stored_values.length)\n\t\t\tresult = true;\n\t}\n\telse if (product_name == null)\n\t{\n\t\tif (testValue(product_type, \"admission\") && object.order_admissions.length)\n\t\t\tresult = true;\n\t\tif (testValue(product_type, \"bundle\") && object.order_bundle.length)\n\t\t\tresult = true;\n\t\tif (testValue(product_type, \"miscellaneous_item\") && object.order_misc_items.length)\n\t\t\tresult = true;\n\t\tif (testValue(product_type, \"gift\") && object.order_gifts.length)\n\t\t\tresult = true;\n\t\tif (testValue(product_type, \"stored_value\") && object.order_stored_values.length)\n\t\t\tresult = true;\n\t}\n\telse if (product_type == null)\n\t{\n\t\tif (object.order_admissions.length)\n\t\t{\n\t\t\tresult = admissionExists(object, product_name);\n\t\t}\n\t\tif (object.order_bundle.length)\n\t\t{\n\t\t\tresult = bundleExists(object, product_name);\n\t\t}\n\t\tif (object.order_misc_items.length)\n\t\t{\n\t\t\tresult = miscItemExists(object, product_name);\n\t\t}\n\t\tif (object.order_gifts.length)\n\t\t{\n\t\t\tresult = giftExists(object, product_name);\n\t\t}\n\t\tif (object.order_stored_values.length)\n\t\t{\n\t\t\tresult = storeValueExists(object, product_name);\n\t\t}\n\t}\n\telse\n\t{\n\t\tif (testValue(product_type, \"admission\") && object.order_admissions.length)\n\t\t{\n\t\t\tresult = admissionExists(object, product_name);\n\t\t}\n\t\tif (testValue(product_type, \"bundle\") && object.bundles.length)\n\t\t{\n\t\t\tresult = bundleExists(object, product_name);\n\t\t}\n\t\tif (testValue(product_type, \"miscellaneous_item\") && object.misc_items.length)\n\t\t{\n\t\t\tresult = miscItemExists(object, product_name);\n\t\t}\n\t\tif (testValue(product_type, \"gift\") && object.gifts.length)\n\t\t{\n\t\t\tresult = giftExists(object, product_name);\n\t\t}\n\t\tif (testValue(product_type, \"stored_value\") && object.stored_values.length)\n\t\t{\n\t\t\tresult = storeValueExists(object, product_name);\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction admissionValue(object, product_name)\n{\n\tvar id = new Array();\n\tvar result = 0;\n\tfor (var i = 0; i < object.performances.length; i++)\n\t{\n\t\tif (testValue(object.performances[i].name, product_name) || \n\t\t\ttestValue(object.performances[i].description, product_name) ||\n\t\t\ttestValue(object.performances[i].short_description, product_name))\n\t\t{\n\t\t\tid.push(object.performances[i].performance_id);\n\t\t}\n\t}\n\tif (id.length > 0)\n\t{\n\t\tfor (var i = 0; i < object.order_admissions.length; i++)\n\t\t{\n\t\t\tif (id.indexOf(object.order_admissions[i].performance_id) != -1)\n\t\t\t{\n\t\t\t\tresult += object.order_admissions[i].amount.amount;\n\t\t\t}\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction bundleValue(object, product_name)\n{\n\tvar id = new Array();\n\tvar result = 0;\n\tfor (var i = 0; i < object.bundles.length; i++)\n\t{\n\t\tif (testValue(object.bundles[i].name, product_name) || \n\t\t\ttestValue(object.bundles[i].description, product_name) ||\n\t\t\ttestValue(object.bundles[i].short_description, product_name))\n\t\t{\n\t\t\tid.push(object.bundles[i].bundle_id);\n\t\t}\n\t}\n\tif (id.length > 0)\n\t{\n\t\tfor (var i = 0; i < object.order_bundle_admissions.length; i++)\n\t\t{\n\t\t\tif (id.indexOf(object.order_bundle_admissions[i].bundle_id) != -1)\n\t\t\t{\n\t\t\t\tresult += object.order_bundle_admissions[i].amount.amount;\n\t\t\t}\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction miscItemValue(object, product_name)\n{\n\tvar id = new Array();\n\tvar result = 0;\n\tfor (var i = 0; i < object.misc_items.length; i++)\n\t{\n\t\tif (testValue(object.misc_items[i].name, product_name) || \n\t\t\ttestValue(object.misc_items[i].description, product_name) ||\n\t\t\ttestValue(object.misc_items[i].short_description, product_name))\n\t\t{\n\t\t\tid.push(object.misc_items[i].miscellaneous_item_id);\n\t\t}\n\t}\n\tif (id.length > 0)\n\t{\n\t\tfor (var i = 0; i < object.order_misc_items.length; i++)\n\t\t{\n\t\t\tif (id.indexOf(object.order_misc_items[i].item_id) != -1)\n\t\t\t{\n\t\t\t\tresult += object.order_misc_items[i].amount.amount;\n\t\t\t}\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction giftValue(object, product_name)\n{\n\tvar id = new Array();\n\tvar result = 0;\n\tfor (var i = 0; i < object.gifts.length; i++)\n\t{\n\t\tif (testValue(object.gifts[i].name, product_name) || \n\t\t\ttestValue(object.gifts[i].description, product_name) ||\n\t\t\ttestValue(object.gifts[i].short_description, product_name))\n\t\t{\n\t\t\tid.push(object.gifts[i].gift_id);\n\t\t}\n\t}\n\tif (id.length > 0)\n\t{\n\t\tfor (var i = 0; i < object.order_gifts.length; i++)\n\t\t{\n\t\t\tif (id.indexOf(object.order_gifts[i].gift_id) != -1)\n\t\t\t{\n\t\t\t\tresult += object.order_gifts[i].pledge_amount.amount;\n\t\t\t}\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction storedValueValue(object, product_name)\n{\n\tvar id = new Array();\n\tvar result = 0;\n\tfor (var i = 0; i < object.stored_values.length; i++)\n\t{\n\t\tif (testValue(object.stored_values[i].name, product_name) || \n\t\t\ttestValue(object.stored_values[i].description, product_name) ||\n\t\t\ttestValue(object.stored_values[i].short_description, product_name))\n\t\t{\n\t\t\tid.push(object.stored_values[i].stored_value_id);\n\t\t}\n\t}\n\tif (id.length > 0)\n\t{\n\t\tfor (var i = 0; i < object.order_stored_values.length; i++)\n\t\t{\n\t\t\tif (id.indexOf(object.order_stored_values[i].stored_value_id) != -1)\n\t\t\t{\n\t\t\t\tresult += object.order_stored_values[i].amount.amount;\n\t\t\t}\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction productValue(object, product_type, product_name)\n{\n\tvar result = 0;\n\tif (product_name == null && product_type == null)\n\t{\n\t\tif (object.order_admissions.length)\n\t\t{\n\t\t\tfor (var i = 0; i < object.order_admissions.length; i++)\n\t\t\t{\n\t\t\t\tresult += object.order_admissions[i].amount.amount;\n\t\t\t}\n\t\t}\n\t\tif (object.order_bundle_admissions.length)\n\t\t{\n\t\t\tfor (var i = 0; i < object.order_bundle_admissions.length; i++)\n\t\t\t{\n\t\t\t\tresult += object.order_bundle_admissions[i].amount.amount;\n\t\t\t}\n\t\t}\n\t\tif (object.order_misc_items.length)\n\t\t{\n\t\t\tfor (var i = 0; i < object.order_misc_items.length; i++)\n\t\t\t{\n\t\t\t\tresult += object.order_misc_items[i].amount.amount;\n\t\t\t}\n\t\t}\n\t\tif (object.order_gifts.length)\n\t\t{\n\t\t\tfor (var i = 0; i < object.order_gifts.length; i++)\n\t\t\t{\n\t\t\t\tresult += object.order_gifts[i].pledge_amount.amount;\n\t\t\t}\n\t\t}\n\t\tif (object.order_stored_values.length)\n\t\t{\n\t\t\tfor (var i = 0; i < object.order_stored_values.length; i++)\n\t\t\t{\n\t\t\t\tresult += object.order_stored_values[i].amount.amount;\n\t\t\t}\n\t\t}\n\t}\n\telse if (product_name == null)\n\t{\n\t\tif (testValue(product_type, \"admission\") && object.order_admissions.length)\n\t\t{\n\t\t\tfor (var i = 0; i < object.order_admissions.length; i++)\n\t\t\t{\n\t\t\t\tresult += object.order_admissions[i].amount.amount;\n\t\t\t}\n\t\t}\n\t\tif (testValue(product_type, \"bundle\") && object.order_bundle_admissions.length)\n\t\t{\n\t\t\tfor (var i = 0; i < object.order_bundle_admissions.length; i++)\n\t\t\t{\n\t\t\t\tresult += object.order_bundle_admissions[i].amount.amount;\n\t\t\t}\n\t\t}\n\t\tif (testValue(product_type, \"miscellaneous_item\") && object.order_misc_items.length)\n\t\t{\n\t\t\tfor (var i = 0; i < object.order_misc_items.length; i++)\n\t\t\t{\n\t\t\t\tresult += object.order_misc_items[i].amount.amount;\n\t\t\t}\n\t\t}\n\t\tif (testValue(product_type, \"gift\") && object.order_gifts.length)\n\t\t{\n\t\t\tfor (var i = 0; i < object.order_gifts.length; i++)\n\t\t\t{\n\t\t\t\tresult += object.order_gifts[i].pledge_amount.amount;\n\t\t\t}\n\t\t}\n\t\tif (testValue(product_type, \"stored_value\") && object.order_stored_values.length)\n\t\t{\n\t\t\tfor (var i = 0; i < object.order_stored_values.length; i++)\n\t\t\t{\n\t\t\t\tresult += object.order_stored_values[i].amount.amount;\n\t\t\t}\n\t\t}\n\t}\n\telse if (product_type == null)\n\t{\n\t\tif (object.order_admissions.length)\n\t\t{\n\t\t\tresult += admissionValue(object, product_name);\n\t\t}\n\t\tif (object.order_bundle_admissions.length)\n\t\t{\n\t\t\tresult += bundleValue(object, product_name);\n\t\t}\n\t\tif (object.order_misc_items.length)\n\t\t{\n\t\t\tresult += miscItemValue(object, product_name);\n\t\t}\n\t\tif (object.order_gifts.length)\n\t\t{\n\t\t\tresult += giftValue(object, product_name);\n\t\t}\n\t\tif (object.order_stored_values.length)\n\t\t{\n\t\t\tresult += storedValueValue(object, product_name);\n\t\t}\n\t}\n\telse\n\t{\n\t\tif (testValue(product_type, \"admission\") && object.order_admissions.length)\n\t\t{\n\t\t\tresult += admissionValue(object, product_name);\n\t\t}\n\t\telse if (testValue(product_type, \"bundle\") && object.bundles.length)\n\t\t{\n\t\t\tresult += bundleValue(object, product_name);\n\t\t}\n\t\telse if (testValue(product_type, \"miscellaneous_item\") && object.misc_items.length)\n\t\t{\n\t\t\tresult += miscItemValue(object, product_name);\n\t\t}\n\t\telse if (testValue(product_type, \"gift\") && object.gifts.length)\n\t\t{\n\t\t\tresult += giftValue(object, product_name);\n\t\t}\n\t\telse if (testValue(product_type, \"stored_value\") && object.stored_values.length)\n\t\t{\n\t\t\tresult += storedValueValue(object, product_name);\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction admissionCount(object, product_name)\n{\n\tvar id = new Array();\n\tvar result = 0;\n\tfor (var i = 0; i < object.performances.length; i++)\n\t{\n\t\tif (testValue(object.performances[i].name, product_name) || \n\t\t\ttestValue(object.performances[i].description, product_name) ||\n\t\t\ttestValue(object.performances[i].short_description, product_name))\n\t\t{\n\t\t\tid.push(object.performances[i].performance_id);\n\t\t}\n\t}\n\tif (id.length > 0)\n\t{\n\t\tfor (var i = 0; i < object.order_admissions.length; i++)\n\t\t{\n\t\t\tif (id.indexOf(object.order_admissions[i].performance_id) != -1)\n\t\t\t{\n\t\t\t\tresult ++;\n\t\t\t}\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction bundleCount(object, product_name)\n{\n\tvar id = new Array();\n\tvar result = 0;\n\tfor (var i = 0; i < object.bundles.length; i++)\n\t{\n\t\tif (testValue(object.bundles[i].name, product_name) || \n\t\t\ttestValue(object.bundles[i].description, product_name) ||\n\t\t\ttestValue(object.bundles[i].short_description, product_name))\n\t\t{\n\t\t\tid.push(object.bundles[i].bundle_id);\n\t\t}\n\t}\n\tif (id.length > 0 && object.order_bundle_admissions.length)\n\t{\n\t\tfor (var i = 0; i < object.order_bundle_admissions.length; i++)\n\t\t{\n\t\t\tif (id.indexOf(object.order_bundle_admissions[i].bundle_id) != -1)\n\t\t\t{\n\t\t\t\tresult ++;\n\t\t\t}\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction miscItemCount(object, product_name)\n{\n\tvar id = new Array();\n\tvar result = 0;\n\tfor (var i = 0; i < object.misc_items.length; i++)\n\t{\n\t\tif (testValue(object.misc_items[i].name, product_name) || \n\t\t\ttestValue(object.misc_items[i].description, product_name) ||\n\t\t\ttestValue(object.misc_items[i].short_description, product_name))\n\t\t{\n\t\t\tid.push(object.misc_items[i].miscellaneous_item_id);\n\t\t}\n\t}\n\tif (id.length > 0 && object.order_misc_items.length)\n\t{\n\t\tfor (var i = 0; i < object.order_misc_items.length; i++)\n\t\t{\n\t\t\tif (id.indexOf(object.order_misc_items[i].item_id) != -1)\n\t\t\t{\n\t\t\t\tresult += parseFloat(object.order_misc_items[i].quantity);\n\t\t\t}\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction giftCount(object, product_name)\n{\n\tvar id = new Array();\n\tvar result = 0;\n\tfor (var i = 0; i < object.gifts.length; i++)\n\t{\n\t\tif (testValue(object.gifts[i].name, product_name) || \n\t\t\ttestValue(object.gifts[i].description, product_name) ||\n\t\t\ttestValue(object.gifts[i].short_description, product_name))\n\t\t{\n\t\t\tid.push(object.gifts[i].gift_id);\n\t\t}\n\t}\n\tif (id.length > 0)\n\t{\n\t\tfor (var i = 0; i < object.order_gifts.length; i++)\n\t\t{\n\t\t\tif (id.indexOf(object.order_gifts[i].gift_id) != -1)\n\t\t\t{\n\t\t\t\tresult ++;\n\t\t\t}\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction storedValueCount(object, product_name)\n{\n\tvar id = new Array();\n\tvar result = 0;\n\tfor (var i = 0; i < object.stored_values.length; i++)\n\t{\n\t\tif (testValue(object.stored_values[i].name, product_name) || \n\t\t\ttestValue(object.stored_values[i].description, product_name) ||\n\t\t\ttestValue(object.stored_values[i].short_description, product_name))\n\t\t{\n\t\t\tid.push(object.stored_values[i].stored_value_id);\n\t\t}\n\t}\n\tif (id.length > 0)\n\t{\n\t\tfor (var i = 0; i < object.order_stored_values.length; i++)\n\t\t{\n\t\t\tif (id.indexOf(object.order_stored_values[i].stored_value_id) != -1)\n\t\t\t{\n\t\t\t\tresult ++;\n\t\t\t}\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction productCount(object, product_type, product_name)\n{\n\tvar result = 0;\n\tif (product_name == null && product_type == null)\n\t{\n\t\tif (object.order_admissions.length)\n\t\t{\n\t\t\tresult += object.order_admissions.length;\n\t\t}\n\t\tif (object.order_bundle_admissions.length)\n\t\t{\n\t\t\tresult += object.order_bundle_admissions.length;\n\t\t}\n\t\tif (object.order_misc_items.length)\n\t\t{\n\t\t\tfor (var i = 0; i < object.order_misc_items.length; i++)\n\t\t\t\tresult += parseFloat(object.order_misc_items[i].quantity);\n\t\t}\n\t\tif (object.order_gifts.length)\n\t\t{\n\t\t\tresult += object.order_gifts.length;\n\t\t}\n\t\tif (object.order_stored_values.length)\n\t\t{\n\t\t\tresult += object.order_stored_values.length;\n\t\t}\n\t}\n\telse if (product_name == null)\n\t{\n\t\tif (testValue(product_type, \"admission\") && object.order_admissions.length)\n\t\t{\n\t\t\tresult += object.order_admissions.length;\n\t\t}\n\t\tif (testValue(product_type, \"bundle\") && object.order_bundle_admissions.length)\n\t\t{\n\t\t\tresult += object.order_bundle_admissions.length;\n\t\t}\n\t\tif (testValue(product_type, \"miscellaneous_item\") && object.order_misc_items.length)\n\t\t{\n\t\t\tfor (var i = 0; i < object.order_misc_items.length; i++)\n\t\t\t\tresult += parseFloat(object.order_misc_items[i].quantity);\n\t\t}\n\t\tif (testValue(product_type, \"gift\") && object.order_gifts.length)\n\t\t{\n\t\t\tresult += object.order_gifts.length;\n\t\t}\n\t\tif (testValue(product_type, \"stored_value\") && object.order_stored_values.length)\n\t\t{\n\t\t\tresult += object.order_stored_values.length;\n\t\t}\n\t}\n\telse if (product_type == null)\n\t{\n\t\tif (object.order_admissions.length)\n\t\t{\n\t\t\tresult += admissionCount(object, product_name);\n\t\t}\n\t\tif (object.order_bundle_admissions.length)\n\t\t{\n\t\t\tresult += bundleCount(object, product_name);\n\t\t}\n\t\tif (object.order_misc_items.length)\n\t\t{\n\t\t\tresult += miscItemCount(object, product_name);\n\t\t}\n\t\tif (object.order_gifts.length)\n\t\t{\n\t\t\tresult += giftCount(object, product_name);\n\t\t}\n\t\tif (object.stored_values.length)\n\t\t{\n\t\t\tresult += storedValueCount(object, product_name);\n\t\t}\n\t}\n\telse\n\t{\n\t\tif (testValue(product_type, \"admission\") && object.order_admissions.length)\n\t\t{\n\t\t\tresult += admissionCount(object, product_name);\n\t\t}\n\t\tif (testValue(product_type, \"bundle\") && object.order_bundle_admissions.length)\n\t\t{\n\t\t\tresult += bundleCount(object, product_name);\n\t\t}\n\t\tif (testValue(product_type, \"miscellaneous_item\") && object.order_misc_items.length)\n\t\t{\n\t\t\tresult += miscItemCount(object, product_name);\n\t\t}\n\t\tif (testValue(product_type, \"gift\") && object.order_gifts.length)\n\t\t{\n\t\t\tresult += giftCount(object, product_name);\n\t\t}\n\t\tif (testValue(product_type, \"stored_value\") && object.order_stored_values.length)\n\t\t{\n\t\t\tresult += storedValueCount(object, product_name);\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction getPerformance(object, performance_id)\n{\n\tvar result = null;\n\t\n\tif (performance_id != null && object.performances.length)\n\t{\n\t\tfor (var i = 0; i < object.performances.length; i++)\n\t\t{\n\t\t\tif (testValue(object.performances[i].performance_id, performance_id))\n\t\t\t{\n\t\t\t\tresult = object.performances[i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t} \n\t}\n\t\n\treturn result;\n}\n\nfunction getBundle(object, bundle_id)\n{\n\tvar result = null;\n\t\n\tif (bundle_id != null && object.bundles.length)\n\t{\n\t\tfor (var i = 0; i < object.bundles.length; i++)\n\t\t{\n\t\t\tif (testValue(object.bundles[i].bundle_id, bundle_id))\n\t\t\t{\n\t\t\t\tresult = object.bundles[i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t} \n\t}\n\t\n\treturn result;\n}\n\nfunction getMiscItem(object, miscitem_id)\n{\n\tvar result = null;\n\t\n\tif (miscitem_id != null && object.misc_items.length)\n\t{\n\t\tfor (var i = 0; i < object.misc_items.length; i++)\n\t\t{\n\t\t\tif (testValue(object.misc_items[i].miscellaneous_item_id, miscitem_id))\n\t\t\t{\n\t\t\t\tresult = object.misc_items[i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t} \n\t}\n\t\n\treturn result;\n}\n\nfunction getGift(object, gift_id)\n{\n\tvar result = null;\n\t\n\tif (gift_id != null && object.gifts.length)\n\t{\n\t\tfor (var i = 0; i < object.gifts.length; i++)\n\t\t{\n\t\t\tif (testValue(object.gifts[i].gift_id, gift_id))\n\t\t\t{\n\t\t\t\tresult = object.gifts[i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t} \n\t}\n\t\n\treturn result;\n}\n\nfunction getStoredValue(object, storedvalue_id)\n{\n\tvar result = null;\n\t\n\tif (storedvalue_id != null && object.stored_values.length)\n\t{\n\t\tfor (var i = 0; i < object.stored_values.length; i++)\n\t\t{\n\t\t\tif (testValue(object.stored_values[i].stored_value_id, storedvalue_id))\n\t\t\t{\n\t\t\t\tresult = object.stored_values[i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t} \n\t}\n\t\n\treturn result;\n}\n\nfunction createGAAdmissions(object, transactionProducts)\n{\n\tif( object.order_admissions.length > 0 )\n\t{\n\t\tvar admissionList = new Array();\n        var admissionPTList = new Array();\n\t\tfor (var i = 0; i < object.order_admissions.length; i++)\n\t\t{\n            var perfID = object.order_admissions[i].performance_id;\n\t\t\tif( admissionList[ perfID ] == undefined )\n            {\n              admissionList[ perfID ] = new Array();\n            }\n            admissionList[ perfID ].push( object.order_admissions[i] );\n\n            if( admissionPTList[ perfID ] == undefined )\n            {\n              admissionPTList[ perfID ] = new Array();\n            }\n            var curPTList = admissionPTList[ perfID ];\n            var admPTID = object.order_admissions[i].price_type;\n            if (curPTList[ admPTID ] == undefined )\n            {\n              curPTList[ admPTID ] = new Array();\n            }\n            curPTList[ admPTID ].push( object.order_admissions[i] );\n\t\t}\n\t\tfor( var guid in admissionList )\n\t\t{\n\t\t\tvar admNode = admissionList[ guid ][ 0 ];\n            var perfID = admNode.performance_id;\n\t\t\tvar perfNode;\n\t\t\tfor (var i = 0; i < object.performances.length; i++)\n\t\t\t{\n\t\t\t\tif (perfID == object.performances[i].performance_id)\n\t\t\t\t{\n\t\t\t\t\tperfNode = object.performances[i];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}          \n            var perfName = perfNode.name;\n            var perfDesc = perfNode.short_description;\n            if (perfDesc == \"\" || perfDesc == null) {\n               perfDesc = perfName;\n            }\n            var seriesName = perfNode.series_name;\n\n            var curPTList = admissionPTList[ perfID ];\n\t\t\tfor ( var guid in curPTList )\n\t\t\t{\n\t\t\t\tseatNode = curPTList[ guid ][ 0 ];\n                var admAmount = seatNode.amount.amount;\n                var priceTypeLabel = seatNode.price_type;\n                var priceZoneLabel = seatNode.price_zone;\n\n\t\t\t\tvar admissions = { \"sku\": perfName + \" Admission \" + priceTypeLabel + \"-\" + priceZoneLabel,\n\t\t\t\t\"name\": perfDesc + \" Admission\", \n\t\t\t\t\"category\": seriesName + \" Admission\",\n\t\t\t\t\"price\": admAmount,\n\t\t\t\t\"quantity\": curPTList[ guid ].length\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\ttransactionProducts.push(admissions);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction createGABundles(object, transactionProducts)\n{\n\t// roll up bundles by id and price\n\t// object.order_bundle - data about the bundle on the order: amount, total\n\t// object.bundles - data about the bundle item: name & description\n\n\tif( object.bundles.length > 0 )\n\t{\n\t\tvar bundleList = {};\n\t\tfor (var i = 0; i < object.order_bundle.length; i++)\n\t\t{\n\t\t\tvar bundleID = object.order_bundle[i].bundle_id;\n\t\t\tvar bundleAmount = object.order_bundle[i].amount.amount;\n\t\t\t\n\t\t\tif( bundleList[ bundleID ] == undefined )\n\t\t\t{\n\t\t\t\tbundleList[ bundleID ] = {};\n\t\t\t}\n\t\t\tif( bundleList[ bundleID ][ bundleAmount ] == undefined )\n\t\t\t{\n\t\t\t\tbundleList[ bundleID ][ bundleAmount ] = 0;\n\t\t\t}\n\t\t\tbundleList[ bundleID ][ bundleAmount ]++;\n\t\t}\n\t\t\n\t\tfor (var i = 0; i < object.bundles.length; i++)\n\t\t{\n\t\t\tvar bundleID = object.bundles[i].bundle_id;\n\t\t\tvar sku = object.bundles[i].name;\n\t\t\tvar name = object.bundles[i].description;\n\t\t\t\n\t\t\tfor(var amount in bundleList[bundleID])\n\t\t\t{\n\t\t\t\ttransactionProducts.push(\n\t\t\t\t{\n\t\t\t\t\t\"sku\": sku,\n\t\t\t\t\t\"name\": name, \n\t\t\t\t\t\"price\": amount,\n\t\t\t\t\t\"quantity\": bundleList[bundleID][amount]\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction createGAMiscItems(object, transactionProducts)\n{\n\tif( object.misc_items.length > 0 && object.order_misc_items.length > 0)\n\t{\n\t\tvar itemList = new Array();\n\t\tvar itemAmountList = new Array();\n\t\tfor (var i = 0; i < object.order_misc_items.length; i++)\n\t\t{\n\t\t\tvar itemID = object.order_misc_items[i].item_id;\n\t\t\tif( itemList[ itemID ] == undefined )\n            {\n              itemList[ itemID ] = new Array();\n            }\n            itemList[ itemID ].push( object.order_misc_items[i] );\n\t\t\tif( itemAmountList[ itemID ] == undefined )\n              itemAmountList[ itemID ] = parseFloat(object.order_misc_items[i].amount.amount);\n\t\t}\n\t\tfor (var i = 0; i < object.misc_items.length; i++)\n\t\t{\n\t\t\tvar miscItems = { \"sku\": object.misc_items[i].name,\n\t\t\t\"name\": object.misc_items[i].description, \n\t\t\t\"category\": object.misc_items[i].category, \n\t\t\t\"price\": itemAmountList[object.misc_items[i].miscellaneous_item_id],\n\t\t\t\"quantity\": itemList[object.misc_items[i].miscellaneous_item_id].length\n\t\t\t};\n\t\t\t\n\t\t\ttransactionProducts.push(miscItems);\n\t\t}\n\t}\n}\n\nfunction createGAGifts(object, transactionProducts)\n{\n\tif( object.gifts.length > 0 && object.order_gifts.length > 0)\n\t{\n\t\tvar giftList = new Array();\n\t\tfor (var i = 0; i < object.gifts.length; i++)\n\t\t{\n\t\t\tvar giftID = object.gifts[i].gift_id;\n\t\t\tif( giftList[ giftID ] == undefined )\n            {\n              giftList[ giftID ] = new Array();\n            }\n            giftList[ giftID ] = object.gifts[i].name;\n\t\t}\n\t\tfor (var i = 0; i < object.order_gifts.length; i++)\n\t\t{\n\t\t\tvar gifts = { \"sku\": giftList[object.order_gifts[i].gift_id],\n\t\t\t\"name\": object.order_gifts[i].appeal_id, \n\t\t\t\"category\": object.order_gifts[i].fund, \n\t\t\t\"price\": object.order_gifts[i].pledge_paid_amount.amount,\n\t\t\t\"quantity\": 1\n\t\t\t};\n\t\t\t\n\t\t\ttransactionProducts.push(gifts);\n\t\t}\n\t}\n}\n\nfunction createGAStoredValueItems(object, transactionProducts)\n{\n\tif( object.stored_values.length > 0 )\n\t{\n\t\tvar storedValueNameList = new Array();\n        var storedValueTypeList = new Array();\n        var storedValueDescList = new Array();\n\t\tfor (var i = 0; i < object.stored_values.length; i++)\n\t\t{\n\t\t\tvar certID = object.stored_values[i].stored_value_id;\n\t\t\tif( storedValueNameList[ certID ] == undefined )\n            {\n              storedValueNameList[ certID ] = new Array();\n              storedValueTypeList[ certID ] = new Array();\n              storedValueDescList[ certID ] = new Array();\n            }\n            storedValueNameList[ certID ] = object.stored_values[i].name;\n            storedValueDescList[ certID ] = object.stored_values[i].description;\n            storedValueTypeList[ certID ] = object.stored_values[i].type;\n\t\t}\n\t\tfor (var i = 0; i < object.order_stored_values.length; i++)\n\t\t{\n\t\t\tvar storedValueItems = { \"sku\": storedValueNameList[object.order_stored_values[i].stored_value_id],\n\t\t\t\"name\": storedValueDescList[object.order_stored_values[i].stored_value_id], \n\t\t\t\"category\": storedValueTypeList[object.order_stored_values[i].stored_value_id], \n\t\t\t\"price\": parseFloat(object.order_stored_values[i].amount.amount),\n\t\t\t\"quantity\": 1\n\t\t\t};\n\t\t\t\n\t\t\ttransactionProducts.push(storedValueItems);\n\t\t}\n\t}\n}\n\nfunction createGATransaction(object)\n{\n\tvar output;\n\tvar transactionProducts = new Array;\n\t\n\tcreateGAAdmissions(object, transactionProducts);\n\tcreateGABundles(object, transactionProducts);\n\tcreateGAMiscItems(object, transactionProducts);\n\tcreateGAGifts(object, transactionProducts);\n\tcreateGAStoredValueItems(object, transactionProducts);\n\t\n\toutput = { \"transactionId\": object.order_number.toString(),\n\t\t\t\t\"transactionAffiliation\": object.affiliation == null ? \"\" : object.affiliation.toString(), \n\t\t\t\t\"transactionTotal\": object.grand_total.amount,\n\t\t\t\t\"transactionTax\": object.total_tax.amount,\n\t\t\t\t\"transactionShipping\": object.delivery_charges.amount,\n\t\t\t\t\"transactionCity\": object.customer_city == null ? \"\" : object.customer_city.toString(),\n\t\t\t\t\"transactionState\": object.customer_state == null ? \"\" : object.customer_state.toString(),\n\t\t\t\t\"transactionCountry\": object.customer_country == null ? \"\" : object.customer_country.toString(),\n\t\t\t\t\"transactionProducts\": transactionProducts\n\t\t\t};\n\t\n\treturn output;\n}\n\n\n</script>\n\n\t<script type=\"text/javascript\">\n\t\tvar dataLayer = new Array();\n\t\tdataLayer.push(getSessionObject());\n\t\tdataLayer.push(getPageObject());\n\t\tvar av_error = getErrorObject();\n\t\tif (av_error != null)\n\t\t\tdataLayer.push(av_error);\n\t\t\n\t</script>\n\t<!-- Google Tag Manager -->\n\t<noscript>&lt;iframe src=\"//www.googletagmanager.com/ns.html?id=GTM-KHDW8Q\"\n\theight=\"0\" width=\"0\" style=\"display:none;visibility:hidden\"&gt;&lt;/iframe&gt;</noscript>\n\t<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\n\tnew Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\n\tj=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n\t'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n\t})(window,document,'script','dataLayer','GTM-KHDW8Q');</script>\n\t<!-- End Google Tag Manager -->\n\t\n<div id=\"header\">\n\n        <div class=\"header-content container\">\n        <div id=\"header-wrapper\" xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:av=\"http://www.audienceview.com/xml/email/\">\n\t<a href=\"http://www.bfi.org.uk\" shape=\"rect\"><img alt=\"British Film Institute logo\" src=\"/ArticleMedia/Images/branding/bfi-white-107x107.png\" style=\"width: 107px; height: 107px;\">\n</a>\n</div>\n\n        </div>\n\n    <a class=\"menu-toggle menu-button btn btn-default\">\n        <span class=\"glyphicon glyphicon-align-justify\"></span>\n    </a>\n    <a class=\"menu-toggle sidebar-button btn btn-default\">\n        <span class=\"glyphicon glyphicon-shopping-cart\"></span>\n        \n\n\n    </a>\n</div>\n\n<div class=\"content-wrapper\">\n    <div id=\"menu\">\n        <div class=\"menuContainer main-nav\">\n\n            <ul id=\"menuTop\" class=\"nav clearfix\">\n                    \n                            <li class=\"menuTopItem  has-sub-menu clearfix\" id=\"menuTopItem0\">\n\n\n                                \n                                         <a tabindex=\"1\" href=\"films-tv?menu_id=ACF37CA9-756D-4B69-AD07-C8BBBD49BBEF&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" class=\"menu_item menu-link\" title=\"Films &amp; TV\">\n                                            <span class=\"menu-label\">Films &amp; TV</span>\n                                        </a>\n                                        <a tabindex=\"2\" href=\"javascript:void(0);\" class=\"menu_item dropdown-toggle\" title=\"Films &amp; TV\" data-toggle=\"dropdown\" data-target=\"#\">\n                                            <span class=\"glyphicon glyphicon-chevron-down\"></span>\n                                        </a>\n                                    \n                                    <ul class=\"menuSub dropdown-menu\">\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"3\" href=\"releases?menu_id=ACF37CA9-756D-4B69-AD07-C8BBBD49BBEF&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" title=\"Film releases\">\n                                                Film releases\n                                            </a>\n                                        </li>\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"4\" href=\"previews?menu_id=ACF37CA9-756D-4B69-AD07-C8BBBD49BBEF&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" title=\"Film &amp; TV previews\">\n                                                Film &amp; TV previews\n                                            </a>\n                                        </li>\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"5\" href=\"big-screen-classics?menu_id=ACF37CA9-756D-4B69-AD07-C8BBBD49BBEF&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" title=\"Big screen classics\">\n                                                Big screen classics\n                                            </a>\n                                        </li>\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"6\" href=\"seasons?menu_id=ACF37CA9-756D-4B69-AD07-C8BBBD49BBEF&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" title=\"Film &amp; TV seasons\">\n                                                Film &amp; TV seasons\n                                            </a>\n                                        </li>\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"7\" href=\"regular-strands?menu_id=ACF37CA9-756D-4B69-AD07-C8BBBD49BBEF&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" title=\"Regular strands\">\n                                                Regular strands\n                                            </a>\n                                        </li>\n                                    \n                                    </ul>\n                                    \n                            </li>\n                            \n                            <li class=\"menuTopItem  has-sub-menu clearfix\" id=\"menuTopItem1\">\n\n\n                                \n                                         <a tabindex=\"8\" href=\"events?menu_id=2C31E6FA-6166-46F4-A993-1C533051038A&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" class=\"menu_item menu-link\" title=\"Events &amp; festivals\">\n                                            <span class=\"menu-label\">Events &amp; festivals</span>\n                                        </a>\n                                        <a tabindex=\"9\" href=\"javascript:void(0);\" class=\"menu_item dropdown-toggle\" title=\"Events &amp; festivals\" data-toggle=\"dropdown\" data-target=\"#\">\n                                            <span class=\"glyphicon glyphicon-chevron-down\"></span>\n                                        </a>\n                                    \n                                    <ul class=\"menuSub dropdown-menu\">\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"10\" href=\"events-interviews?menu_id=2C31E6FA-6166-46F4-A993-1C533051038A&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" title=\"Special events &amp; interviews\">\n                                                Special events &amp; interviews\n                                            </a>\n                                        </li>\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"11\" href=\"memberevents?menu_id=2C31E6FA-6166-46F4-A993-1C533051038A&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" title=\"BFI Member exclusives\">\n                                                BFI Member exclusives\n                                            </a>\n                                        </li>\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"12\" href=\"bfi-reuben-library-events?menu_id=2C31E6FA-6166-46F4-A993-1C533051038A&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" title=\"BFI Reuben Library events\">\n                                                BFI Reuben Library events\n                                            </a>\n                                        </li>\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"13\" href=\"http://www.bfi.org.uk/lff\" title=\"BFI London Film Festival\" target=\"_blank\">\n                                                BFI London Film Festival\n                                            </a>\n                                        </li>\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"14\" href=\"http://www.bfi.org.uk/flare\" title=\"BFI Flare: London LGBT Film Festival\" target=\"_blank\">\n                                                BFI Flare: London LGBT Film Festival\n                                            </a>\n                                        </li>\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"15\" href=\"http://www.bfi.org.uk/futurefilm\" title=\"Future Film Festival\" target=\"_blank\">\n                                                Future Film Festival\n                                            </a>\n                                        </li>\n                                    \n                                    </ul>\n                                    \n                            </li>\n                            \n                            <li class=\"menuTopItem  has-sub-menu clearfix\" id=\"menuTopItem2\">\n\n\n                                \n                                         <a tabindex=\"16\" href=\"familyfilms?menu_id=FB769377-8118-4895-B500-9B47D599C1B4&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" class=\"menu_item menu-link\" title=\"Families\">\n                                            <span class=\"menu-label\">Families</span>\n                                        </a>\n                                        <a tabindex=\"17\" href=\"javascript:void(0);\" class=\"menu_item dropdown-toggle\" title=\"Families\" data-toggle=\"dropdown\" data-target=\"#\">\n                                            <span class=\"glyphicon glyphicon-chevron-down\"></span>\n                                        </a>\n                                    \n                                    <ul class=\"menuSub dropdown-menu\">\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"18\" href=\"families?menu_id=FB769377-8118-4895-B500-9B47D599C1B4&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" title=\"Saturday Film Clubs for Children\">\n                                                Saturday Film Clubs for Children\n                                            </a>\n                                        </li>\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"19\" href=\"half-term?menu_id=FB769377-8118-4895-B500-9B47D599C1B4&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" title=\"Half-term and holiday activities\">\n                                                Half-term and holiday activities\n                                            </a>\n                                        </li>\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"20\" href=\"moveitfamilyanimatorsfeb2017?menu_id=FB769377-8118-4895-B500-9B47D599C1B4&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" title=\"Move IT! Family Animators\">\n                                                Move IT! Family Animators\n                                            </a>\n                                        </li>\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"21\" href=\"future-film?menu_id=FB769377-8118-4895-B500-9B47D599C1B4&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" title=\"Future Film for 15+\">\n                                                Future Film for 15+\n                                            </a>\n                                        </li>\n                                    \n                                    </ul>\n                                    \n                            </li>\n                            \n                            <li class=\"menuTopItem  has-sub-menu clearfix\" id=\"menuTopItem3\">\n\n\n                                \n                                         <a tabindex=\"22\" href=\"education?menu_id=A02AFFFD-6500-4CA5-87AC-410AB643B6EF&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" class=\"menu_item menu-link\" title=\"Courses &amp; education\">\n                                            <span class=\"menu-label\">Courses &amp; education</span>\n                                        </a>\n                                        <a tabindex=\"23\" href=\"javascript:void(0);\" class=\"menu_item dropdown-toggle\" title=\"Courses &amp; education\" data-toggle=\"dropdown\" data-target=\"#\">\n                                            <span class=\"glyphicon glyphicon-chevron-down\"></span>\n                                        </a>\n                                    \n                                    <ul class=\"menuSub dropdown-menu\">\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"24\" href=\"education-events?menu_id=A02AFFFD-6500-4CA5-87AC-410AB643B6EF&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" title=\"Education events\">\n                                                Education events\n                                            </a>\n                                        </li>\n                                    \n                                    </ul>\n                                    \n                            </li>\n                            \n                            <li class=\"menuTopItem  has-sub-menu clearfix\" id=\"menuTopItem4\">\n\n\n                                \n                                         <a tabindex=\"25\" href=\"visit?menu_id=0A1DF511-C097-4683-A73D-9D369447A957&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" class=\"menu_item menu-link\" title=\"Your visit\">\n                                            <span class=\"menu-label\">Your visit</span>\n                                        </a>\n                                        <a tabindex=\"26\" href=\"javascript:void(0);\" class=\"menu_item dropdown-toggle\" title=\"Your visit\" data-toggle=\"dropdown\" data-target=\"#\">\n                                            <span class=\"glyphicon glyphicon-chevron-down\"></span>\n                                        </a>\n                                    \n                                    <ul class=\"menuSub dropdown-menu\">\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"27\" href=\"how-to-get-here?menu_id=0A1DF511-C097-4683-A73D-9D369447A957&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" title=\"How to get here\">\n                                                How to get here\n                                            </a>\n                                        </li>\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"28\" href=\"ticket-prices-opening-hours?menu_id=0A1DF511-C097-4683-A73D-9D369447A957&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" title=\"Ticket prices &amp; opening hours\">\n                                                Ticket prices &amp; opening hours\n                                            </a>\n                                        </li>\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"29\" href=\"food-drink?menu_id=0A1DF511-C097-4683-A73D-9D369447A957&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" title=\"Food and drink\">\n                                                Food and drink\n                                            </a>\n                                        </li>\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"30\" href=\"access-information?menu_id=0A1DF511-C097-4683-A73D-9D369447A957&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" title=\"Access information\">\n                                                Access information\n                                            </a>\n                                        </li>\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"31\" href=\"bfi-reuben-library?menu_id=0A1DF511-C097-4683-A73D-9D369447A957&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" title=\"BFI Reuben Library\">\n                                                BFI Reuben Library\n                                            </a>\n                                        </li>\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"32\" href=\"bfi-mediatheque?menu_id=0A1DF511-C097-4683-A73D-9D369447A957&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" title=\"Mediatheque\">\n                                                Mediatheque\n                                            </a>\n                                        </li>\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"33\" href=\"bfi-exhibitions?menu_id=0A1DF511-C097-4683-A73D-9D369447A957&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" title=\"Exhibitions\">\n                                                Exhibitions\n                                            </a>\n                                        </li>\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"34\" href=\"bfi-shop?menu_id=0A1DF511-C097-4683-A73D-9D369447A957&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" title=\"BFI Shop\">\n                                                BFI Shop\n                                            </a>\n                                        </li>\n                                    \n                                    </ul>\n                                    \n                            </li>\n                            \n                            <li class=\"menuTopItem  has-sub-menu clearfix\" id=\"menuTopItem5\">\n\n\n                                \n                                         <a tabindex=\"35\" href=\"http://www.bfi.org.uk/join\" class=\"menu_item menu-link\" title=\"Support us &amp; join\" target=\"_blank\">\n                                            <span class=\"menu-label\">Support us &amp; join</span>\n                                        </a>\n                                        <a tabindex=\"36\" href=\"javascript:void(0);\" class=\"menu_item dropdown-toggle\" title=\"Support us &amp; join\" data-toggle=\"dropdown\" data-target=\"#\">\n                                            <span class=\"glyphicon glyphicon-chevron-down\"></span>\n                                        </a>\n                                    \n                                    <ul class=\"menuSub dropdown-menu\">\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"37\" href=\"default.asp?BOparam::WScontent::loadArticle::permalink=donate&amp;menu_id=27B05BF5-8965-4BE6-90B9-2BEBB6F38DD6&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" title=\"Donate\">\n                                                Donate\n                                            </a>\n                                        </li>\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"38\" href=\"http://www.bfi.org.uk/join\" title=\"Membership\" target=\"_blank\">\n                                                Membership\n                                            </a>\n                                        </li>\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"39\" href=\"http://www.bfi.org.uk/about-bfi/support-us-join/bfi-patrons\" title=\"Patrons\" target=\"_blank\">\n                                                Patrons\n                                            </a>\n                                        </li>\n                                    \n                                        <li class=\"menuSubItem\">\n\n                                            <a tabindex=\"40\" href=\"default.asp?BOparam::WScontent::loadArticle::permalink=corporate-support&amp;menu_id=27B05BF5-8965-4BE6-90B9-2BEBB6F38DD6&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" title=\"Corporate support\">\n                                                Corporate support\n                                            </a>\n                                        </li>\n                                    \n                                    </ul>\n                                    \n                            </li>\n                            \n                            <li class=\"menuTopItem \" id=\"menuTopItem6\">\n\n\n                                \n                                         <a tabindex=\"41\" href=\"maintainAccount.asp?menu_id=34DCCA97-0BAB-4B16-9ED4-204CFADFF0ED&amp;sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" class=\"menu_item menu-link\" title=\"Login/My account\">\n                                            <span class=\"menu-label\">Login/My account</span>\n                                        </a>\n                                    \n                            </li>\n                            \n                        <li class=\"menuTopItem\" id=\"menuTopItem-help\">\n                        \t<a tabindex=\"42\" href=\"javascript:var jsPop=new showInformationPopup( 'Help', 'loadArticle.asp?BOparam::WScontent::loadArticle::article_id=F8103D8C-7EA0-4B4B-A37E-9DE398B9310C' )\" title=\"Help\" class=\"menu_item menu-link\">Help</a>\n                        </li>\n                        \n                    </ul>\n\n        </div>\n    </div>\n\n<!-- customer/order information -->\n\n<div class=\"customer-options\" id=\"customer-utilities\">\n<!--ORDER DETAILS BOX-->\n\n<div id=\"orderInfo\">    \n    \n\n            <div id=\"customer-order-info\">\n            \t\n                <div class=\"customer-greeting\">\n    \t            <span class=\"greeting-message\">Order for</span>\n                    <span class=\"greeting-name\">Customer</span>\n\t            \n                </div>\n                \n                <div class=\"customer-order shopping-cart-details order-message \">\n                    \n                        <span id=\"orderInfoEmptyMessage\">Your shopping basket is empty.</span>       \n                    \n                </div>\n            <div class=\"customer-buttons\">\n    \t        \n                \n                <div class=\"cart-callout\">\n                      \n                    \n                        <a tabindex=\"43\" class=\"shopping-cart-link btn btn-default\" id=\"orderInfoCartLink\" href=\"shoppingCart.asp?sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D\" title=\"Shopping basket\">\n                            \n                \t        <span>Shopping basket</span>\n                        </a>\n                    \n                    \n                </div>                \n            </div>\n             \n        </div>\n</div>\n</div>\n<!-- CONTENT START -->\n<div id=\"content\">\n    <div class=\"container\">\n\n\n<div class=\"bodyDetails\" id=\"login\">  \n\n\n<div class=\"account-box page-heading\">\n<h1>My account</h1>\n</div>\n    \n    <div class=\"account-box login-box \">\n      <h3>Already registered online? Log in here using your username (email address) and password to change your personal details, email preferences and account information</h3>  \n        <form action=\"login.asp\" method=\"post\">\n            <input type=\"hidden\" name=\"sToken\" value=\"1,13ed893b,58faf0ae,46E368B7-98C6-4929-A561-F8D81A7D11BD,uwxRNnKRj/hcbjuom4sxbdDjNes=\">\n            <input type=\"hidden\" name=\"targetPage\" value=\"default.asp\">\n            <input type=\"hidden\" name=\"doLogin\" value=\"1\">\n            \n            <ul class=\"list-unstyled\">\n                <li>\n                    <label>\n                        <span class=\"field-label\">Username</span>\n                        <input type=\"text\" title=\"Username\" tabindex=\"44\" name=\"loginName\" value=\"\" size=\"34\" class=\"form-control\">&nbsp;<span class=\"required\">*</span>\n                    </label>\n                </li>\n                <li>\n                    <label>\n                        <span class=\"field-label\">Password</span>\n                        <input type=\"password\" autocomplete=\"off\" title=\"Password\" tabindex=\"45\" name=\"loginPassword\" size=\"34\" class=\"form-control\">&nbsp;<span class=\"required\">*</span>\n                    </label>\n                </li>\n                   \n                <li class=\"forgot-password no-label-indent\">  \n                    <a tabindex=\"46\" href=\"forgotPassword.asp?sToken=1%2C13ed893b%2C58faf0ae%2C46E368B7-98C6-4929-A561-F8D81A7D11BD%2CuwxRNnKRj%2Fhcbjuom4sxbdDjNes%3D&amp;targetPage=default.asp\" title=\"Have you forgotten your password?\">Have you forgotten your password?</a>\n               \n                  \n                </li>             \n                <li class=\"no-label-indent\">\n                    <input tabindex=\"47\" class=\"buttonBreak btn btn-primary\" type=\"submit\" name=\"login\" value=\"Login\" onclick=\"doGAClicks('Login')\">\n                </li>\n            </ul>\n                          \n        </form>\n      </div>\n\n     \n    \n    \n    <div class=\"account-box create-account-box \">\n    <h3>Not yet registered? Create a new account</h3>\n                 \n        <form action=\"createAccount.asp\">\n            <input type=\"hidden\" name=\"sToken\" value=\"1,13ed893b,58faf0ae,46E368B7-98C6-4929-A561-F8D81A7D11BD,uwxRNnKRj/hcbjuom4sxbdDjNes=\"> \n            <input type=\"hidden\" name=\"targetPage\" value=\"default.asp\">\n            <input type=\"hidden\" name=\"messageSource\" value=\"\">\n            \n            <p>\n            If you want us to remember your information for next time you can create an account as well.\n            <input tabindex=\"48\" type=\"submit\" name=\"create\" value=\"Not yet registered? Create a new account\" onclick=\"doGAClicks('Start')\" class=\"btn btn-link\">\n            </p>\n             \n    </form>\n    </div><!--\\\\ .bodyDetails #login -->  \n      \n    \n\n \n\n\n</div><!--\\\\ .bodyDetails #login -->\n\n\n        </div><!--\\\\ .bodyDetails -->\n    </div><!--\\\\ .container -->\n</div><!--\\\\ #content -->\n<div id=\"footer\">\n    <div class=\"footer-content container\">\n    <div id=\"footer-wrapper\" xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:av=\"http://www.audienceview.com/xml/email/\">\n\t<div id=\"zone-footer\">\n\t\t<div id=\"region-footer-first\">\n\t\t\t<div class=\"footer-menu-strip\">\n\t\t\t\t<span style=\"line-height: 1.4285;\"> 2017 British Film Institute. All right reserved. Registered charity 287780.</span>\n<br clear=\"none\">\n\t\t\t\t<br clear=\"none\">\n\t\t\t\t<a href=\"http://www.bfi.org.uk/terms-use\" shape=\"rect\">Terms of use</a> | <a href=\"http://www.bfi.org.uk/tickets-other-purchases-bfi-southbank\" shape=\"rect\">BFI Southbank purchases</a> | <a href=\"http://www.bfi.org.uk/bfi-online-community-guidelines\" shape=\"rect\">Online community guidelines</a> | <a href=\"http://www.bfi.org.uk/cookies-privacy\" shape=\"rect\">Cookies and privacy</a>\n</div>\n\t\t</div>\n\t</div>\n</div>\n \n    </div>              \n</div><!--\\\\ .content-wrapper -->\n<div id=\"fade\" class=\"black_overlay\"></div>\n\n\n\n\n<!-- inclusion of bootstrap.js and jquery -->\n<!-- http://twitter.github.com for documentation on bootstrap -->\n<script src=\"bootstrap/js/jquery-1.11.0.min.js\" type=\"text/javascript\"></script><script type=\"text/javascript\" id=\"\" src=\"//use.typekit.net/ppi3hbr.js\"></script>\n<script type=\"text/javascript\" id=\"\">(function(a,c,e,f,d,b){a.hj=a.hj||function(){(a.hj.q=a.hj.q||[]).push(arguments)};a._hjSettings={hjid:34760,hjsv:5};d=c.getElementsByTagName(\"head\")[0];b=c.createElement(\"script\");b.async=1;b.src=e+a._hjSettings.hjid+f+a._hjSettings.hjsv;d.appendChild(b)})(window,document,\"//static.hotjar.com/c/hotjar-\",\".js?sv\\x3d\");</script>\n\n<script type=\"text/javascript\" id=\"\">window.Krux||((Krux=function(){Krux.q.push(arguments)}).q=[]);(function(){var b=document.createElement(\"script\");b.type=\"text/javascript\";b.async=!0;var a,c=(a=location.href.match(/\\bkxsrc=([^&]+)/))&&decodeURIComponent(a[1]);b.src=/^https?:\\/\\/([a-z0-9_\\-\\.]+\\.)?krxd\\.net(:\\d{1,5})?\\//i.test(c)?c:\"disable\"===c?\"\":(\"https:\"===location.protocol?\"https:\":\"http:\")+\"//cdn.krxd.net/controltag?confid\\x3dKhGNDyUe\";a=document.getElementsByTagName(\"script\")[0];a.parentNode.insertBefore(b,a)})();</script>\n\n<script type=\"text/javascript\" id=\"\">try{Typekit.load()}catch(a){};</script>\n<script src=\"bootstrap/js/bootstrap.js\" type=\"text/javascript\"></script>\n<!-- end of bootstrap.js and jquery -->\n\n<!-- contains bootstrap specific function declarations -->\n<script src=\"bootstrap/js/bootstrap-functions.js\" type=\"text/javascript\"></script>\n<!-- CONTENT END -->\n\n\n\n<iframe name=\"_hjRemoteVarsFrame\" title=\"_hjRemoteVarsFrame\" id=\"_hjRemoteVarsFrame\" src=\"https://vars.hotjar.com/rcj-99d43ead6bdf30da8ed5ffcb4f17100c.html\" style=\"display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;\"></iframe><div id=\"ads\"></div><img class=\"pub_300x250 pub_300x250m pub_728x90 text-ad textAd text_ad text_ads text-ads text-ad-links\" style=\"width: 1px !important; height: 1px !important; position: absolute !important; left: -10000px !important; top: -1000px !important;\"><div class=\"kxhead\" data-id=\"KhGNDyUe\" style=\"display:none !important;\"><span class=\"kxtag kxinvisible\" data-id=\"23358\"><script>\n    (function() {\n        var prefix = location.protocol == 'https:' ? \"https\" : \"http\";\n        var tm_url = prefix + '://rtd.tubemogul.com/upi/pid/NC4WTmcy?redir=' + prefix + '%3A%2F%2Fbeacon.krxd.net%2Fusermatch.gif%3Fpartner_id%3Dcb276571-e0d9-4438-9fd4-80a1ff034b01%26puid%3D%24%7BTM_USER_ID%7D'\n        var i = new Image();\n        i.src = tm_url;\n    })();\n</script></span><span class=\"kxtag kxinvisible\" data-id=\"22769\"><script>new Image().src = 'https://usermatch.krxd.net/um/v2?partner=vdna';</script></span><span class=\"kxtag kxinvisible\" data-id=\"22753\"><script>\r\n// this tag is intentionally blank\r\n</script></span><span class=\"kxtag kxinvisible\" data-id=\"22754\"></span><span class=\"kxtag kxinvisible\" data-id=\"22756\"><script>\r\n(function(){\r\n    // scrape page attributes from DOM \r\n    Krux('scrape', { 'page_attr_keywords': { meta_name:\"keywords\"}});\r\n    Krux('scrape', { 'page_attr_url_path_1': { url_path: '1'}});\r\n    Krux('scrape', { 'page_attr_url_path_2': { url_path: '2'}});\r\n    Krux('scrape', { 'page_attr_url_path_3': { url_path: '3'}});\r\n    Krux('scrape', { 'page_attr_title': { dom: 'title:text'}});\r\n    // set sections and region attributes\r\n    Krux('set', 'page_attr_sections', typeof window._sf_async_config === 'object' && window._sf_async_config['sections']);\r\n    Krux('set', 'page_attr_region', typeof window._sf_async_config === 'object' && window._sf_async_config['region']);\r\n    \r\n    // get domain name without www\r\n    var dm = Krux('get','domain').replace('www.', '');\r\n    dm = dm.substring(0, dm.lastIndexOf('.'));\r\n    //set domain attribute to domain name\r\n    Krux('set', 'page_attr_domain', dm);\r\n    \r\n    //MemberId\r\n        var memberid = Krux('scrape.js_global','User.KruxMemberId');\r\n        if (memberid && memberid.indexOf('undefined') == -1) Krux('set', {user_attr_memberid: memberid});\r\n        \r\n})();\r\n</script></span><span class=\"kxtag kxinvisible\" data-id=\"22757\"><script>\r\n(function(){\r\n  var kuid = Krux('get', 'user');\r\n  if (kuid) {\r\n      var liveramp_url = 'https://idsync.rlcdn.com/379708.gif?partner_uid=' + kuid;\r\n      var i = new Image();\r\n      i.src = liveramp_url;      \r\n  }\r\n})();\r\n</script></span><span class=\"kxtag kxinvisible\" data-id=\"22758\"><script>\n    (function() {\n        var kuid = Krux('get', 'user');\n        if (kuid) {\n            var prefix = location.protocol == 'https:' ? \"https:\" : \"http:\";\n            var kurl_params = encodeURIComponent(\"_kuid=\" + kuid + \"&_kdpid=2dd640a6-6ebd-4d4f-af30-af8baa441a0d&dlxid=<na_id>&dlxdata=<na_da>\");\n            var kurl = prefix + \"//beacon.krxd.net/data.gif?\" + kurl_params;\n            var dlx_url = '//r.nexac.com/e/getdata.xgi?dt=br&pkey=gpwn29rvapq62&ru=' + kurl;\n            var i = new Image();\n            i.src = dlx_url;\n        }\n    })();\n</script></span><span class=\"kxtag kxinvisible\" data-id=\"22759\"><script>\r\n(function(){\r\n  var kuid = Krux('get', 'user');\r\n  if (kuid) {\r\n    Krux('require:http').pixel({\r\n      url: \"//loadm.exelator.com/load\",\r\n      data: {\r\n          _kdpid: 'e4942ff0-4070-4896-a7ef-e6a5a30ce9f9',\r\n          buid: kuid,\r\n          p: '204',\r\n          g: '270',\r\n          j: '0'\r\n      }});\r\n  }\r\n  })();\r\n</script></span><span class=\"kxtag kxinvisible\" data-id=\"22765\"><script>\n(function(){\n  if (window.Krux) {\n    var kuid = window.Krux('get', 'user');\n    if (kuid && typeof kuid != 'undefined') {\n       var rubicon_url = '//tap.rubiconproject.com/oz/feeds/krux/tokens?afu=' + kuid;\n       var i = new Image();\n       i.src = rubicon_url;\n    }\n  }\n})();\n</script></span><span class=\"kxtag kxinvisible\" data-id=\"22752\"><script type=\"text/javascript\">Krux('social.init');</script></span><span class=\"kxtag kxinvisible\" data-id=\"22774\"></span><span class=\"kxtag kxinvisible\" data-id=\"22775\"><script>\n\n(function () {\n_ml = window._ml || {};\n_ml.pub = '748';\n_ml.redirect = '//beacon.krxd.net/usermatch.gif?partner=madisonlogic&partner_uid=[PersonID]';\nvar s = document.getElementsByTagName('script')[0], cd = new Date(), mltag = document.createElement('script');\nmltag.type = 'text/javascript'; mltag.async = true;\nmltag.src = '//ml314.com/tag.aspx?' + cd.getDate() + cd.getMonth() + cd.getFullYear();\ns.parentNode.insertBefore(mltag, s);\n})();\n\n</script></span><span class=\"kxtag kxinvisible\" data-id=\"22776\"><script>\n(function(){\n  var kuid = Krux('get', 'user');\n  var prefix = window.location.protocol == 'https:' ? 'https:' : 'http:';\n  if (kuid) {\n    new Image().src = prefix + '//aa.agkn.com/adscores/g.js?sid=9212244187&_kdpid=2111c0af-fc3a-446f-ab07-63aa74fbde8e';\n  }\n})();\n</script>\n</span><span class=\"kxtag kxinvisible\" data-id=\"22777\"></span><span class=\"kxtag kxinvisible\" data-id=\"22778\"></span><span class=\"kxtag kxinvisible\" data-id=\"22779\"></span><span class=\"kxtag kxinvisible\" data-id=\"22780\"><script>\n(function(){\n        var kuid = Krux('get', 'user');\n        var prefix = window.location.protocol == 'https:' ? 'https:' : 'http:';\n\n        if (kuid) {\n           var url = prefix + '//ps.eyeota.net/match?bid=i0r4o4v&uid=' + kuid;\n           (new Image()).src = url;\n        }\n})();\n</script></span><span class=\"kxtag kxinvisible\" data-id=\"22781\"><script>\r\n(function(){\r\nvar d = Krux('scrape.js_global', 'Drupal.settings.gpt.targeting'), dl={};\r\n//The above object holds targeting passed to GTP/DFP.  Below will turn it into\r\n//an object the dataLayer can use\r\nif(d){\r\n  for(key in d){\r\n    if(d[key][0] && d[key][0].value){\r\n      //Some of these are menat to be run as js (eval=1 flag in original data structure))\r\n      if(d[key][0].eval){dl[key] = eval(d[key][0].value);}\r\n      //Otherwise just save the value\r\n      else{ dl[key] = d[key][0].value; }\r\n    }\r\n  }\r\n}\r\n//Ingest it via the Krux data layer\r\nKrux('ingestDataLayer', dl);\r\n})();\r\n\r\n</script></span></div></body><iframe id=\"kx-proxy-KhGNDyUe\" src=\"https://cdn.krxd.net/partnerjs/xdi/proxy.3d2100fd7107262ecb55ce6847f01fa5.html#!kxcid=KhGNDyUe&amp;kxt=https%3A%2F%2Fwhatson.bfi.org.uk&amp;kxcl=cdn&amp;kxp=\" style=\"display: none; visibility: hidden; height: 0; width: 0;\"></iframe>"}
